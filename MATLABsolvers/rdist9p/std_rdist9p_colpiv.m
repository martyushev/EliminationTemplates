% Input: coefficient matrix C of size 4x52

% Monomial vector: [z^2*w^2*x, y*z^2*w^2, y*x*z^2*w, y^2*z^2*w, x*y^2*z^2, y^3*z^2, z*w^2*x, z*w*x^2, y*z*w^2, z*w*x*y, z*x^2*y, z*w*y^2, z*y^2*x, z*y^3, z^2*w^2, x*z^2*w, z^2*y*w, z^2*y*x, z^2*y^2, x*w^2, w*x^2, x^3, y*w^2, w*y*x, y*x^2, y^2*w, y^2*x, y^3, w^2*z, z*x*w, z*x^2, w*y*z, z*y*x, y^2*z, z^2*w, z^2*x, z^2*y, w^2, x*w, x^2, w*y, x*y, y^2, z*w, x*z, z*y, z^2, w, x, y, z, 1]

function [w, x, y, z] = std_rdist9p_colpiv(C)

    M = zeros(76,100);

    M([25, 99, 174, 254, 476, 556, 620, 1602, 1686, 1750, 1837, 1916, 2143, 2287, 2367, 2450, 2968, 3745, 3809, 3884, 3962, 4045, 4959, 5019, 5097, 6157]) = C(113);
    M([177, 251, 326, 406, 704, 784, 848, 1754, 1838, 1902, 1989, 2068, 2219, 2439, 2519, 2602, 3120, 3897, 3961, 4036, 4114, 4197, 5111, 5171, 5249, 6309]) = C(125);
    M([481, 631, 706, 862, 1084, 1164, 1228, 3730, 3814, 3878, 3965, 4044, 4277, 4341, 4423, 4492, 4570, 4729, 4947, 5027, 5110, 5491, 5551, 5705, 6160, 6537]) = C(149);
    M([557, 707, 782, 938, 1160, 1304, 1459, 2142, 2217, 2823, 3806, 3954, 4120, 4353, 4417, 4568, 4646, 4805, 5023, 5186, 5567, 5627, 5781, 6236, 6613]) = C(153);
    M([709, 859, 934, 1014, 1312, 1392, 3882, 3966, 4030, 4117, 4196, 4505, 4569, 4651, 4720, 4798, 4881, 5099, 5179, 5262, 5719, 5779, 5933, 6312, 6765]) = C(161);
    M([1697, 1771, 1846, 1926, 2152, 2286, 2370, 2434, 2521, 2600, 2827, 2971, 3051, 3134, 3424, 3820, 3888, 4961, 5025, 5100, 5178, 5261, 6175, 6235, 6313, 6993]) = C(173);
    M([1849, 1923, 1998, 2078, 2228, 2438, 2522, 2586, 2673, 2752, 2903, 3123, 3203, 3286, 3576, 3972, 4040, 5113, 5177, 5252, 5330, 5413, 6327, 6387, 6465, 7145]) = C(181);
    M([3825, 3899, 3974, 4054, 4352, 4432, 4496, 4946, 5030, 5094, 5181, 5260, 5493, 5557, 5639, 5708, 5786, 5945, 6163, 6243, 6326, 6555, 6615, 6769, 6996, 7221]) = C(189);
    M([1468, 1535, 2153, 2226, 2826, 2901, 3355, 3975, 4130, 4428, 4572, 5022, 5170, 5336, 5569, 5633, 5784, 5862, 6021, 6239, 6402, 6631, 6691, 6845, 7072, 7297]) = C(193);
    M([3977, 4051, 4126, 4206, 4580, 4660, 4724, 5098, 5182, 5246, 5333, 5412, 5721, 5785, 5867, 5936, 6014, 6097, 6315, 6395, 6478, 6783, 6843, 6921, 7148, 7373]) = C(197);
    M([2381, 2455, 2530, 2610, 2836, 2970, 3054, 3118, 3205, 3284, 3359, 3427, 3507, 3590, 3652, 5036, 5104, 6177, 6241, 6316, 6394, 6477, 7011, 7071, 7149, 7449]) = C(201);
    M([5041, 5115, 5190, 5270, 5568, 5648, 5712, 6162, 6246, 6310, 6397, 6476, 6557, 6621, 6703, 6772, 6850, 6933, 6999, 7079, 7162, 7239, 7299, 7377, 7452, 7525]) = C(205);
    M([50, 124, 199, 279, 502, 581, 646, 1628, 1712, 1776, 1863, 1942, 2169, 2313, 2393, 2476, 2994, 3835, 3910, 3988, 4071, 4985, 5045, 5123, 6183]) = C(114);
    M([202, 276, 351, 431, 730, 809, 874, 1780, 1864, 1928, 2015, 2094, 2245, 2465, 2545, 2628, 3146, 3987, 4062, 4140, 4223, 5137, 5197, 5275, 6335]) = C(126);
    M([506, 656, 731, 887, 1110, 1189, 1254, 3756, 3840, 3904, 3991, 4070, 4367, 4449, 4518, 4596, 4755, 4973, 5053, 5136, 5517, 5577, 5731, 6186, 6563]) = C(150);
    M([582, 732, 807, 963, 1186, 1330, 1485, 2168, 2243, 2849, 3832, 3980, 4146, 4443, 4594, 4672, 4831, 5049, 5212, 5593, 5653, 5807, 6262, 6639]) = C(154);
    M([734, 884, 959, 1039, 1338, 1417, 3908, 3992, 4056, 4143, 4222, 4595, 4677, 4746, 4824, 4907, 5125, 5205, 5288, 5745, 5805, 5959, 6338, 6791]) = C(162);
    M([1722, 1796, 1871, 1951, 2177, 2312, 2396, 2460, 2547, 2626, 2853, 2997, 3077, 3160, 3450, 3846, 3914, 5051, 5126, 5204, 5287, 6201, 6261, 6339, 7019]) = C(174);
    M([1874, 1948, 2023, 2103, 2253, 2464, 2548, 2612, 2699, 2778, 2929, 3149, 3229, 3312, 3602, 3998, 4066, 5203, 5278, 5356, 5439, 6353, 6413, 6491, 7171]) = C(182);
    M([3850, 3924, 3999, 4079, 4378, 4457, 4522, 4972, 5056, 5120, 5207, 5286, 5583, 5665, 5734, 5812, 5971, 6189, 6269, 6352, 6581, 6641, 6795, 7022, 7247]) = C(190);
    M([1493, 1561, 2178, 2251, 2852, 2927, 3381, 4000, 4155, 4454, 4598, 5048, 5196, 5362, 5659, 5810, 5888, 6047, 6265, 6428, 6657, 6717, 6871, 7098, 7323]) = C(194);
    M([4002, 4076, 4151, 4231, 4606, 4685, 4750, 5124, 5208, 5272, 5359, 5438, 5811, 5893, 5962, 6040, 6123, 6341, 6421, 6504, 6809, 6869, 6947, 7174, 7399]) = C(198);
    M([2406, 2480, 2555, 2635, 2861, 2996, 3080, 3144, 3231, 3310, 3385, 3453, 3533, 3616, 3678, 5062, 5130, 6267, 6342, 6420, 6503, 7037, 7097, 7175, 7475]) = C(202);
    M([5066, 5140, 5215, 5295, 5594, 5673, 5738, 6188, 6272, 6336, 6423, 6502, 6647, 6729, 6798, 6876, 6959, 7025, 7105, 7188, 7265, 7325, 7403, 7478, 7551]) = C(206);
    M([139, 292, 679, 757, 906, 1656, 2337, 2485, 2649, 3022, 3183, 3475, 3793, 3938, 4100, 5151, 5229, 5310, 6224, 6286, 6364, 7044]) = C(175);
    M([215, 368, 755, 833, 982, 1732, 2413, 2561, 2725, 2949, 3098, 3259, 3398, 3551, 3869, 4014, 4176, 5227, 5386, 6300, 6440, 7120]) = C(179);
    M([291, 444, 907, 985, 1058, 1808, 2489, 2637, 2801, 3174, 3335, 3627, 3945, 4090, 4252, 5303, 5381, 5462, 6376, 6438, 6516, 7196]) = C(183);
    M([671, 900, 1287, 1365, 3784, 4325, 4546, 4784, 4997, 5145, 5309, 5759, 5837, 5994, 6214, 6375, 6604, 6666, 6820, 7047, 7272]) = C(191);
    M([747, 976, 1363, 1441, 3860, 4401, 4622, 4860, 5073, 5221, 5385, 5835, 5913, 6070, 6290, 6451, 6680, 6742, 6896, 7123, 7348]) = C(195);
    M([899, 1052, 3936, 4553, 4774, 4936, 5149, 5297, 5461, 5987, 6065, 6146, 6366, 6527, 6832, 6894, 6972, 7199, 7424]) = C(199);
    M([1811, 1964, 2340, 3021, 3169, 3333, 3478, 3639, 3703, 3947, 4025, 4098, 5009, 5154, 5316, 6367, 6445, 6526, 7060, 7122, 7200, 7500]) = C(203);
    M([3939, 4092, 4555, 4633, 4782, 5000, 5541, 5762, 6000, 6213, 6361, 6525, 6823, 6901, 6982, 7050, 7211, 7288, 7350, 7428, 7503, 7576]) = C(207);
    M([74, 1747, 2432]) = C(4);
    M([150, 1823, 2508]) = C(8);
    M([226, 1899, 2584]) = C(12);
    M([302, 1975, 2660]) = C(16);
    M([378, 2051, 2736]) = C(20);
    M([454, 2127, 2812]) = C(24);
    M([530, 3875, 5092]) = C(28);
    M([606, 2203, 2888]) = C(32);
    M([682, 3951, 5168]) = C(36);
    M([758, 4027, 5244]) = C(40);
    M([834, 2279, 2964]) = C(44);
    M([910, 4103, 5320]) = C(48);
    M([986, 4179, 5396]) = C(52);
    M([1062, 4255, 5472]) = C(56);
    M([1670, 2355, 3040]) = C(60);
    M([1746, 2431, 3116]) = C(64);
    M([1822, 2507, 3192]) = C(68);
    M([1898, 2583, 3268]) = C(72);
    M([1974, 2659, 3344]) = C(76);
    M([1138, 4407, 5624]) = C(80);
    M([1214, 4483, 5700]) = C(84);
    M([1519, 1596]) = C(88);
    M([1290, 4559, 5776]) = C(92);
    M([1366, 4635, 5852]) = C(96);
    M([1442, 4711, 5928]) = C(100);
    M([4787, 6004]) = C(104);
    M([4863, 6080]) = C(108);
    M([4939, 6156]) = C(112);
    M([3798, 5015, 6232]) = C(116);
    M([3874, 5091, 6308]) = C(120);
    M([2202, 2887, 3420]) = C(124);
    M([3950, 5167, 6384]) = C(128);
    M([4026, 5243, 6460]) = C(132);
    M([4102, 5319, 6536]) = C(136);
    M([2354, 3039, 3496]) = C(140);
    M([2430, 3115, 3572]) = C(144);
    M([2506, 3191, 3648]) = C(148);
    M([4330, 5547, 6612]) = C(152);
    M([4406, 5623, 6688]) = C(156);
    M([4482, 5699, 6764]) = C(160);
    M([4558, 5775, 6840]) = C(164);
    M([4634, 5851, 6916]) = C(168);
    M([4786, 6003, 6992]) = C(172);
    M([5014, 6231, 7068]) = C(176);
    M([5090, 6307, 7144]) = C(180);
    M([5166, 6383, 7220]) = C(184);
    M([3038, 3495, 3724]) = C(188);
    M([5546, 6611, 7296]) = C(192);
    M([5622, 6687, 7372]) = C(196);
    M([5774, 6839, 7448]) = C(200);
    M([6230, 7067, 7524]) = C(204);
    M([6610, 7295, 7600]) = C(208);

    [L,~,Pi] = lu(M(:,1:21));
    Pi = Pi';
    M = [Pi*L Pi(:,22:end)]\M(:,22:end);
    M = M(22:end,:);

    [L,UR,Pi] = lu(M(:,1:28));
    Pi = Pi';
    M = [Pi*L Pi(:,29:end)]\M(:,29:end);
    MP = M(1:28,:);
    NP = M(29:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-5));
    A = UR\[MP(:,1:end-5)*Pi MP(:,end-4:end)];
    B = U(:,1:27)\[U(:,28:end) Q'*NP(:,end-4:end)];
    M = [-A(:,end-23:end)+A(:,1:end-24)*B; -B];

    xP = [52, 53, 54, 55, 56, 57, 58, 1, 2, 59, 3, 4, 60, 5, 6, 7, 61, 62, 63, 64, 65, 66, 67, 17, 18, 68, 19, 20, 69, 21, 22, 23, 70, 71, 72, 73, 74, 33, 34, 75, 35, 36, 37, 76, 77, 78, 44, 45, 46, 79, 50];
    P1 = [(1:46)*Pi 47:51];
    T = getT(M,[52:79 P1(1:end-24)],P1(end-23:end),xP);

    [V,~] = eig(T);
    sol = V([20, 21, 22, 23],:)./(ones(4,1)*V(24,:));

    if(find(isnan( sol(:) )) > 0)
        w = zeros(1,0);
        x = zeros(1,0);
        y = zeros(1,0);
        z = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        w = sol(1,:);
        x = sol(2,:);
        y = sol(3,:);
        z = sol(4,:);
    end

end