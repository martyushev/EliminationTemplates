% Input: coefficient matrix C of size 4x52

% Monomial vector: [z^2*w^2*x, y*z^2*w^2, y*x*z^2*w, y^2*z^2*w, x*y^2*z^2, y^3*z^2, z*w^2*x, z*w*x^2, y*z*w^2, z*w*x*y, z*x^2*y, z*w*y^2, z*y^2*x, z*y^3, z^2*w^2, x*z^2*w, z^2*y*w, z^2*y*x, y^2*z^2, x*w^2, w*x^2, x^3, y*w^2, w*y*x, x^2*y, y^2*w, x*y^2, y^3, w^2*z, z*x*w, z*x^2, w*y*z, z*x*y, y^2*z, z^2*w, z^2*x, z^2*y, w^2, x*w, x^2, y*w, y*x, y^2, w*z, x*z, z*y, z^2, w, x, y, z, 1]

function [w, x, y, z] = std_rdist9p_colpiv(C)

    M = zeros(76,100);

    M([177, 251, 326, 406, 632, 766, 850, 914, 1001, 1080, 1307, 1451, 1531, 1614, 2132, 2908, 2976, 3745, 3809, 3884, 3962, 4045, 4655, 4715, 4793, 5321]) = C(113);
    M([329, 403, 478, 558, 708, 918, 1002, 1066, 1153, 1232, 1383, 1603, 1683, 1766, 2284, 3060, 3128, 3897, 3961, 4036, 4114, 4197, 4807, 4867, 4945, 5473]) = C(125);
    M([2913, 2987, 3062, 3142, 3364, 3444, 3508, 3730, 3814, 3878, 3965, 4044, 4265, 4347, 4418, 4643, 4723, 4806, 5324, 5797, 5860, 5945, 6099, 6159, 6237, 6613]) = C(149);
    M([15, 633, 706, 1306, 1381, 1987, 3063, 3218, 3440, 3584, 3806, 3954, 4120, 4277, 4341, 4416, 4494, 4577, 4719, 4882, 5171, 5249, 5400, 6175, 6689]) = C(153);
    M([3065, 3139, 3214, 3294, 3592, 3672, 3882, 3966, 4030, 4117, 4196, 4417, 4499, 4570, 4795, 4875, 4958, 5247, 5476, 5873, 5936, 6021, 6251, 6389, 6841]) = C(161);
    M([861, 935, 1010, 1090, 1316, 1450, 1534, 1598, 1685, 1764, 1991, 2135, 2215, 2298, 2588, 3820, 3888, 4657, 4721, 4796, 4874, 4957, 5339, 5399, 5477, 7069]) = C(173);
    M([1013, 1087, 1162, 1242, 1392, 1602, 1686, 1750, 1837, 1916, 2067, 2287, 2367, 2450, 2740, 3972, 4040, 4809, 4873, 4948, 5026, 5109, 5491, 5551, 5629, 7145]) = C(181);
    M([3825, 3899, 3974, 4054, 4276, 4356, 4642, 4726, 4790, 4877, 4956, 5183, 5254, 5327, 5407, 5490, 5864, 6101, 6165, 6240, 6401, 6631, 6691, 6845, 7072, 7221]) = C(189);
    M([24, 91, 1317, 1390, 1990, 2065, 2519, 3975, 4130, 4352, 4420, 4718, 4866, 5032, 5177, 5252, 5403, 5566, 5704, 6177, 6318, 6477, 6707, 6767, 6921, 7297]) = C(193);
    M([3977, 4051, 4126, 4206, 4428, 4508, 4794, 4878, 4942, 5029, 5108, 5253, 5479, 5559, 5642, 5940, 6253, 6323, 6392, 6470, 6553, 6859, 6919, 6997, 7148, 7373]) = C(197);
    M([1545, 1619, 1694, 1774, 2000, 2134, 2218, 2282, 2369, 2448, 2523, 2591, 2671, 2754, 2816, 4732, 4800, 5341, 5405, 5480, 5558, 5641, 5703, 7087, 7149, 7449]) = C(201);
    M([4737, 4811, 4886, 4966, 5192, 5326, 5410, 5474, 5561, 5640, 5711, 6176, 6244, 6633, 6697, 6779, 6848, 6926, 7009, 7075, 7162, 7239, 7299, 7377, 7452, 7525]) = C(205);
    M([202, 276, 351, 431, 657, 792, 876, 940, 1027, 1106, 1333, 1477, 1557, 1640, 2158, 2934, 3002, 3835, 3910, 3988, 4071, 4681, 4741, 4819, 5347]) = C(114);
    M([354, 428, 503, 583, 733, 944, 1028, 1092, 1179, 1258, 1409, 1629, 1709, 1792, 2310, 3086, 3154, 3987, 4062, 4140, 4223, 4833, 4893, 4971, 5499]) = C(126);
    M([2938, 3012, 3087, 3167, 3390, 3469, 3534, 3756, 3840, 3904, 3991, 4070, 4291, 4373, 4444, 4669, 4749, 4832, 5350, 5886, 5971, 6125, 6185, 6263, 6639]) = C(150);
    M([41, 658, 731, 1332, 1407, 2013, 3088, 3243, 3466, 3610, 3832, 3980, 4146, 4367, 4442, 4520, 4603, 4745, 4908, 5197, 5275, 5426, 6201, 6715]) = C(154);
    M([3090, 3164, 3239, 3319, 3618, 3697, 3908, 3992, 4056, 4143, 4222, 4443, 4525, 4596, 4821, 4901, 4984, 5273, 5502, 5962, 6047, 6277, 6415, 6867]) = C(162);
    M([886, 960, 1035, 1115, 1341, 1476, 1560, 1624, 1711, 1790, 2017, 2161, 2241, 2324, 2614, 3846, 3914, 4747, 4822, 4900, 4983, 5365, 5425, 5503, 7095]) = C(174);
    M([1038, 1112, 1187, 1267, 1417, 1628, 1712, 1776, 1863, 1942, 2093, 2313, 2393, 2476, 2766, 3998, 4066, 4899, 4974, 5052, 5135, 5517, 5577, 5655, 7171]) = C(182);
    M([3850, 3924, 3999, 4079, 4302, 4381, 4668, 4752, 4816, 4903, 4982, 5209, 5280, 5353, 5433, 5516, 5890, 6191, 6266, 6427, 6657, 6717, 6871, 7098, 7247]) = C(190);
    M([49, 117, 1342, 1415, 2016, 2091, 2545, 4000, 4155, 4378, 4446, 4744, 4892, 5058, 5203, 5278, 5429, 5592, 5730, 6344, 6503, 6733, 6793, 6947, 7323]) = C(194);
    M([4002, 4076, 4151, 4231, 4454, 4533, 4820, 4904, 4968, 5055, 5134, 5279, 5505, 5585, 5668, 5966, 6349, 6418, 6496, 6579, 6885, 6945, 7023, 7174, 7399]) = C(198);
    M([1570, 1644, 1719, 1799, 2025, 2160, 2244, 2308, 2395, 2474, 2549, 2617, 2697, 2780, 2842, 4758, 4826, 5431, 5506, 5584, 5667, 5729, 7113, 7175, 7475]) = C(202);
    M([4762, 4836, 4911, 4991, 5217, 5352, 5436, 5500, 5587, 5666, 5737, 6202, 6270, 6723, 6805, 6874, 6952, 7035, 7101, 7188, 7265, 7325, 7403, 7478, 7551]) = C(206);
    M([291, 444, 820, 1501, 1649, 1813, 2186, 2347, 2639, 3035, 3113, 3186, 3793, 3938, 4100, 4847, 4925, 5006, 5388, 5450, 5528, 7120]) = C(175);
    M([367, 520, 757, 896, 1577, 1725, 1889, 2113, 2262, 2423, 2562, 2715, 3111, 3262, 3869, 4014, 4176, 4923, 5082, 5464, 5604, 5752]) = C(179);
    M([443, 596, 972, 1653, 1801, 1965, 2338, 2499, 2791, 3187, 3265, 3338, 3945, 4090, 4252, 4999, 5077, 5158, 5540, 5602, 5680, 7196]) = C(183);
    M([3027, 3180, 3567, 3645, 3784, 4693, 4841, 5005, 5305, 5378, 5539, 5845, 5914, 6000, 6291, 6450, 6680, 6742, 6896, 7123, 7272]) = C(191);
    M([3103, 3256, 3643, 3721, 3860, 4325, 4470, 4632, 4769, 4917, 5081, 5303, 5454, 5615, 5755, 6369, 6526, 6756, 6818, 6972, 7348]) = C(195);
    M([3179, 3332, 3936, 4845, 4993, 5157, 5530, 5691, 5921, 5990, 6076, 6443, 6521, 6602, 6908, 6970, 7048, 7199, 7424]) = C(199);
    M([975, 1128, 1504, 2185, 2333, 2497, 2642, 2803, 2867, 3947, 4025, 4098, 4705, 4850, 5012, 5531, 5609, 5690, 5754, 7136, 7200, 7500]) = C(203);
    M([3939, 4092, 4481, 4696, 5377, 5525, 5689, 5923, 5998, 6149, 6294, 6456, 6899, 6977, 7058, 7126, 7211, 7288, 7350, 7428, 7503, 7576]) = C(207);
    M([226, 911, 1596]) = C(4);
    M([302, 987, 1672]) = C(8);
    M([378, 1063, 1748]) = C(12);
    M([454, 1139, 1824]) = C(16);
    M([530, 1215, 1900]) = C(20);
    M([606, 1291, 1976]) = C(24);
    M([2962, 3875, 4788]) = C(28);
    M([682, 1367, 2052]) = C(32);
    M([3038, 3951, 4864]) = C(36);
    M([3114, 4027, 4940]) = C(40);
    M([758, 1443, 2128]) = C(44);
    M([3190, 4103, 5016]) = C(48);
    M([3266, 4179, 5092]) = C(52);
    M([3342, 4255, 5168]) = C(56);
    M([834, 1519, 2204]) = C(60);
    M([910, 1595, 2280]) = C(64);
    M([986, 1671, 2356]) = C(68);
    M([1062, 1747, 2432]) = C(72);
    M([1138, 1823, 2508]) = C(76);
    M([3418, 4331, 6232]) = C(80);
    M([3494, 4407, 5244]) = C(84);
    M([75, 152]) = C(88);
    M([3570, 5927, 6308]) = C(92);
    M([3646, 4483, 5320]) = C(96);
    M([3722, 4559, 6384]) = C(100);
    M([6003, 6460]) = C(104);
    M([4635, 6536]) = C(108);
    M([6079, 6612]) = C(112);
    M([3798, 4711, 5396]) = C(116);
    M([3874, 4787, 5472]) = C(120);
    M([1366, 2051, 2584]) = C(124);
    M([3950, 4863, 5548]) = C(128);
    M([4026, 4939, 5624]) = C(132);
    M([4102, 5015, 5700]) = C(136);
    M([1518, 2203, 2660]) = C(140);
    M([1594, 2279, 2736]) = C(144);
    M([1670, 2355, 2812]) = C(148);
    M([5850, 6155, 6688]) = C(152);
    M([4330, 6231, 6764]) = C(156);
    M([4406, 5243, 6840]) = C(160);
    M([5926, 6307, 6916]) = C(164);
    M([4482, 5319, 6992]) = C(168);
    M([6002, 6459, 7068]) = C(172);
    M([4710, 5395, 7144]) = C(176);
    M([4786, 5471, 5776]) = C(180);
    M([4862, 5547, 7220]) = C(184);
    M([2202, 2659, 2888]) = C(188);
    M([6154, 6687, 7296]) = C(192);
    M([6230, 6763, 7372]) = C(196);
    M([6306, 6915, 7448]) = C(200);
    M([5394, 7143, 7524]) = C(204);
    M([6686, 7295, 7600]) = C(208);

    [L,~,Pi] = lu(M(:,1:2));
    Pi = Pi';
    M = [Pi*L Pi(:,3:end)]\M(:,3:end);
    M = M(3:end,:);

    [L,UR,Pi] = lu(M(:,1:36));
    Pi = Pi';
    M = [Pi*L Pi(:,37:end)]\M(:,37:end);
    MP = M(1:36,:);
    NP = M(37:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-5));
    A = UR\[MP(:,1:end-5)*Pi MP(:,end-4:end)];
    B = U(:,1:38)\[U(:,39:end) Q'*NP(:,end-4:end)];
    M = [-A(:,end-23:end)+A(:,1:end-24)*B; -B];

    xP = [1, 2, 3, 4, 5, 6, 37, 7, 38, 39, 8, 9, 10, 11, 12, 13, 14, 15, 49, 16, 51, 17, 53, 18, 19, 20, 21, 22, 23, 24, 25, 63, 27, 28, 29, 30, 31, 34, 48, 50, 52, 54, 60, 61, 62, 26, 64, 65, 66, 69, 70, 32, 71, 72, 73, 33, 35, 92, 74, 93, 36, 97];
    R = 1:36;
    P = 37:98;
    P1 = [P(1:end-5)*Pi P(end-4:end)];
    RP = [R P1(1:end-24)];
    B = P1(end-23:end);
    A = getA(M,RP,B,B-36,xP);

    [V,~] = eig(A);
    sol = V([20, 21, 22, 23],:)./(ones(4,1)*V(24,:));

    if(find(isnan( sol(:) )) > 0)
        w = zeros(1,0);
        x = zeros(1,0);
        y = zeros(1,0);
        z = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        w = sol(1,:);
        x = sol(2,:);
        y = sol(3,:);
        z = sol(4,:);
    end

end