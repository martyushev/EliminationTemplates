% Input: coefficient matrix C of size 4x18

% Monomial vector: [x^2*w, y^2*w, z*x*w, z*y*w, z^2*w, x*w, x^2, y*w, y*x, y^2, x*z, y*z, z^2, w, x, y, z, 1]

function [w, x, y, z] = std_pose_quiver(C)

    M = zeros(65,85);

    M([133, 521, 591, 652, 722, 914, 983, 1115, 1442, 1955, 2024, 2156, 2418, 3199]) = C(1);
    M([263, 786, 852, 1174, 1243, 1310, 1637, 2219, 2286, 2678, 3394]) = C(5);
    M([458, 1366, 1436, 1497, 1567, 1694, 1763, 1830, 1897, 2735, 2804, 2936, 3003, 3329]) = C(17);
    M([1563, 2146, 2212, 2604, 3452, 3520, 3645, 3711, 3843, 3912, 4041, 4299, 4368, 4889]) = C(33);
    M([1758, 2406, 2476, 2602, 2799, 2868, 3067, 3255, 3842, 3910, 4366, 4689, 4758, 5214]) = C(41);
    M([1823, 2601, 2667, 2929, 3517, 3585, 3775, 3841, 3908, 3977, 4106, 4364, 4433, 4954]) = C(45);
    M([1888, 2796, 2866, 2927, 2994, 3063, 3132, 3320, 3907, 3975, 4431, 4754, 4823, 5279]) = C(49);
    M([2733, 3191, 3258, 3327, 3647, 3780, 4236, 4494, 4628, 5084]) = C(53);
    M([2798, 3186, 3254, 3642, 4297, 4365, 4490, 4556, 4688, 4757, 4886, 5144, 5213, 5344]) = C(57);
    M([2928, 3382, 3641, 3774, 4037, 4105, 4171, 4230, 4296, 4363, 4432, 4884, 4953, 5019]) = C(61);
    M([2993, 3251, 3319, 3772, 4362, 4430, 4620, 4686, 4753, 4822, 4951, 5209, 5278, 5409]) = C(65);
    M([3318, 4227, 4486, 4619, 4882, 4950, 5016, 5075, 5141, 5208, 5277, 5339, 5408, 5474]) = C(69);
    M([15, 82, 146, 213, 345, 998, 1059, 1129, 1386, 1455, 1587, 1784, 2362, 2431, 2628, 2825, 3281]) = C(10);
    M([1056, 1188, 1515, 2168, 2234, 2556, 2625, 2692, 2954, 3408, 3666, 3800, 4256]) = C(30);
    M([795, 862, 1121, 1253, 1580, 2229, 2621, 3469, 3537, 3662, 3728, 3860, 3929, 4058, 4316, 4385, 4906]) = C(34);
    M([1120, 1252, 1446, 1578, 1775, 2493, 2619, 2816, 2885, 3084, 3272, 3859, 3927, 4383, 4706, 4775, 5231]) = C(42);
    M([1250, 1317, 1576, 1643, 1840, 2684, 2946, 3534, 3602, 3792, 3858, 3925, 3994, 4123, 4381, 4450, 4971]) = C(46);
    M([1575, 1642, 1771, 1838, 1905, 2883, 2944, 3011, 3080, 3149, 3337, 3924, 3992, 4448, 4771, 4840, 5296]) = C(50);
    M([2160, 2227, 2421, 2618, 2815, 3271, 3659, 4314, 4382, 4507, 4573, 4705, 4774, 4903, 5161, 5230, 5361]) = C(58);
    M([2225, 2292, 2616, 2683, 2945, 3399, 3791, 4054, 4122, 4188, 4247, 4313, 4380, 4449, 4901, 4970, 5036]) = C(62);
    M([2615, 2682, 2811, 2943, 3010, 3336, 3789, 4379, 4447, 4637, 4703, 4770, 4839, 4968, 5226, 5295, 5426]) = C(66);
    M([3266, 3335, 3397, 3655, 3788, 4244, 4636, 4899, 4967, 5033, 5092, 5158, 5225, 5294, 5356, 5425, 5491]) = C(70);
    M([32, 98, 229, 296, 428, 1075, 1146, 1207, 1277, 1534, 1603, 1670, 1867, 2575, 2644, 2711, 2973, 3819]) = C(15);
    M([552, 683, 944, 1076, 1403, 1985, 2056, 2117, 2187, 2379, 2448, 2645, 2842, 3229, 3298, 3686, 4534]) = C(23);
    M([747, 813, 1139, 1271, 1598, 2180, 2247, 2639, 3487, 3555, 3680, 3746, 3878, 3947, 4076, 4334, 4403, 4924]) = C(35);
    M([1007, 1138, 1464, 1596, 1793, 2440, 2511, 2637, 2834, 2903, 3102, 3290, 3877, 3945, 4401, 4724, 4793, 5249]) = C(43);
    M([1137, 1268, 1594, 1661, 1858, 2635, 2702, 2964, 3552, 3620, 3810, 3876, 3943, 4012, 4141, 4399, 4468, 4989]) = C(47);
    M([1462, 1593, 1789, 1856, 1923, 2830, 2901, 2962, 3029, 3098, 3167, 3355, 3942, 4010, 4466, 4789, 4858, 5314]) = C(51);
    M([2047, 2178, 2439, 2636, 2833, 3220, 3289, 3677, 4332, 4400, 4525, 4591, 4723, 4792, 4921, 5179, 5248, 5379]) = C(59);
    M([2177, 2243, 2634, 2701, 2963, 3417, 3675, 3809, 4072, 4140, 4206, 4265, 4331, 4398, 4467, 4919, 4988, 5054]) = C(63);
    M([2437, 2633, 2829, 2961, 3028, 3285, 3354, 3807, 4397, 4465, 4655, 4721, 4788, 4857, 4986, 5244, 5313, 5444]) = C(67);
    M([3217, 3284, 3353, 3673, 3806, 4262, 4520, 4654, 4917, 4985, 5051, 5110, 5176, 5243, 5312, 5374, 5443, 5509]) = C(71);
    M([180, 637, 768, 1029, 1161, 1488, 2001, 2070, 2202, 2464, 2531, 2923, 3245, 4612, 4744, 5200]) = C(28);
    M([245, 767, 833, 1159, 1291, 1618, 2131, 2200, 2267, 2659, 3700, 3896, 3963, 4352, 4419, 4940]) = C(36);
    M([310, 832, 898, 1289, 1356, 1683, 2265, 2332, 2724, 3440, 3571, 3638, 4092, 4159, 4225]) = C(40);
    M([375, 1027, 1158, 1484, 1616, 1813, 2391, 2460, 2657, 2854, 2921, 3118, 3310, 4742, 4809, 5265]) = C(44);
    M([440, 1157, 1288, 1614, 1681, 1878, 2586, 2655, 2722, 2984, 3830, 3961, 4028, 4417, 4484, 5005]) = C(48);
    M([505, 1482, 1613, 1809, 1876, 1943, 2781, 2850, 2982, 3049, 3116, 3183, 3375, 4807, 4874, 5330]) = C(52);
    M([1415, 2067, 2198, 2459, 2656, 2853, 3240, 3309, 3697, 4545, 4741, 4808, 5197, 5264, 5395]) = C(60);
    M([1545, 2197, 2263, 2654, 2721, 2983, 3437, 3695, 3829, 4285, 4416, 4483, 4937, 5004, 5070]) = C(64);
    M([1740, 2457, 2653, 2849, 2981, 3048, 3305, 3374, 3827, 4675, 4806, 4873, 5262, 5329, 5460]) = C(68);
    M([2780, 3237, 3304, 3373, 3693, 3826, 4282, 4540, 4674, 5130, 5261, 5328, 5392, 5459, 5525]) = C(72);

    [L,~,Pi] = lu(M(:,1:52));
    Pi = Pi';
    M = [Pi*L Pi(:,53:end)]\M(:,53:end);
    M = M(end-12:end,:);

    T = zeros(20);
    T(1:13,:) = -M(:,1:13)\M(:,14:end);
    T([14, 35, 56, 77, 218, 239, 260]) = 1;

    [V,~] = eig(T);
    sol = V([14, 18, 13, 19],:)./(ones(4,1)*V(20,:));

    if(find(isnan( sol(:) )) > 0)
        w = zeros(1,0);
        x = zeros(1,0);
        y = zeros(1,0);
        z = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        w = sol(1,:);
        x = sol(2,:);
        y = sol(3,:);
        z = sol(4,:);
    end

end