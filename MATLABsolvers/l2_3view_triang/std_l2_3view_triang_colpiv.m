% Input: coefficient matrix C of size 8x25

% Monomial vector: [x1*x3, x2*x3, x4*x1, x4*x2, x3*x5, x4*x5, x3*x6, x6*x4, x7*x1, x7*x2, x3*x7, x4*x7, x3*x8, x4*x8, x5*x8, x6*x8, x1, x2, x3, x4, x5, x6, x7, x8, 1]

function [x1, x2, x3, x4, x5, x6, x7, x8] = std_l2_3view_triang_colpiv(C)

    M = zeros(217,248);

    M([245, 660, 1106, 5653, 6305, 7402, 7608, 8702, 8911, 9999, 10658, 11093, 25409, 25633, 26709, 27144, 27569, 32558, 36906, 37130, 37339, 40150, 40364, 41016, 41453, 41888, 42319, 45788]) = C(81);
    M([679, 1094, 1540, 6304, 6739, 6959, 8053, 8259, 9353, 9562, 10433, 10875, 11310, 26060, 26284, 26926, 27361, 27786, 32775, 37123, 37347, 40801, 41015, 41233, 41670, 42105, 42536, 46005]) = C(89);
    M([3500, 3698, 3927, 13248, 13466, 13686, 14129, 14335, 15212, 15421, 16726, 16951, 17386, 28881, 29105, 30615, 31267, 32126, 34511, 37781, 43622, 43837, 44274, 45357, 47756, 48827, 50134, 51864]) = C(129);
    M([5670, 6302, 6748, 17167, 17599, 18245, 18470, 18688, 32353, 32577, 33002, 33220, 33428, 34945, 40156, 40378, 40808, 41036, 41245, 41460, 41895, 45575, 45789, 46007, 51218, 51436, 51650, 53166]) = C(177);
    M([13909, 34740, 34947, 37569, 37984, 44063, 44509, 45587, 46248, 46673, 46891, 49053, 49275, 49499, 49708, 49923, 50366, 50575, 51237, 51455, 52085, 52299, 52517, 52737, 52955, 53169, 53390, 53600]) = C(193);
    M([48, 471, 918, 5464, 6116, 7213, 7636, 8514, 8939, 9810, 10687, 11122, 25221, 25662, 26737, 27172, 27597, 32586, 36934, 37160, 37367, 39958, 40393, 41045, 41481, 41916, 42348, 45816]) = C(82);
    M([482, 905, 1352, 6115, 6550, 6987, 7864, 8287, 9165, 9590, 10244, 10904, 11339, 25872, 26313, 26954, 27389, 27814, 32803, 37151, 37377, 40609, 41044, 41262, 41698, 42133, 42565, 46033]) = C(90);
    M([3520, 3726, 3956, 13276, 13494, 13931, 14157, 14580, 15241, 15666, 16754, 17197, 17632, 28910, 29351, 30860, 31512, 32371, 34756, 37585, 38028, 43647, 44083, 44519, 45603, 49073, 50379, 52109]) = C(138);
    M([5473, 6113, 6560, 16978, 17411, 18056, 18499, 18717, 32165, 32606, 33030, 33248, 33456, 34973, 39967, 40406, 40619, 41066, 41273, 41488, 41923, 45383, 45818, 46036, 51246, 51464, 51679, 53194]) = C(178);
    M([13721, 34552, 34975, 37795, 43874, 44320, 45398, 46277, 46701, 46919, 47788, 48864, 49303, 49529, 49736, 49951, 50178, 50603, 51266, 51484, 51893, 52328, 52546, 52765, 52983, 53198, 53418, 53628]) = C(194);
    M([82, 508, 945, 1373, 1819, 2245, 4839, 5057, 5498, 6155, 6582, 7228, 7881, 8531, 9184, 9841, 10277, 16550, 16988, 17423, 18072, 25252, 25904, 32180, 39987, 40639, 45410]) = C(67);
    M([299, 725, 1162, 1590, 5056, 5274, 5715, 6372, 6799, 7445, 8098, 8748, 9401, 10058, 10494, 16767, 17205, 17640, 18289, 25469, 26121, 32397, 40204, 40856, 45627]) = C(75);
    M([2675, 2904, 3330, 11566, 11784, 12219, 12438, 19829, 20038, 20258, 23509, 23732, 23942, 24806, 25025, 26767, 26986, 28073, 28291, 30655, 31093, 31745, 33045, 34133, 42808, 43026, 46712]) = C(115);
    M([3109, 3338, 12651, 12871, 13090, 20480, 20689, 20909, 24160, 24383, 24593, 24805, 25024, 27201, 27420, 28507, 28725, 31306, 31744, 31962, 33262, 34350, 43242, 43460, 46929]) = C(123);
    M([29592, 30244, 35448, 35659, 35888, 37607, 38264, 38695, 39130, 40438, 41091, 45848, 46285, 47171, 47380, 47598, 47805, 48030, 48253, 48458, 48676, 48883, 49318, 49536, 49972, 50624, 52354]) = C(147);
    M([7015, 7678, 8972, 32630, 32848, 35001, 36972, 37181, 37401, 39993, 40211, 40435, 41092, 41302, 41514, 41733, 41949, 42168, 42391, 42610, 45411, 45846, 46064, 51274, 51492, 51707, 53222]) = C(179);
    M([22216, 22859, 23079, 23290, 23519, 24162, 29143, 29361, 29585, 30242, 30452, 32626, 32845, 33715, 33933, 34561, 34998, 35218, 42816, 43035, 43251, 43470, 46280, 46498, 46717, 46935, 53439]) = C(187);
    M([38269, 38480, 44771, 45206, 45863, 46082, 46301, 46519, 48039, 48248, 48474, 48683, 48890, 49108, 49332, 49555, 49765, 49977, 50629, 51921, 52356, 52574, 52793, 53011, 53226, 53446, 53656]) = C(195);
    M([108, 536, 972, 2062, 2479, 4867, 5086, 5526, 5953, 6181, 6610, 7257, 7910, 8560, 9213, 9868, 16577, 17015, 17450, 18099, 25278, 25930, 32207, 40014, 40666, 45437]) = C(68);
    M([325, 753, 1189, 5084, 5303, 5743, 6398, 6827, 7474, 8127, 8777, 9430, 10085, 16794, 17232, 17667, 18316, 25495, 26147, 32424, 40231, 40883, 45654]) = C(76);
    M([11594, 11813, 12029, 12248, 12467, 19855, 20066, 20285, 23537, 23758, 23970, 24835, 25054, 26794, 28099, 28317, 30682, 31120, 31772, 33072, 34160, 42835, 43053, 46739]) = C(116);
    M([12679, 12900, 13119, 20506, 20717, 20936, 24188, 24409, 24621, 24834, 25053, 27228, 28533, 28751, 31333, 31771, 31989, 33289, 34377, 43269, 43487, 46956]) = C(124);
    M([13765, 30269, 30487, 35473, 35692, 36348, 36765, 37851, 38070, 38297, 38509, 38722, 38941, 39157, 39376, 41116, 43919, 44791, 45226, 46092, 46529, 47414, 48275, 49562, 49780, 52598]) = C(156);
    M([8355, 9640, 32656, 32874, 35028, 36998, 37209, 37428, 40021, 40240, 40463, 40673, 41118, 41330, 41543, 41762, 41978, 42197, 42418, 45438, 45873, 46091, 51301, 51519, 51734, 53249]) = C(180);
    M([22242, 22887, 23106, 23762, 24396, 29171, 29390, 29613, 29823, 30268, 30480, 32653, 33741, 33959, 34588, 35025, 35245, 42845, 43064, 43280, 43499, 46307, 46525, 46744, 46962, 53466]) = C(188);
    M([38296, 38735, 39152, 43928, 44800, 45235, 45890, 46327, 46545, 48065, 48276, 48918, 49137, 49360, 49581, 49793, 50006, 50658, 51948, 52383, 52601, 52820, 53038, 53253, 53473, 53683]) = C(196);
    M([12930, 19020, 19228, 19448, 20531, 20734, 20971, 21172, 21390, 21820, 22038, 22263, 22922, 23130, 24212, 24430, 24876, 25302, 25520, 25740, 26393, 27265, 27681, 29189, 29410, 29624, 30276, 32664, 33753, 42865, 43300, 46331]) = C(101);
    M([3177, 13147, 19237, 19445, 19665, 20748, 20951, 21389, 21607, 22471, 22689, 22914, 23139, 23347, 24429, 24647, 25093, 25953, 26171, 26391, 26610, 27482, 27898, 29840, 30061, 30275, 30493, 32881, 33970, 43082, 43517, 46548]) = C(109);
    M([4256, 4459, 4696, 7718, 8370, 14442, 14660, 16196, 16402, 17056, 17274, 17934, 18567, 35946, 36154, 36374, 38763, 38971, 39619, 39837, 41581, 41800, 44379, 44600, 44815, 45035, 46773, 48520, 50022, 50895, 51326, 52841]) = C(165);
    M([22275, 22917, 23137, 24220, 24423, 24660, 25729, 26381, 29198, 29416, 29641, 30300, 30508, 31820, 32026, 32246, 32464, 32684, 32903, 33341, 33540, 34614, 34835, 35051, 35272, 43308, 43526, 46333, 46551, 46771, 46989, 53492]) = C(189);
    M([38327, 39179, 39416, 40485, 41137, 45262, 45483, 45701, 45921, 46140, 48098, 48306, 48741, 48945, 49163, 49388, 49613, 49821, 50686, 50916, 51122, 51569, 51768, 51974, 52195, 52409, 52627, 52847, 53065, 53279, 53500, 53709]) = C(197);
    M([12310, 19048, 19259, 19477, 19917, 20135, 20348, 21203, 21421, 21851, 22069, 22294, 22950, 23161, 23592, 23810, 24904, 25333, 25551, 26859, 27712, 29221, 29442, 29656, 30308, 32696, 33785, 42897, 43332, 46363]) = C(102);
    M([2771, 12527, 19265, 19476, 19694, 20134, 20352, 21420, 21638, 22502, 22720, 22945, 23167, 23378, 23809, 24027, 25121, 25984, 26202, 27076, 27929, 29872, 30093, 30307, 30525, 32913, 34002, 43114, 43549, 46580]) = C(110);
    M([4293, 4511, 4724, 9051, 9703, 15558, 15776, 16216, 16441, 17521, 17739, 17962, 18815, 36619, 36837, 39225, 39436, 39650, 39868, 45281, 47022, 47692, 48768, 50270, 50491, 50705, 50926, 51144, 51575, 53090]) = C(174);
    M([22303, 22948, 23166, 23606, 23824, 24037, 25760, 26412, 29229, 29447, 29672, 30328, 30539, 31189, 31848, 32277, 32495, 33152, 33571, 34646, 34867, 35083, 35304, 42905, 43123, 46365, 46583, 46803, 47021, 53524]) = C(190);
    M([38356, 38797, 39010, 40516, 41168, 44859, 45077, 45514, 45732, 48126, 48337, 48561, 48976, 49194, 49419, 49641, 49852, 50066, 50944, 51380, 51799, 52006, 52227, 52441, 52659, 52879, 53097, 53311, 53532, 53741]) = C(198);
    M([173, 608, 1048, 1911, 2346, 4946, 5602, 6257, 7344, 8649, 9954, 11685, 12773, 14507, 15595, 21878, 25362, 29270, 37940, 40119, 47919, 49018]) = C(7);
    M([390, 825, 1265, 5163, 5819, 6474, 7561, 8866, 10171, 11902, 14724, 15812, 22095, 25579, 29487, 37720, 38157, 40336, 49235]) = C(15);
    M([607, 1042, 1482, 2128, 2563, 6031, 6253, 6691, 7995, 9300, 10388, 12119, 13853, 14941, 16029, 22529, 26013, 29921, 37937, 40770, 44027]) = C(23);
    M([824, 1259, 1699, 6470, 6908, 8212, 9517, 10605, 14070, 15158, 22746, 26230, 30138, 38154, 40987, 44244]) = C(31);
    M([5598, 6250, 6690, 7336, 8639, 16664, 17109, 17546, 18200, 29256, 30781, 31435, 32306, 34695, 40105, 40760, 44016, 44453, 45544, 49004, 50315, 52056]) = C(135);
    M([5815, 6467, 6907, 7553, 8856, 16881, 17326, 17763, 18417, 29473, 30998, 31652, 32523, 34912, 40322, 40977, 44233, 44670, 45761, 49221, 50532, 52273]) = C(143);
    M([7770, 9073, 29690, 32740, 37063, 37281, 37504, 40100, 40539, 41194, 41630, 42067, 42504, 42933, 43370, 45978, 46413, 49438, 49658, 50095, 50749, 52490]) = C(151);
    M([7124, 8421, 9724, 30341, 32957, 37280, 37498, 40751, 41190, 41411, 41847, 42284, 42721, 43150, 43587, 44887, 45324, 46195, 46630, 49655, 49875, 52707]) = C(159);
    M([35127, 40535, 41187, 41410, 41622, 42057, 45525, 45964, 46185, 46399, 46839, 47059, 51395, 51615, 51835, 52476, 52696, 52916, 53136, 53356, 53574, 53792]) = C(199);
    M([3023, 3472, 7807, 10838, 11711, 11929, 12359, 14517, 14738, 19956, 20165, 20397, 23650, 23868, 24946, 26894, 28197, 36011, 36235, 38823, 41645, 42949, 48587, 50104]) = C(40);
    M([2820, 8458, 11055, 12145, 12576, 14951, 15172, 20173, 20382, 23867, 24085, 25163, 27111, 28414, 36228, 36452, 38822, 39040, 41862, 43166, 44896]) = C(48);
    M([3457, 9109, 11272, 12796, 13011, 15602, 15823, 20607, 20816, 21048, 24301, 24519, 24945, 27328, 28631, 36669, 39257, 42079, 43383, 47729, 48804, 50755]) = C(56);
    M([3254, 9760, 11489, 13228, 16036, 20824, 21033, 24518, 24736, 25162, 27545, 28848, 36662, 36886, 39256, 39474, 42296, 43600, 45330]) = C(64);
    M([22343, 22986, 23218, 23638, 24304, 29288, 29506, 29726, 30378, 32753, 33839, 40574, 42520, 42956, 43391, 45985, 46421, 48163, 48387, 49020, 49241, 49455, 49673, 52491]) = C(152);
    M([22994, 23203, 23435, 23855, 24521, 29939, 30157, 30377, 30595, 32970, 34056, 38405, 41225, 42737, 43173, 43608, 44029, 44250, 46202, 46638, 48380, 49672, 49890, 52708]) = C(160);
    M([12354, 18650, 23645, 23854, 24086, 24955, 30807, 31025, 31238, 31890, 33187, 34273, 38839, 41659, 42963, 43181, 44463, 44684, 44899, 46855, 48597, 50106, 51410, 52925]) = C(168);
    M([13020, 18867, 24296, 24505, 24737, 24940, 31458, 31676, 31889, 32107, 33404, 34490, 39273, 42093, 43397, 43615, 45333, 47072, 48814, 50322, 50543, 50757, 51627, 53142]) = C(176);
    M([29721, 30364, 30596, 34713, 34931, 35140, 35358, 42951, 43400, 45999, 46435, 46653, 46862, 47080, 49465, 49689, 51851, 52058, 52279, 52493, 52711, 53363, 53582, 53793]) = C(200);

    [L,~,Pi] = lu(M(:,1:87));
    Pi = Pi';
    M = [Pi*L Pi(:,88:end)]\M(:,88:end);
    M = M(88:end,:);

    [L,UR,Pi] = lu(M(:,1:76));
    Pi = Pi';
    M = [Pi*L Pi(:,77:end)]\M(:,77:end);
    MP = M(1:76,:);
    NP = M(77:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-9));
    A = UR\[MP(:,1:end-9)*Pi MP(:,end-8:end)];
    B = U(:,1:54)\[U(:,55:end) Q'*NP(:,end-8:end)];
    M = [-A(:,end-30:end)+A(:,1:end-31)*B; -B];

    xP = [88, 89, 90, 91, 92, 94, 95, 96, 97, 98, 100, 102, 103, 105, 106, 108, 109, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 136, 137, 140, 141, 36, 142, 38, 147, 148, 149, 150, 154, 155, 156, 157, 86, 87, 93, 99, 101, 104, 107, 110, 133, 134, 135, 138, 139, 35, 143, 144, 37, 145, 146, 151, 152, 153, 158, 159, 51, 52, 53, 54, 160, 161, 84];
    P1 = [(1:76)*Pi 77:85];
    T = getT(M,[86:161 P1(1:end-31)],P1(end-30:end),xP);

    [V,~] = eig(T);
    sol = V([23, 24, 25, 26, 27, 28, 29, 30],:)./(ones(8,1)*V(31,:));

    if(find(isnan( sol(:) )) > 0)
        x1 = zeros(1,0);
        x2 = zeros(1,0);
        x3 = zeros(1,0);
        x4 = zeros(1,0);
        x5 = zeros(1,0);
        x6 = zeros(1,0);
        x7 = zeros(1,0);
        x8 = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        x1 = sol(1,:);
        x2 = sol(2,:);
        x3 = sol(3,:);
        x4 = sol(4,:);
        x5 = sol(5,:);
        x6 = sol(6,:);
        x7 = sol(7,:);
        x8 = sol(8,:);
    end

end