% Input: coefficient matrix C of size 11x56

% Monomial vector: [z^3*x^3, z^3*x^2*y, z^3*x*y^2, z^3*y^3, w*x^3*z, w*x^2*z*y, w*x*y^2*z, w*y^3*z, z^2*x^3, z^2*x^2*y, x*y^2*z^2, y^3*z^2, z^3*x^2, z^3*y*x, z^3*y^2, w*x^3, w*x^2*y, w*x*y^2, y^3*w, z*w*x^2, z*w*x*y, z*x^2*y, z*w*y^2, z*y^2*x, z*y^3, z^2*x^2, z^2*y*x, z^2*y^2, z^3*x, z^3*y, x^2*w, y*x*w, y^2*w, y^2*x, y^3, z*x*w, z*x^2, z*y*w, z*y*x, z*y^2, x*z^2, z^2*y, z^3, x*w, w*y, x*y, y^2, z*w, x*z, y*z, z^2, w, x, y, z, 1]

function [x, y, z] = std_relpose_7p_fr_1s_colpiv(C)

    M = zeros(55,74);

    M([4, 62, 123, 340, 401, 464, 606, 717, 844, 907, 1350, 1488, 1600, 1658, 1719, 1782, 1881, 1942, 2005, 2110, 2173, 2286, 2426, 2484, 2545, 2608, 2982, 3043, 3106, 3431, 3494, 3772]) = C(529);
    M([59, 117, 178, 395, 456, 519, 661, 772, 899, 962, 1405, 1655, 1713, 1774, 1837, 1936, 1997, 2060, 2165, 2228, 2341, 2481, 2539, 2600, 2663, 3037, 3098, 3161, 3486, 3549, 3827]) = C(540);
    M([991, 1102, 1599, 1657, 1718, 1880, 1941, 2004, 2109, 2172, 2285, 2425, 2483, 2544, 2607, 2701, 2759, 2820, 2883, 2981, 3042, 3105, 3202, 3263, 3326, 3430, 3493, 3596, 3659, 3771, 3882]) = C(573);
    M([1046, 1157, 1654, 1712, 1773, 1935, 1996, 2059, 2164, 2227, 2340, 2480, 2538, 2599, 2662, 2756, 2814, 2875, 2938, 3036, 3097, 3160, 3257, 3318, 3381, 3485, 3548, 3651, 3714, 3826, 3937]) = C(584);
    M([334, 392, 453, 835, 896, 959, 1211, 1339, 1402, 1570, 1875, 1933, 1994, 2057, 2101, 2162, 2225, 2275, 2338, 2396, 2976, 3034, 3095, 3158, 3422, 3483, 3546, 3761, 3824, 3992]) = C(595);
    M([1431, 1874, 1932, 1993, 2100, 2161, 2224, 2274, 2337, 2395, 2975, 3033, 3094, 3157, 3196, 3254, 3315, 3378, 3421, 3482, 3545, 3587, 3648, 3711, 3760, 3823, 3871, 3934, 3991, 4047]) = C(606);
    M([33, 366, 1629, 1685, 1907]) = C(90);
    M([88, 421, 1684, 1740, 1962]) = C(101);
    M([143, 476, 1739, 1795, 2017]) = C(112);
    M([198, 531, 1794, 1850, 2072]) = C(123);
    M([1683, 1961, 2509, 2565, 3062]) = C(233);
    M([1738, 2016, 2564, 2620, 3117]) = C(255);
    M([1793, 2071, 2619, 2675, 3172]) = C(266);
    M([363, 861, 1904, 1960, 2127]) = C(277);
    M([418, 916, 1959, 2015, 2182]) = C(288);
    M([473, 971, 2014, 2070, 2237]) = C(299);
    M([2563, 2839, 2895, 3116, 3337]) = C(365);
    M([2618, 2894, 2950, 3171, 3392]) = C(376);
    M([1903, 2126, 3004, 3060, 3447]) = C(398);
    M([1958, 2181, 3059, 3115, 3502]) = C(420);
    M([2013, 2236, 3114, 3170, 3557]) = C(431);
    M([858, 1356, 2124, 2180, 2292]) = C(442);
    M([913, 1411, 2179, 2235, 2347]) = C(453);
    M([3058, 3279, 3335, 3501, 3667]) = C(497);
    M([3113, 3334, 3390, 3556, 3722]) = C(508);
    M([2123, 2291, 3444, 3500, 3777]) = C(530);
    M([2178, 2346, 3499, 3555, 3832]) = C(541);
    M([1353, 1576, 2289, 2345, 2402]) = C(552);
    M([3443, 3609, 3665, 3776, 3887]) = C(574);
    M([3498, 3664, 3720, 3831, 3942]) = C(585);
    M([2288, 2401, 3774, 3830, 3997]) = C(596);
    M([3773, 3884, 3940, 3996, 4052]) = C(607);
    M(368) = C(3);
    M(423) = C(14);
    M(478) = C(25);
    M(533) = C(36);
    M(643) = C(47);
    M(698) = C(58);
    M(753) = C(69);
    M(808) = C(80);
    M(1963) = C(102);
    M(2018) = C(113);
    M(2073) = C(124);
    M(863) = C(135);
    M(918) = C(146);
    M(973) = C(157);
    M(1083) = C(179);
    M(1138) = C(190);
    M(1193) = C(201);
    M(1248) = C(212);
    M(1303) = C(223);
    M(3118) = C(256);
    M(3173) = C(267);
    M(2128) = C(278);
    M(2183) = C(289);
    M(2238) = C(300);
    M(1358) = C(311);
    M(1413) = C(322);
    M(1468) = C(333);
    M(3393) = C(377);
    M(1523) = C(388);
    M(3503) = C(421);
    M(3558) = C(432);
    M(2293) = C(443);
    M(2348) = C(454);
    M(1578) = C(465);
    M(3723) = C(509);
    M(3778) = C(531);
    M(3833) = C(542);
    M(2403) = C(553);
    M(3943) = C(586);
    M(3998) = C(597);
    M(4053) = C(608);
    M(369) = C(4);
    M(424) = C(15);
    M(479) = C(26);
    M(534) = C(37);
    M(644) = C(48);
    M(699) = C(59);
    M(754) = C(70);
    M(809) = C(81);
    M(1964) = C(103);
    M(2019) = C(114);
    M(2074) = C(125);
    M(864) = C(136);
    M(919) = C(147);
    M(974) = C(158);
    M(1084) = C(180);
    M(1139) = C(191);
    M(1194) = C(202);
    M(1249) = C(213);
    M(1304) = C(224);
    M(3119) = C(257);
    M(3174) = C(268);
    M(2129) = C(279);
    M(2184) = C(290);
    M(2239) = C(301);
    M(1359) = C(312);
    M(1414) = C(323);
    M(1469) = C(334);
    M(3394) = C(378);
    M(1524) = C(389);
    M(3504) = C(422);
    M(3559) = C(433);
    M(2294) = C(444);
    M(2349) = C(455);
    M(1579) = C(466);
    M(3724) = C(510);
    M(3779) = C(532);
    M(3834) = C(543);
    M(2404) = C(554);
    M(3944) = C(587);
    M(3999) = C(598);
    M(4054) = C(609);
    M([371, 1690, 1912]) = C(93);
    M([426, 1745, 1967]) = C(104);
    M([481, 1800, 2022]) = C(115);
    M([536, 1855, 2077]) = C(126);
    M([590, 646, 1032]) = C(170);
    M([756, 1142]) = C(192);
    M([1966, 2570, 3067]) = C(236);
    M([2021, 2625, 3122]) = C(258);
    M([2076, 2680, 3177]) = C(269);
    M([866, 1965, 2132]) = C(280);
    M([921, 2020, 2187]) = C(291);
    M([976, 2075, 2242]) = C(302);
    M([2900, 3121, 3342]) = C(368);
    M([2955, 3176, 3397]) = C(379);
    M([2131, 3065, 3452]) = C(401);
    M([2186, 3120, 3507]) = C(423);
    M([2241, 3175, 3562]) = C(434);
    M([1361, 2185, 2297]) = C(445);
    M([1416, 2240, 2352]) = C(456);
    M(1526) = C(478);
    M([3340, 3506, 3672]) = C(500);
    M([3395, 3561, 3727]) = C(511);
    M([2296, 3505, 3782]) = C(533);
    M([2351, 3560, 3837]) = C(544);
    M([1581, 2350, 2407]) = C(555);
    M([3670, 3781, 3892]) = C(577);
    M([3725, 3836, 3947]) = C(588);
    M([2406, 3835, 4002]) = C(599);
    M([3945, 4001, 4057]) = C(610);
    M(373) = C(6);
    M(428) = C(17);
    M(483) = C(28);
    M(538) = C(39);
    M(648) = C(50);
    M(703) = C(61);
    M(758) = C(72);
    M(813) = C(83);
    M(1968) = C(105);
    M(2023) = C(116);
    M(2078) = C(127);
    M(868) = C(138);
    M(923) = C(149);
    M(978) = C(160);
    M(1088) = C(182);
    M(1143) = C(193);
    M(1198) = C(204);
    M(1253) = C(215);
    M(1308) = C(226);
    M(3123) = C(259);
    M(3178) = C(270);
    M(2133) = C(281);
    M(2188) = C(292);
    M(2243) = C(303);
    M(1363) = C(314);
    M(1418) = C(325);
    M(1473) = C(336);
    M(3398) = C(380);
    M(1528) = C(391);
    M(3508) = C(424);
    M(3563) = C(435);
    M(2298) = C(446);
    M(2353) = C(457);
    M(1583) = C(468);
    M(3728) = C(512);
    M(3783) = C(534);
    M(3838) = C(545);
    M(2408) = C(556);
    M(3948) = C(589);
    M(4003) = C(600);
    M(4058) = C(611);
    M(374) = C(7);
    M(429) = C(18);
    M(484) = C(29);
    M(539) = C(40);
    M(649) = C(51);
    M(704) = C(62);
    M(759) = C(73);
    M(814) = C(84);
    M(1969) = C(106);
    M(2024) = C(117);
    M(2079) = C(128);
    M(869) = C(139);
    M(924) = C(150);
    M(979) = C(161);
    M(1089) = C(183);
    M(1144) = C(194);
    M(1199) = C(205);
    M(1254) = C(216);
    M(1309) = C(227);
    M(3124) = C(260);
    M(3179) = C(271);
    M(2134) = C(282);
    M(2189) = C(293);
    M(2244) = C(304);
    M(1364) = C(315);
    M(1419) = C(326);
    M(1474) = C(337);
    M(3399) = C(381);
    M(1529) = C(392);
    M(3509) = C(425);
    M(3564) = C(436);
    M(2299) = C(447);
    M(2354) = C(458);
    M(1584) = C(469);
    M(3729) = C(513);
    M(3784) = C(535);
    M(3839) = C(546);
    M(2409) = C(557);
    M(3949) = C(590);
    M(4004) = C(601);
    M(4059) = C(612);
    M([45, 377, 1641, 1918]) = C(96);
    M([100, 432, 1696, 1973]) = C(107);
    M([155, 487, 1751, 2028]) = C(118);
    M([210, 542, 1806, 2083]) = C(129);
    M([320, 596, 707, 1093]) = C(184);
    M([817, 1203]) = C(206);
    M([1695, 1972, 2521, 3073]) = C(239);
    M([1750, 2027, 2576, 3128]) = C(261);
    M([1805, 2082, 2631, 3183]) = C(272);
    M([375, 872, 1916, 2138]) = C(283);
    M([430, 927, 1971, 2193]) = C(294);
    M([485, 982, 2026, 2248]) = C(305);
    M([2575, 2851, 3127, 3348]) = C(371);
    M([2630, 2906, 3182, 3403]) = C(382);
    M([1915, 2137, 3016, 3458]) = C(404);
    M([1970, 2192, 3071, 3513]) = C(426);
    M([2025, 2247, 3126, 3568]) = C(437);
    M([870, 1367, 2136, 2303]) = C(448);
    M([925, 1422, 2191, 2358]) = C(459);
    M(1310) = C(492);
    M([3070, 3291, 3512, 3678]) = C(503);
    M([3125, 3346, 3567, 3733]) = C(514);
    M([2135, 2302, 3456, 3788]) = C(536);
    M([2190, 2357, 3511, 3843]) = C(547);
    M([1365, 1587, 2301, 2413]) = C(558);
    M([3455, 3621, 3787, 3898]) = C(580);
    M([3510, 3676, 3842, 3953]) = C(591);
    M([2300, 2412, 3786, 4008]) = C(602);
    M([3785, 3896, 4007, 4063]) = C(613);
    M(49) = C(9);
    M(104) = C(20);
    M(159) = C(31);
    M(214) = C(42);
    M(269) = C(53);
    M(324) = C(64);
    M(1699) = C(108);
    M(1754) = C(119);
    M(1809) = C(130);
    M(379) = C(141);
    M(434) = C(152);
    M(489) = C(163);
    M(599) = C(185);
    M(654) = C(218);
    M(709) = C(229);
    M(764) = C(251);
    M(2579) = C(262);
    M(2634) = C(273);
    M(1919) = C(284);
    M(1974) = C(295);
    M(2029) = C(306);
    M(874) = C(317);
    M(929) = C(328);
    M(1039) = C(339);
    M(1094) = C(350);
    M(1149) = C(361);
    M(2909) = C(383);
    M(1259) = C(394);
    M(1314) = C(416);
    M(3074) = C(427);
    M(3129) = C(438);
    M(2139) = C(449);
    M(2194) = C(460);
    M(1369) = C(471);
    M(1479) = C(482);
    M(3349) = C(515);
    M(1534) = C(526);
    M(3459) = C(537);
    M(3514) = C(548);
    M(2304) = C(559);
    M(3679) = C(592);
    M(3789) = C(603);
    M(3899) = C(614);
    M(50) = C(10);
    M(105) = C(21);
    M(160) = C(32);
    M(215) = C(43);
    M(270) = C(54);
    M(325) = C(65);
    M(1700) = C(109);
    M(1755) = C(120);
    M(1810) = C(131);
    M(380) = C(142);
    M(435) = C(153);
    M(490) = C(164);
    M(600) = C(186);
    M(655) = C(219);
    M(710) = C(230);
    M(765) = C(252);
    M(2580) = C(263);
    M(2635) = C(274);
    M(1920) = C(285);
    M(1975) = C(296);
    M(2030) = C(307);
    M(875) = C(318);
    M(930) = C(329);
    M(1040) = C(340);
    M(1095) = C(351);
    M(1150) = C(362);
    M(2910) = C(384);
    M(1260) = C(395);
    M(1315) = C(417);
    M(3075) = C(428);
    M(3130) = C(439);
    M(2140) = C(450);
    M(2195) = C(461);
    M(1370) = C(472);
    M(1480) = C(483);
    M(3350) = C(516);
    M(1535) = C(527);
    M(3460) = C(538);
    M(3515) = C(549);
    M(2305) = C(560);
    M(3680) = C(593);
    M(3790) = C(604);
    M(3900) = C(615);
    M([51, 384, 1647, 1703, 1925]) = C(99);
    M([106, 439, 1702, 1758, 1980]) = C(110);
    M([161, 494, 1757, 1813, 2035]) = C(121);
    M([216, 549, 1812, 1868, 2090]) = C(132);
    M([1701, 1979, 2527, 2583, 3080]) = C(242);
    M([1756, 2034, 2582, 2638, 3135]) = C(264);
    M([1811, 2089, 2637, 2693, 3190]) = C(275);
    M([381, 879, 1922, 1978, 2145]) = C(286);
    M([436, 934, 1977, 2033, 2200]) = C(297);
    M([491, 989, 2032, 2088, 2255]) = C(308);
    M([656, 1042, 1098, 1264, 1485]) = C(341);
    M([766, 1152, 1208]) = C(363);
    M([2581, 2857, 2913, 3134, 3355]) = C(374);
    M([2636, 2912, 2968, 3189, 3410]) = C(385);
    M([1921, 2144, 3022, 3078, 3465]) = C(407);
    M([1976, 2199, 3077, 3133, 3520]) = C(429);
    M([2031, 2254, 3132, 3188, 3575]) = C(440);
    M([876, 1374, 2142, 2198, 2310]) = C(451);
    M([931, 1429, 2197, 2253, 2365]) = C(462);
    M([3076, 3297, 3353, 3519, 3685]) = C(506);
    M([3131, 3352, 3408, 3574, 3740]) = C(517);
    M([2141, 2309, 3462, 3518, 3795]) = C(539);
    M([2196, 2364, 3517, 3573, 3850]) = C(550);
    M([1371, 1594, 2307, 2363, 2420]) = C(561);
    M(1536) = C(572);
    M([3461, 3627, 3683, 3794, 3905]) = C(583);
    M([3516, 3682, 3738, 3849, 3960]) = C(594);
    M([2306, 2419, 3792, 3848, 4015]) = C(605);
    M([3791, 3902, 3958, 4014, 4070]) = C(616);

    [L,~,Pi] = lu(M(:,1:29));
    Pi = Pi';
    M = [Pi*L Pi(:,30:end)]\M(:,30:end);
    M = M(30:end,:);

    [L,UR,Pi] = lu(M(:,1:15));
    Pi = Pi';
    M = [Pi*L Pi(:,16:end)]\M(:,16:end);
    MP = M(1:15,:);
    NP = M(16:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-4));
    A = UR\[MP(:,1:end-4)*Pi MP(:,end-3:end)];
    B = U(:,1:11)\[U(:,12:end) Q'*NP(:,end-3:end)];
    M = [-A(:,end-18:end)+A(:,1:end-19)*B; -B];

    xP = [31, 32, 33, 34, 35, 1, 2, 3, 4, 5, 36, 37, 38, 39, 11, 12, 13, 14, 40, 41, 42, 19, 20, 21, 43, 44, 25, 26, 45, 29];
    P1 = [(1:26)*Pi 27:30];
    T = getT(M,[31:45 P1(1:end-19)],P1(end-18:end),xP);

    [V,~] = eig(T);
    sol = V([16, 17, 18],:)./(ones(3,1)*V(19,:));

    if(find(isnan( sol(:) )) > 0)
        x = zeros(1,0);
        y = zeros(1,0);
        z = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        x = sol(1,:);
        y = sol(2,:);
        z = sol(3,:);
    end

end