% Input: coefficient matrix C of size 3x29

% Monomial vector: [z*x^3, z*x^2*y, z*x*y^2, z*y^3, z^2*x^2, z^2*x*y, z^2*y^2, z^3*x, z^3*y, z^4, x^3, x^2*y, x*y^2, y^3, x^2*z, z*y^2, z^2*x, z^2*y, z^3, x^2, y*x, y^2, z*x, z*y, z^2, x, y, z, 1]

function [x, y, z] = std_refract5p(C)

    M = zeros(57,73);

    M([3, 229, 289, 519, 1256, 1316, 1546, 2231]) = C(1);
    M([60, 286, 346, 576, 1313, 1373, 1603, 2288]) = C(4);
    M([117, 343, 403, 633, 1370, 1430, 1660, 2345]) = C(7);
    M([174, 400, 460, 690, 1427, 1487, 1717, 3086]) = C(10);
    M([345, 514, 574, 747, 1541, 1601, 1774, 2402]) = C(13);
    M([402, 571, 631, 804, 1598, 1658, 1831, 2459]) = C(16);
    M([459, 628, 688, 861, 1655, 1715, 2971, 3257]) = C(19);
    M([630, 742, 802, 918, 1769, 1829, 1888, 2516]) = C(22);
    M([687, 799, 859, 975, 1826, 2969, 3142, 3428]) = C(25);
    M([858, 913, 973, 1883, 3027, 3140, 3313, 3599]) = C(28);
    M([1029, 1255, 1315, 1545, 1940, 2000, 2230, 2573]) = C(31);
    M([1086, 1312, 1372, 1602, 1997, 2057, 2287, 2630]) = C(34);
    M([1143, 1369, 1429, 1659, 2054, 2114, 2344, 2687]) = C(37);
    M([1200, 1426, 1486, 1716, 2111, 2171, 3085, 3371]) = C(40);
    M([1371, 1540, 1600, 1773, 2225, 2285, 2401, 2744]) = C(43);
    M([1485, 1654, 1714, 2339, 2970, 3083, 3256, 3542]) = C(46);
    M([1656, 1768, 1828, 1887, 2396, 2456, 2515, 3200]) = C(49);
    M([1713, 1825, 2453, 2968, 3141, 3254, 3427, 3656]) = C(52);
    M([1882, 2510, 2967, 3139, 3312, 3425, 3598, 3827]) = C(55);
    M([2055, 2224, 2284, 2400, 2567, 2627, 2743, 2858]) = C(58);
    M([2112, 2281, 2341, 2457, 2624, 2684, 2800, 2915]) = C(61);
    M([2169, 2338, 2681, 3082, 3255, 3368, 3541, 3770]) = C(64);
    M([2340, 2395, 2455, 2514, 2738, 2798, 3199, 3485]) = C(67);
    M([2452, 2795, 3081, 3253, 3426, 3539, 3655, 3884]) = C(70);
    M([2682, 2737, 2797, 2852, 2912, 3198, 3484, 3713]) = C(76);
    M([2794, 2909, 3366, 3538, 3654, 3767, 3883, 3998]) = C(79);
    M([3193, 3479, 3537, 3652, 3825, 3881, 3940, 4055]) = C(82);
    M([3478, 3707, 3765, 3880, 3939, 3995, 4054, 4112]) = C(85);
    M([9, 71, 137, 296, 358, 424, 589, 655, 830, 1036, 1098, 1164, 1323, 1385, 1451, 1616, 1682, 1857, 2008, 2070, 2136, 2301, 2367, 2485, 2644, 2710, 2828, 2943]) = C(62);
    M([294, 356, 422, 524, 586, 652, 760, 826, 944, 1321, 1383, 1449, 1551, 1613, 1679, 1787, 1853, 1914, 2236, 2298, 2364, 2415, 2481, 2542, 2758, 2824, 3227, 3513]) = C(68);
    M([351, 413, 479, 581, 643, 709, 817, 883, 1001, 1378, 1440, 1506, 1608, 1670, 1736, 1844, 2293, 2355, 2472, 2815, 2993, 3105, 3168, 3279, 3454, 3565, 3683, 3912]) = C(71);
    M([579, 641, 707, 752, 814, 880, 931, 997, 1606, 1668, 1734, 1779, 1841, 1901, 2407, 2469, 2529, 2990, 3053, 3164, 3214, 3276, 3339, 3450, 3625, 3679, 3854, 3969]) = C(74);
    M([1320, 1382, 1448, 1550, 1612, 1678, 1786, 1852, 1913, 2005, 2067, 2133, 2235, 2297, 2363, 2414, 2480, 2541, 2578, 2640, 2706, 2757, 2823, 2872, 2938, 3226, 3512, 3741]) = C(77);
    M([1377, 1439, 1505, 1607, 1669, 1735, 1843, 2062, 2124, 2190, 2292, 2354, 2471, 2635, 2697, 2814, 2929, 2992, 3104, 3167, 3278, 3390, 3453, 3564, 3682, 3793, 3911, 4026]) = C(80);
    M([1605, 1667, 1733, 1778, 1840, 1900, 2290, 2352, 2406, 2468, 2528, 2749, 2811, 2989, 3102, 3163, 3213, 3275, 3338, 3449, 3499, 3561, 3624, 3678, 3853, 3907, 3968, 4083]) = C(83);
    M([2289, 2351, 2405, 2467, 2527, 2632, 2694, 2748, 2810, 2863, 2925, 3101, 3212, 3274, 3387, 3448, 3498, 3560, 3623, 3677, 3727, 3789, 3852, 3906, 3967, 4021, 4082, 4140]) = C(86);
    M([40, 106, 265, 327, 393, 558, 624, 797, 1067, 1133, 1292, 1354, 1420, 1585, 1651, 1824, 1977, 2039, 2105, 2270, 2613]) = C(60);
    M([154, 220, 379, 441, 507, 672, 738, 911, 1181, 1247, 1406, 1468, 1534, 1699, 1765, 2091, 2153, 2219, 2384, 2727, 3021]) = C(66);
    M([382, 448, 550, 612, 678, 786, 852, 968, 1409, 1475, 1577, 1639, 1705, 1813, 1879, 1938, 2262, 2324, 2390, 2441, 2784]) = C(69);
    M([439, 505, 607, 669, 735, 843, 909, 1025, 1466, 1532, 1634, 1696, 1762, 1870, 2319, 2381, 2498, 2841, 3019, 3131, 3192]) = C(72);
    M([667, 733, 778, 840, 906, 957, 1023, 1694, 1760, 1805, 1867, 1927, 2433, 2495, 2555, 3016, 3077, 3190, 3240, 3302, 3363]) = C(75);
    M([1408, 1474, 1576, 1638, 1704, 1812, 1878, 1937, 2093, 2159, 2261, 2323, 2389, 2440, 2506, 2565, 2604, 2666, 2732, 2783, 2898]) = C(78);
    M([1465, 1531, 1633, 1695, 1761, 1869, 2150, 2216, 2318, 2380, 2497, 2661, 2723, 2840, 2955, 3018, 3130, 3191, 3304, 3416, 3477]) = C(81);
    M([1693, 1759, 1804, 1866, 1926, 2378, 2432, 2494, 2554, 2775, 2837, 3015, 3128, 3189, 3239, 3301, 3362, 3475, 3525, 3587, 3648]) = C(84);
    M([2377, 2431, 2493, 2553, 2720, 2774, 2836, 2889, 2951, 3127, 3238, 3300, 3413, 3474, 3524, 3586, 3647, 3703, 3753, 3815, 3876]) = C(87);

    [L,~,P] = lu(M(:,1:52));
    L = [L [zeros(52,5); eye(5)]];
    M1 = (P'*L)\M;
    M2 = M1(end-4:end,53:57);
    M3 = M1(end-4:end,58:end);

    A = zeros(16);
    A(1:5,:) = -M2\M3;
    A([6, 23, 56, 73, 90, 107, 124, 173, 190, 207, 240]) = 1;

    [V,~] = eig(A);
    sol = V([9, 14, 15],:)./(ones(3,1)*V(16,:));

    if(find(isnan( sol(:) )) > 0)
        x = zeros(1,0);
        y = zeros(1,0);
        z = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        x = sol(1,:);
        y = sol(2,:);
        z = sol(3,:);
    end

end