function C = coefs_refract5p(x,X)

M = [2*x(3,:); 2*x(1,:); -x(2,:); -2*(X(1,:).*x(1,:)-X(2,:).*x(2,:));...
    X(1,:).*x(2,:)+X(2,:).*x(1,:); -2*x(3,:); -2*x(3,:); -2*x(3,:); 2*x(1,:);...
    -x(2,:); -x(1,:); x(2,:); x(1,:); -X(1,:).*x(2,:)-X(2,:).*x(1,:); x(1,:);...
    -2*x(2,:); 2*x(2,:); x(2,:); -x(1,:); -X(1,:).*x(2,:)+X(2,:).*x(1,:);...
    X(1,:).*x(2,:)-X(2,:).*x(1,:); 2*X(2,:).*x(3,:); -2*X(1,:).*x(3,:);...
    2*X(1,:).*x(3,:); 2*X(2,:).*x(3,:); -2*(X(1,:).*x(1,:)+X(2,:).*x(2,:))]';

M = rref(M);

a1 = M(1,20);
a2 = M(1,22);
a3 = M(1,23);
a4 = M(1,26);
b1 = M(2,20);
b2 = M(2,22);
b3 = M(2,23);
b4 = M(2,26);
c1 = M(3,20);
c2 = M(3,22);
c3 = M(3,23);
c4 = M(3,26);
d1 = M(4,20);
d2 = M(4,22);
d3 = M(4,23);
d4 = M(4,26);
e1 = M(5,20);
e2 = M(5,22);
e3 = M(5,23);
e4 = M(5,26);

C = zeros(3,29);

C([1,7,34,40]) = a2;
C([4,10]) = a3;
C(13) = -a1-2*b2;
C([16,61]) = -2*b3+c2;
C(19) = -a1+c3;
C([22,79]) = -a2+2*b1;
C(25) = -a3-c1;
C(28) = a1;
C([31,37]) = -a3;
C([43,46]) = a4+2*b3+c2;
C(49) = a3-2*b4-c1;
C([52,67]) = -a2-2*b1+c4;
C([55,82]) = -a4;
C(58) = a1-c3;
C(64) = a1+2*b2;
C(70) = -a3+2*b4+c1;
C(76) = a3+c1;
C(85) = -a1;
C([60,62]) = 1;
C([68,80]) = d2;
C(71) = d3;
C(74) = -d1;
C(77) = -d3;
C(83) = d4;
C(86) = d1;
C(66) = -1;
C([69,81]) = e2;
C(72) = e3;
C(75) = -e1;
C(78) = -e3;
C(84) = e4;
C(87) = e1;

end