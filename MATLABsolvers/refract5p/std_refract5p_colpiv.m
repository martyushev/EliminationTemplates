% Input: coefficient matrix C of size 3x29

% Monomial vector: [z*x^3, z*x^2*y, z*y^2*x, z*y^3, z^2*x^2, z^2*x*y, z^2*y^2, z^3*x, z^3*y, z^4, x^3, x^2*y, x*y^2, y^3, z*x^2, z*y^2, z^2*x, z^2*y, z^3, x^2, y*x, y^2, x*z, z*y, z^2, x, y, z, 1]

function [x, y, z] = std_refract5p_colpiv(C)

    M = zeros(57,73);

    M([3, 229, 289, 519, 1313, 1373, 1603, 2402]) = C(1);
    M([60, 286, 346, 576, 1370, 1430, 1660, 2459]) = C(4);
    M([117, 343, 403, 633, 1427, 1487, 1717, 2516]) = C(7);
    M([174, 400, 460, 690, 1484, 1544, 1774, 2573]) = C(10);
    M([345, 514, 574, 747, 1598, 1658, 1831, 2630]) = C(13);
    M([402, 571, 631, 804, 1655, 1715, 1888, 2687]) = C(16);
    M([459, 628, 688, 861, 1712, 1772, 1945, 3314]) = C(19);
    M([630, 742, 802, 918, 1826, 1886, 2002, 2744]) = C(22);
    M([687, 799, 859, 975, 1883, 1943, 2059, 3371]) = C(25);
    M([858, 913, 973, 1032, 1997, 2057, 3256, 3428]) = C(28);
    M([1086, 1312, 1372, 1602, 2111, 2171, 2401, 2801]) = C(31);
    M([1143, 1369, 1429, 1659, 2168, 2228, 2458, 2858]) = C(34);
    M([1200, 1426, 1486, 1716, 2225, 2285, 2515, 2915]) = C(37);
    M([1257, 1483, 1543, 1773, 2282, 2342, 2572, 3485]) = C(40);
    M([1428, 1597, 1657, 1830, 2396, 2456, 2629, 2972]) = C(43);
    M([1542, 1711, 1771, 1944, 2510, 2570, 3313, 3542]) = C(46);
    M([1713, 1825, 1885, 2001, 2624, 2684, 2743, 3086]) = C(49);
    M([1770, 1882, 1942, 2058, 2681, 3311, 3370, 3599]) = C(52);
    M([1941, 1996, 2056, 2738, 3255, 3368, 3427, 3656]) = C(55);
    M([2226, 2395, 2455, 2628, 2795, 2855, 2971, 3143]) = C(58);
    M([2283, 2452, 2512, 2685, 2852, 2912, 3028, 3200]) = C(61);
    M([2340, 2509, 2569, 2909, 3312, 3482, 3541, 3713]) = C(64);
    M([2511, 2623, 2683, 2742, 2966, 3026, 3085, 3770]) = C(67);
    M([2568, 2680, 3023, 3310, 3369, 3539, 3598, 3827]) = C(70);
    M([2910, 2965, 3025, 3084, 3137, 3197, 3769, 3941]) = C(76);
    M([3022, 3194, 3480, 3538, 3597, 3710, 3826, 3998]) = C(79);
    M([3079, 3537, 3595, 3654, 3764, 3824, 3883, 4055]) = C(82);
    M([3708, 3763, 3823, 3882, 3935, 3995, 4054, 4112]) = C(85);
    M([9, 71, 137, 296, 358, 424, 589, 655, 830, 1093, 1155, 1221, 1380, 1442, 1508, 1673, 1739, 1914, 2179, 2241, 2307, 2472, 2538, 2713, 2872, 2938, 3056, 3228]) = C(62);
    M([294, 356, 422, 524, 586, 652, 760, 826, 944, 1378, 1440, 1506, 1608, 1670, 1736, 1844, 1910, 2028, 2407, 2469, 2535, 2643, 2709, 2770, 2986, 3052, 3113, 3798]) = C(68);
    M([351, 413, 479, 581, 643, 709, 817, 883, 1001, 1435, 1497, 1563, 1665, 1727, 1793, 1901, 1967, 2085, 2464, 2526, 2592, 2700, 3043, 3336, 3397, 3565, 3626, 3855]) = C(71);
    M([579, 641, 707, 752, 814, 880, 931, 997, 1058, 1663, 1725, 1791, 1836, 1898, 1964, 2015, 2081, 2635, 2697, 2757, 3100, 3282, 3333, 3393, 3454, 3622, 3683, 3912]) = C(74);
    M([1377, 1439, 1505, 1607, 1669, 1735, 1843, 1909, 2027, 2176, 2238, 2304, 2406, 2468, 2534, 2642, 2708, 2769, 2806, 2868, 2934, 2985, 3051, 3112, 3157, 3223, 3797, 3969]) = C(77);
    M([1434, 1496, 1562, 1664, 1726, 1792, 1900, 1966, 2084, 2233, 2295, 2361, 2463, 2525, 2591, 2699, 2863, 2925, 3042, 3214, 3335, 3396, 3504, 3564, 3625, 3736, 3854, 4026]) = C(80);
    M([1662, 1724, 1790, 1835, 1897, 1963, 2014, 2080, 2461, 2523, 2589, 2634, 2696, 2756, 2977, 3039, 3099, 3281, 3332, 3392, 3453, 3561, 3621, 3682, 3784, 3850, 3911, 4083]) = C(83);
    M([2460, 2522, 2588, 2633, 2695, 2755, 2860, 2922, 2976, 3038, 3098, 3148, 3210, 3331, 3391, 3452, 3501, 3560, 3620, 3681, 3732, 3783, 3849, 3910, 3955, 4021, 4082, 4140]) = C(86);
    M([40, 106, 265, 327, 393, 558, 624, 797, 1124, 1190, 1349, 1411, 1477, 1642, 1708, 1881, 2148, 2210, 2276, 2441, 2841]) = C(60);
    M([154, 220, 379, 441, 507, 672, 738, 911, 1238, 1304, 1463, 1525, 1591, 1756, 1822, 1995, 2262, 2324, 2390, 2555, 2955]) = C(66);
    M([382, 448, 550, 612, 678, 786, 852, 968, 1466, 1532, 1634, 1696, 1762, 1870, 1936, 2052, 2433, 2495, 2561, 2669, 3012]) = C(69);
    M([439, 505, 607, 669, 735, 843, 909, 1025, 1523, 1589, 1691, 1753, 1819, 1927, 1993, 2109, 2490, 2552, 2618, 2726, 3069]) = C(72);
    M([667, 733, 778, 840, 906, 957, 1023, 1082, 1751, 1817, 1862, 1924, 1990, 2041, 2107, 2661, 2723, 2783, 3126, 3306, 3359]) = C(75);
    M([1465, 1531, 1633, 1695, 1761, 1869, 1935, 2051, 2264, 2330, 2432, 2494, 2560, 2668, 2734, 2793, 2832, 2894, 2960, 3011, 3183]) = C(78);
    M([1522, 1588, 1690, 1752, 1818, 1926, 1992, 2108, 2321, 2387, 2489, 2551, 2617, 2725, 2889, 2951, 3068, 3240, 3361, 3420, 3530]) = C(81);
    M([1750, 1816, 1861, 1923, 1989, 2040, 2106, 2549, 2615, 2660, 2722, 2782, 3003, 3065, 3125, 3305, 3358, 3418, 3477, 3587, 3810]) = C(84);
    M([2548, 2614, 2659, 2721, 2781, 2948, 3002, 3064, 3124, 3174, 3236, 3357, 3417, 3476, 3527, 3586, 3646, 3705, 3758, 3809, 3981]) = C(87);

    [L,UR,Pi] = lu(M(:,1:19));
    Pi = Pi';
    M = [Pi*L Pi(:,20:end)]\M(:,20:end);
    MP = M(1:19,:);
    NP = M(20:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-4));
    A = UR\[MP(:,1:end-4)*Pi MP(:,end-3:end)];
    B = U(:,1:38)\[U(:,39:end) Q'*NP(:,end-3:end)];
    M = [-A(:,end-15:end)+A(:,1:end-16)*B; -B];

    xP = [55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 17, 24, 25, 26, 28, 29, 30, 34, 35, 73, 16, 18, 39, 27, 40, 41, 42, 44, 36, 45, 46, 48, 49, 50, 53];
    P1 = [(1:50)*Pi 51:54];
    T = getT(M,[55:73 P1(1:end-16)],P1(end-15:end),xP);

    [V,~] = eig(T);
    sol = V([13, 14, 15],:)./(ones(3,1)*V(16,:));

    if(find(isnan( sol(:) )) > 0)
        x = zeros(1,0);
        y = zeros(1,0);
        z = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        x = sol(1,:);
        y = sol(2,:);
        z = sol(3,:);
    end

end