% Input: coefficient matrix C of size 4x25

% Monomial vector: [x^6, y^2*x^4, x^2*y^4, y^6, x^5, x^4*y, x^3*y^2, x^2*y^3, x*y^4, y^5, x^4, y*x^3, y^2*x^2, y^3*x, y^4, x^3, y*x^2, y^2*x, y^3, x^2, y*x, y^2, x, y, 1]

function [x, y] = std_pose_35pt(C)

    M = zeros(18,28);

    M([1, 21, 38, 58, 113]) = C(1);
    M([19, 74, 94, 149]) = C(5);
    M([37, 75, 110, 130, 167]) = C(17);
    M([55, 93, 128, 148, 185]) = C(21);
    M([73, 146, 203]) = C(25);
    M([91, 221]) = C(29);
    M([109, 147, 164, 184, 257]) = C(41);
    M([127, 182, 202, 275]) = C(45);
    M([145, 200, 220, 293]) = C(49);
    M([218, 311]) = C(53);
    M(239) = C(57);
    M([163, 201, 254, 274, 329]) = C(61);
    M([181, 219, 272, 292, 347]) = C(65);
    M([199, 290, 310, 365]) = C(69);
    M([217, 238, 308, 383]) = C(73);
    M([253, 291, 326, 346, 401]) = C(77);
    M([271, 309, 344, 364, 419]) = C(81);
    M([237, 289, 362, 382, 437]) = C(85);
    M([325, 363, 398, 418, 455]) = C(89);
    M([343, 381, 416, 436, 473]) = C(93);
    M([397, 435, 452, 472, 491]) = C(97);
    M([6, 26, 43, 63, 118]) = C(2);
    M([24, 79, 99, 154]) = C(6);
    M([42, 80, 115, 135, 172]) = C(18);
    M([60, 98, 133, 153, 190]) = C(22);
    M([78, 151, 208]) = C(26);
    M([96, 226]) = C(30);
    M([114, 152, 169, 189, 262]) = C(42);
    M([132, 187, 207, 280]) = C(46);
    M([150, 205, 225, 298]) = C(50);
    M([223, 316]) = C(54);
    M(244) = C(58);
    M([168, 206, 259, 279, 334]) = C(62);
    M([186, 224, 277, 297, 352]) = C(66);
    M([204, 295, 315, 370]) = C(70);
    M([222, 243, 313, 388]) = C(74);
    M([258, 296, 331, 351, 406]) = C(78);
    M([276, 314, 349, 369, 424]) = C(82);
    M([242, 294, 367, 387, 442]) = C(86);
    M([330, 368, 403, 423, 460]) = C(90);
    M([348, 386, 421, 441, 478]) = C(94);
    M([402, 440, 457, 477, 496]) = C(98);
    M([47, 66, 121]) = C(3);
    M([83, 102, 157]) = C(7);
    M([119, 138, 175]) = C(19);
    M([137, 156, 193]) = C(23);
    M([155, 211]) = C(27);
    M(229) = C(31);
    M([173, 192, 265]) = C(43);
    M([191, 210, 283]) = C(47);
    M([209, 228, 301]) = C(51);
    M([227, 319]) = C(55);
    M(247) = C(59);
    M([263, 282, 337]) = C(63);
    M([281, 300, 355]) = C(67);
    M([299, 318, 373]) = C(71);
    M([246, 317, 391]) = C(75);
    M([335, 354, 409]) = C(79);
    M([353, 372, 427]) = C(83);
    M([371, 390, 445]) = C(87);
    M([407, 426, 463]) = C(91);
    M([425, 444, 481]) = C(95);
    M([461, 480, 499]) = C(99);
    M([14, 34, 51, 71, 126]) = C(4);
    M([32, 87, 107, 162]) = C(8);
    M([50, 88, 123, 143, 180]) = C(20);
    M([68, 106, 141, 161, 198]) = C(24);
    M([86, 159, 216]) = C(28);
    M([104, 234]) = C(32);
    M([122, 160, 177, 197, 270]) = C(44);
    M([140, 195, 215, 288]) = C(48);
    M([158, 213, 233, 306]) = C(52);
    M([231, 324]) = C(56);
    M(252) = C(60);
    M([176, 214, 267, 287, 342]) = C(64);
    M([194, 232, 285, 305, 360]) = C(68);
    M([212, 303, 323, 378]) = C(72);
    M([230, 251, 321, 396]) = C(76);
    M([266, 304, 339, 359, 414]) = C(80);
    M([284, 322, 357, 377, 432]) = C(84);
    M([250, 302, 375, 395, 450]) = C(88);
    M([338, 376, 411, 431, 468]) = C(92);
    M([356, 394, 429, 449, 486]) = C(96);
    M([410, 448, 465, 485, 504]) = C(100);

    [L,~,Pi] = lu(M(:,1:14));
    Pi = Pi';
    M = [Pi*L Pi(:,15:end)]\M(:,15:end);
    M = M(end-3:end,:);

    A = zeros(10);
    A(1:4,:) = -M(:,1:4)\M(:,5:end);
    A([5, 16, 27, 48, 59, 80]) = 1;

    [V,~] = eig(A);
    sol = V([8, 9],:)./(ones(2,1)*V(10,:));

    if(find(isnan( sol(:) )) > 0)
        x = zeros(1,0);
        y = zeros(1,0);
    else
        %I = find(not(imag( sol(1,:) )));
        x = sol(1,:);
        y = sol(2,:);
    end

end