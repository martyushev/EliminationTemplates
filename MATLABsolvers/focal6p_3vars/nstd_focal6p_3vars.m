% Input: coefficient matrix C of size 10x26

% Monomial vector: [1, g, v, u, g^2*v^2, u*g^2, v*g^2, g*u^3, v^3*g, v*u, g*u, g*v, v*u^2, v^2*u, u^2*g, g*v^2, g^2*u^2, g^2, v^3, u^3, v^2, u^2, g^2*u*v, g*u*v, g*u^2*v, v^2*u*g]

% Zero entries of matrix C: {[1, 17], [2, 5], [3, 5], [3, 17], [3, 23], [4, 17], [5, 5], [6, 5], [6, 17], [6, 23], [7, 1], [7, 5], [7, 6], [7, 8], [7, 17], [7, 18], [7, 23], [8, 1], [8, 5], [8, 7], [8, 9], [8, 17], [8, 18], [8, 23], [9, 5], [9, 6], [9, 7], [9, 8], [9, 9], [9, 17], [9, 23], [9, 25], [9, 26], [10, 2], [10, 5], [10, 6], [10, 7], [10, 8], [10, 9], [10, 11], [10, 12], [10, 15], [10, 16], [10, 17], [10, 18], [10, 23], [10, 24], [10, 25], [10, 26]}

function [g,u,v] = nstd_focal6p_3vars(C)

    M = zeros(11,26);

    M(276) = C(1);
    M(243) = C(11);
    M(265) = C(21);
    M(254) = C(31);
    M(23) = C(41);
    M(122) = C(51);
    M(144) = C(61);
    M(45) = C(71);
    M(12) = C(81);
    M(188) = C(91);
    M(221) = C(101);
    M(232) = C(111);
    M(100) = C(121);
    M(111) = C(131);
    M(133) = C(141);
    M(166) = C(151);
    M(210) = C(171);
    M(1) = C(181);
    M(89) = C(191);
    M(199) = C(201);
    M(177) = C(211);
    M(56) = C(221);
    M(155) = C(231);
    M(67) = C(241);
    M(78) = C(251);
    M(277) = C(2);
    M(244) = C(12);
    M(266) = C(22);
    M(255) = C(32);
    M(123) = C(52);
    M(145) = C(62);
    M(46) = C(72);
    M(13) = C(82);
    M(189) = C(92);
    M(222) = C(102);
    M(233) = C(112);
    M(101) = C(122);
    M(112) = C(132);
    M(134) = C(142);
    M(167) = C(152);
    M(35) = C(162);
    M(211) = C(172);
    M(2) = C(182);
    M(90) = C(192);
    M(200) = C(202);
    M(178) = C(212);
    M(57) = C(222);
    M(156) = C(232);
    M(68) = C(242);
    M(79) = C(252);
    M(278) = C(3);
    M(245) = C(13);
    M(267) = C(23);
    M(256) = C(33);
    M(124) = C(53);
    M(146) = C(63);
    M(47) = C(73);
    M(14) = C(83);
    M(190) = C(93);
    M(223) = C(103);
    M(234) = C(113);
    M(102) = C(123);
    M(113) = C(133);
    M(135) = C(143);
    M(168) = C(153);
    M(212) = C(173);
    M(3) = C(183);
    M(91) = C(193);
    M(201) = C(203);
    M(179) = C(213);
    M(157) = C(233);
    M(69) = C(243);
    M(80) = C(253);
    M(279) = C(4);
    M(246) = C(14);
    M(268) = C(24);
    M(257) = C(34);
    M(26) = C(44);
    M(125) = C(54);
    M(147) = C(64);
    M(48) = C(74);
    M(15) = C(84);
    M(191) = C(94);
    M(224) = C(104);
    M(235) = C(114);
    M(103) = C(124);
    M(114) = C(134);
    M(136) = C(144);
    M(169) = C(154);
    M(213) = C(174);
    M(4) = C(184);
    M(92) = C(194);
    M(202) = C(204);
    M(180) = C(214);
    M(59) = C(224);
    M(158) = C(234);
    M(70) = C(244);
    M(81) = C(254);
    M(280) = C(5);
    M(247) = C(15);
    M(269) = C(25);
    M(258) = C(35);
    M(126) = C(55);
    M(148) = C(65);
    M(49) = C(75);
    M(16) = C(85);
    M(192) = C(95);
    M(225) = C(105);
    M(236) = C(115);
    M(104) = C(125);
    M(115) = C(135);
    M(137) = C(145);
    M(170) = C(155);
    M(38) = C(165);
    M(214) = C(175);
    M(5) = C(185);
    M(93) = C(195);
    M(203) = C(205);
    M(181) = C(215);
    M(60) = C(225);
    M(159) = C(235);
    M(71) = C(245);
    M(82) = C(255);
    M(281) = C(6);
    M(248) = C(16);
    M(270) = C(26);
    M(259) = C(36);
    M(127) = C(56);
    M(149) = C(66);
    M(50) = C(76);
    M(17) = C(86);
    M(193) = C(96);
    M(226) = C(106);
    M(237) = C(116);
    M(105) = C(126);
    M(116) = C(136);
    M(138) = C(146);
    M(171) = C(156);
    M(215) = C(176);
    M(6) = C(186);
    M(94) = C(196);
    M(204) = C(206);
    M(182) = C(216);
    M(160) = C(236);
    M(72) = C(246);
    M(83) = C(256);
    M(249) = C(17);
    M(271) = C(27);
    M(260) = C(37);
    M(150) = C(67);
    M(18) = C(87);
    M(194) = C(97);
    M(227) = C(107);
    M(238) = C(117);
    M(106) = C(127);
    M(117) = C(137);
    M(139) = C(147);
    M(172) = C(157);
    M(7) = C(187);
    M(95) = C(197);
    M(205) = C(207);
    M(183) = C(217);
    M(161) = C(237);
    M(73) = C(247);
    M(84) = C(257);
    M(250) = C(18);
    M(272) = C(28);
    M(261) = C(38);
    M(129) = C(58);
    M(52) = C(78);
    M(195) = C(98);
    M(228) = C(108);
    M(239) = C(118);
    M(107) = C(128);
    M(118) = C(138);
    M(140) = C(148);
    M(173) = C(158);
    M(8) = C(188);
    M(96) = C(198);
    M(206) = C(208);
    M(184) = C(218);
    M(162) = C(238);
    M(74) = C(248);
    M(85) = C(258);
    M(284) = C(9);
    M(251) = C(19);
    M(273) = C(29);
    M(262) = C(39);
    M(196) = C(99);
    M(229) = C(109);
    M(240) = C(119);
    M(108) = C(129);
    M(119) = C(139);
    M(141) = C(149);
    M(174) = C(159);
    M(218) = C(179);
    M(9) = C(189);
    M(97) = C(199);
    M(207) = C(209);
    M(185) = C(219);
    M(163) = C(239);
    M([252, 286]) = C(10);
    M([241, 275]) = C(30);
    M([230, 264]) = C(40);
    M([164, 198]) = C(100);
    M([76, 110]) = C(130);
    M([87, 121]) = C(140);
    M([11, 21]) = C(190);
    M([54, 99]) = C(200);
    M([175, 209]) = C(210);
    M([142, 187]) = C(220);

    M = rref(M);

    A = zeros(15);
    amcols = 12:26;
    A(1,:) = -M(4,amcols);
    A(2,:) = -M(5,amcols);
    A(3,:) = -M(6,amcols);
    A(4,:) = -M(7,amcols);
    A(5,:) = -M(8,amcols);
    A(6,:) = -M(9,amcols);
    A(7,:) = -M(10,amcols);
    A(8,:) = -M(11,amcols);
    A(9,1) = 1;
    A(10,2) = 1;
    A(11,4) = 1;
    A(12,10) = 1;
    A(13,6) = 1;
    A(14,7) = 1;
    A(15,13) = 1;

    [V,~] = eig(A);

    sol =  V([12,13,14],:)./(ones(3,1)*V(15,:));

    if(find(isnan( sol(:) )) > 0)
        g = zeros(1,0);
        u = zeros(1,0);
        v = zeros(1,0);
    else
        I = find(not(imag( sol(1,:) )) & sol(1,:) > 0);
        g = sol(1,I);
        u = sol(2,I);
        v = sol(3,I);
    end

end