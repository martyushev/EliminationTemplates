function [g,u,v] = std_focal6p_3vars(C)

    % monomial vector: [1, g, v, u, g^2*v^2, u*g^2, v*g^2, u^3*g, v^3*g, v*u, g*u, g*v, v*u^2, v^2*u, u^2*g, v^2*g, g^2*u^2, g^2, v^3, u^3, v^2, u^2, g^2*u*v, g*u*v, u^2*v*g, v^2*u*g]

    %C = rand(10,26);

    % zero entries: [[1, 17], [2, 5], [3, 5], [3, 17], [3, 23], [4, 17], [5, 5], [6, 5], [6, 17], [6, 23], [7, 1], [7, 5], [7, 6], [7, 8], [7, 17], [7, 18], [7, 23], [8, 1], [8, 5], [8, 7], [8, 9], [8, 17], [8, 18], [8, 23], [9, 5], [9, 6], [9, 7], [9, 8], [9, 9], [9, 17], [9, 23], [9, 25], [9, 26], [10, 2], [10, 5], [10, 6], [10, 7], [10, 8], [10, 9], [10, 11], [10, 12], [10, 15], [10, 16], [10, 17], [10, 18], [10, 23], [10, 24], [10, 25], [10, 26]]

    M = zeros(12,27);

    M(313) = C(1,1);
    M(277) = C(1,2);
    M(289) = C(1,3);
    M(301) = C(1,4);
    M(25) = C(1,5);
    M(121) = C(1,6);
    M(109) = C(1,7);
    M(97) = C(1,8);
    M(13) = C(1,9);
    M(253) = C(1,10);
    M(229) = C(1,11);
    M(217) = C(1,12);
    M(181) = C(1,13);
    M(169) = C(1,14);
    M(157) = C(1,15);
    M(133) = C(1,16);
    M(193) = C(1,18);
    M(1) = C(1,19);
    M(205) = C(1,20);
    M(241) = C(1,21);
    M(265) = C(1,22);
    M(37) = C(1,23);
    M(145) = C(1,24);
    M(73) = C(1,25);
    M(61) = C(1,26);
    M(314) = C(2,1);
    M(278) = C(2,2);
    M(290) = C(2,3);
    M(302) = C(2,4);
    M(122) = C(2,6);
    M(110) = C(2,7);
    M(98) = C(2,8);
    M(14) = C(2,9);
    M(254) = C(2,10);
    M(230) = C(2,11);
    M(218) = C(2,12);
    M(182) = C(2,13);
    M(170) = C(2,14);
    M(158) = C(2,15);
    M(134) = C(2,16);
    M(50) = C(2,17);
    M(194) = C(2,18);
    M(2) = C(2,19);
    M(206) = C(2,20);
    M(242) = C(2,21);
    M(266) = C(2,22);
    M(38) = C(2,23);
    M(146) = C(2,24);
    M(74) = C(2,25);
    M(62) = C(2,26);
    M(315) = C(3,1);
    M(279) = C(3,2);
    M(291) = C(3,3);
    M(303) = C(3,4);
    M(123) = C(3,6);
    M(111) = C(3,7);
    M(99) = C(3,8);
    M(15) = C(3,9);
    M(255) = C(3,10);
    M(231) = C(3,11);
    M(219) = C(3,12);
    M(183) = C(3,13);
    M(171) = C(3,14);
    M(159) = C(3,15);
    M(135) = C(3,16);
    M(195) = C(3,18);
    M(3) = C(3,19);
    M(207) = C(3,20);
    M(243) = C(3,21);
    M(267) = C(3,22);
    M(147) = C(3,24);
    M(75) = C(3,25);
    M(63) = C(3,26);
    M(316) = C(4,1);
    M(280) = C(4,2);
    M(292) = C(4,3);
    M(304) = C(4,4);
    M(28) = C(4,5);
    M(124) = C(4,6);
    M(112) = C(4,7);
    M(100) = C(4,8);
    M(16) = C(4,9);
    M(256) = C(4,10);
    M(232) = C(4,11);
    M(220) = C(4,12);
    M(184) = C(4,13);
    M(172) = C(4,14);
    M(160) = C(4,15);
    M(136) = C(4,16);
    M(196) = C(4,18);
    M(4) = C(4,19);
    M(208) = C(4,20);
    M(244) = C(4,21);
    M(268) = C(4,22);
    M(40) = C(4,23);
    M(148) = C(4,24);
    M(76) = C(4,25);
    M(64) = C(4,26);
    M(317) = C(5,1);
    M(281) = C(5,2);
    M(293) = C(5,3);
    M(305) = C(5,4);
    M(125) = C(5,6);
    M(113) = C(5,7);
    M(101) = C(5,8);
    M(17) = C(5,9);
    M(257) = C(5,10);
    M(233) = C(5,11);
    M(221) = C(5,12);
    M(185) = C(5,13);
    M(173) = C(5,14);
    M(161) = C(5,15);
    M(137) = C(5,16);
    M(53) = C(5,17);
    M(197) = C(5,18);
    M(5) = C(5,19);
    M(209) = C(5,20);
    M(245) = C(5,21);
    M(269) = C(5,22);
    M(41) = C(5,23);
    M(149) = C(5,24);
    M(77) = C(5,25);
    M(65) = C(5,26);
    M(318) = C(6,1);
    M(282) = C(6,2);
    M(294) = C(6,3);
    M(306) = C(6,4);
    M(126) = C(6,6);
    M(114) = C(6,7);
    M(102) = C(6,8);
    M(18) = C(6,9);
    M(258) = C(6,10);
    M(234) = C(6,11);
    M(222) = C(6,12);
    M(186) = C(6,13);
    M(174) = C(6,14);
    M(162) = C(6,15);
    M(138) = C(6,16);
    M(198) = C(6,18);
    M(6) = C(6,19);
    M(210) = C(6,20);
    M(246) = C(6,21);
    M(270) = C(6,22);
    M(150) = C(6,24);
    M(78) = C(6,25);
    M(66) = C(6,26);
    M(283) = C(7,2);
    M(295) = C(7,3);
    M(307) = C(7,4);
    M(115) = C(7,7);
    M(19) = C(7,9);
    M(259) = C(7,10);
    M(235) = C(7,11);
    M(223) = C(7,12);
    M(187) = C(7,13);
    M(175) = C(7,14);
    M(163) = C(7,15);
    M(139) = C(7,16);
    M(7) = C(7,19);
    M(211) = C(7,20);
    M(247) = C(7,21);
    M(271) = C(7,22);
    M(151) = C(7,24);
    M(79) = C(7,25);
    M(67) = C(7,26);
    M(284) = C(8,2);
    M(296) = C(8,3);
    M(308) = C(8,4);
    M(128) = C(8,6);
    M(104) = C(8,8);
    M(260) = C(8,10);
    M(236) = C(8,11);
    M(224) = C(8,12);
    M(188) = C(8,13);
    M(176) = C(8,14);
    M(164) = C(8,15);
    M(140) = C(8,16);
    M(8) = C(8,19);
    M(212) = C(8,20);
    M(248) = C(8,21);
    M(272) = C(8,22);
    M(152) = C(8,24);
    M(80) = C(8,25);
    M(68) = C(8,26);
    M([285, 322]) = C(9,1);
    M([201, 286]) = C(9,2);
    M([225, 298]) = C(9,3);
    M([237, 310]) = C(9,4);
    M([153, 262]) = C(9,10);
    M([129, 238]) = C(9,11);
    M([117, 226]) = C(9,12);
    M([81, 190]) = C(9,13);
    M([69, 178]) = C(9,14);
    M([57, 166]) = C(9,15);
    M([33, 142]) = C(9,16);
    M([93, 202]) = C(9,18);
    M([10, 21]) = C(9,19);
    M([105, 214]) = C(9,20);
    M([141, 250]) = C(9,21);
    M([165, 274]) = C(9,22);
    M([45, 154]) = C(9,24);
    M([287, 324]) = C(10,1);
    M([227, 300]) = C(10,3);
    M([239, 312]) = C(10,4);
    M([155, 264]) = C(10,10);
    M([83, 192]) = C(10,13);
    M([71, 180]) = C(10,14);
    M([12, 23]) = C(10,19);
    M([107, 216]) = C(10,20);
    M([143, 252]) = C(10,21);
    M([167, 276]) = C(10,22);

    M = rref(M);

    A = zeros(15);
    amcols = 13:27;
    A(1,:) = -M(4,amcols);
    A(2,:) = -M(5,amcols);
    A(3,:) = -M(6,amcols);
    A(4,:) = -M(7,amcols);
    A(5,:) = -M(8,amcols);
    A(6,:) = -M(9,amcols);
    A(7,:) = -M(10,amcols);
    A(8,:) = -M(11,amcols);
    A(9,:) = -M(12,amcols);
    A(10,1) = 1;
    A(11,2) = 1;
    A(12,5) = 1;
    A(13,7) = 1;
    A(14,8) = 1;
    A(15,12) = 1;

    [V,~] = eig(A);

    sol =  V([12,14,13],:)./(ones(3,1)*V(15,:));

    if(find(isnan( sol(:) )) > 0)
        g = zeros(1,0);
        u = zeros(1,0);
        v = zeros(1,0);
    else
        I = find(not(imag( sol(1,:) )) & sol(1,:) > 0);
        g = sol(1,I);
        u = sol(2,I);
        v = sol(3,I);
    end

end