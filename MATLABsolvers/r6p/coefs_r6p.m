function C = coefs_r6p(data)

q = data{1};
X = data{2};
A = data{3};

C = zeros(6,16);

q11 = q(1)^2;
q33 = q(3)^2;
q55 = q(5)^2;
q12 = q(1)*q(2);
q34 = q(3)*q(4);
q56 = q(5)*q(6);

C(1) = A(6)*q12 - X(3)*q12 + A(3)*q(2) - A(5)*q(1) + q(1)*X(2) - A(2);
C(7) = A(12)*q12 + A(9)*q(2) - A(11)*q(1) - q(1)*X(1) - A(8);
C(13) = A(18)*q12 + X(1)*q12 + A(15)*q(2) - A(17)*q(1) - A(14);
C(19) = A(24)*q12 + A(21)*q(2) - A(23)*q(1) - A(20);
C(25) = A(30)*q12 - X(3)*q12 + A(27)*q(2) - A(29)*q(1) - A(26);
C(31) = A(36)*q12 + X(2)*q12 + A(33)*q(2) - A(35)*q(1) - A(32);
C(37) = A(42)*q12 + A(39)*q(2) - A(41)*q(1) - A(38);
C(43) = A(48)*q12 + A(45)*q(2) - A(47)*q(1) - q(1)*X(3) - A(44);
C(49) = A(54)*q12 + A(51)*q(2) - A(53)*q(1) + X(2)*q(1) - A(50);
C(55) = A(60)*q12 + A(57)*q(2) - A(59)*q(1) + X(2)*q(2) - A(56) + X(3);
C(61) = A(66)*q12 + A(63)*q(2) - A(65)*q(1) - X(1)*q(2) - A(62);
C(67) = A(72)*q12 + A(69)*q(2) - A(71)*q(1) - A(68) - X(1);
C(73) = A(78)*q12 + X(2)*q12 + A(75)*q(2) - A(77)*q(1) + q(1)*X(3) - A(74);
C(79) = A(84)*q12 - X(1)*q12 + A(81)*q(2) - A(83)*q(1) - A(80);
C(85) = A(90)*q12 + A(87)*q(2) - A(89)*q(1) - X(1)*q(1) - A(86);
C(91) = q(2)*A(96)*q(1) + q(2)*A(93) - A(95)*q(1) + q(2)*X(3) - A(92) - X(2);
C(2) = -A(6)*q11 + X(3)*q11 - A(3)*q(1) + A(4)*q(1) + A(1);
C(8) = -A(12)*q11 - A(9)*q(1) + A(10)*q(1) + A(7);
C(14) = -A(18)*q11 - X(1)*q11 - A(15)*q(1) + A(16)*q(1) + A(13);
C(20) = -A(24)*q11 - A(21)*q(1) + A(22)*q(1) + X(2)*q(1) + A(19);
C(26) = -A(30)*q11 + X(3)*q11 - A(27)*q(1) + A(28)*q(1) - X(1)*q(1) + A(25);
C(32) = -A(36)*q11 - X(2)*q11 - A(33)*q(1) + A(34)*q(1) + A(31);
C(38) = -A(42)*q11 - A(39)*q(1) + A(40)*q(1) + q(1)*X(3) + A(37);
C(44) = -A(48)*q11 - A(45)*q(1) + A(46)*q(1) + A(43);
C(50) = -A(54)*q11 - A(51)*q(1) + A(52)*q(1) - X(1)*q(1) + A(49);
C(56) = -A(60)*q11 - A(57)*q(1) + A(58)*q(1) - X(2)*q(1) + A(55);
C(62) = -A(66)*q11 - A(63)*q(1) + A(64)*q(1) + X(1)*q(1) + A(61) + X(3);
C(68) = -A(72)*q11 - A(69)*q(1) + A(70)*q(1) + A(67) - X(2);
C(74) = -A(78)*q11 - X(2)*q11 - A(75)*q(1) + A(76)*q(1) + A(73);
C(80) = -A(84)*q11 + X(1)*q11 - A(81)*q(1) + A(82)*q(1) + q(1)*X(3) + A(79);
C(86) = -A(90)*q11 - A(87)*q(1) + A(88)*q(1) - X(2)*q(1) + A(85);
C(92) = -A(96)*q11 - q(1)*A(93) + A(94)*q(1) - q(1)*X(3) + A(91) + X(1);
C(3) = A(6)*q34 - X(6)*q34 + A(3)*q(4) - A(5)*q(3) + X(5)*q(3) - A(2);
C(9) = A(12)*q34 + A(9)*q(4) - A(11)*q(3) - X(4)*q(3) - A(8);
C(15) = A(18)*q34 + X(4)*q34 + A(15)*q(4) - A(17)*q(3) - A(14);
C(21) = A(24)*q34 + A(21)*q(4) - A(23)*q(3) - A(20);
C(27) = A(30)*q34 - X(6)*q34 + A(27)*q(4) - A(29)*q(3) - A(26);
C(33) = A(36)*q34 + X(5)*q34 + A(33)*q(4) - A(35)*q(3) - A(32);
C(39) = A(42)*q34 + A(39)*q(4) - A(41)*q(3) - A(38);
C(45) = A(48)*q34 + A(45)*q(4) - A(47)*q(3) - q(3)*X(6) - A(44);
C(51) = A(54)*q34 + A(51)*q(4) - A(53)*q(3) + X(5)*q(3) - A(50);
C(57) = A(60)*q34 + A(57)*q(4) - A(59)*q(3) + X(5)*q(4) - A(56) + X(6);
C(63) = A(66)*q34 + A(63)*q(4) - A(65)*q(3) - X(4)*q(4) - A(62);
C(69) = A(72)*q34 + A(69)*q(4) - A(71)*q(3) - A(68) - X(4);
C(75) = A(78)*q34 + X(5)*q34 + A(75)*q(4) - A(77)*q(3) + q(3)*X(6) - A(74);
C(81) = A(84)*q34 - X(4)*q34 + A(81)*q(4) - A(83)*q(3) - A(80);
C(87) = A(90)*q34 + A(87)*q(4) - A(89)*q(3) - X(4)*q(3) - A(86);
C(93) = q(4)*A(96)*q(3) + q(4)*A(93) - A(95)*q(3) + q(4)*X(6) - A(92) - X(5);
C(4) = -A(6)*q33 + X(6)*q33 - A(3)*q(3) + A(4)*q(3) + A(1);
C(10) = -A(12)*q33 - A(9)*q(3) + A(10)*q(3) + A(7);
C(16) = -A(18)*q33 - X(4)*q33 - A(15)*q(3) + A(16)*q(3) + A(13);
C(22) = -A(24)*q33 - A(21)*q(3) + A(22)*q(3) + X(5)*q(3) + A(19);
C(28) = -A(30)*q33 + X(6)*q33 - A(27)*q(3) + A(28)*q(3) - X(4)*q(3) + A(25);
C(34) = -A(36)*q33 - X(5)*q33 - A(33)*q(3) + A(34)*q(3) + A(31);
C(40) = -A(42)*q33 - A(39)*q(3) + A(40)*q(3) + q(3)*X(6) + A(37);
C(46) = -A(48)*q33 - A(45)*q(3) + A(46)*q(3) + A(43);
C(52) = -A(54)*q33 - A(51)*q(3) + A(52)*q(3) - X(4)*q(3) + A(49);
C(58) = -A(60)*q33 - A(57)*q(3) + A(58)*q(3) - X(5)*q(3) + A(55);
C(64) = -A(66)*q33 - A(63)*q(3) + A(64)*q(3) + X(4)*q(3) + A(61) + X(6);
C(70) = -A(72)*q33 - A(69)*q(3) + A(70)*q(3) + A(67) - X(5);
C(76) = -A(78)*q33 - X(5)*q33 - A(75)*q(3) + A(76)*q(3) + A(73);
C(82) = -A(84)*q33 + X(4)*q33 - A(81)*q(3) + A(82)*q(3) + q(3)*X(6) + A(79);
C(88) = -A(90)*q33 - A(87)*q(3) + A(88)*q(3) - X(5)*q(3) + A(85);
C(94) = -A(96)*q33 - q(3)*A(93) + A(94)*q(3) - q(3)*X(6) + A(91) + X(4);
C(5) = A(6)*q56 - X(9)*q56 + A(3)*q(6) - A(5)*q(5) + X(8)*q(5) - A(2);
C(11) = A(12)*q56 + A(9)*q(6) - A(11)*q(5) - X(7)*q(5) - A(8);
C(17) = A(18)*q56 + X(7)*q56 + A(15)*q(6) - A(17)*q(5) - A(14);
C(23) = A(24)*q56 + A(21)*q(6) - A(23)*q(5) - A(20);
C(29) = A(30)*q56 - X(9)*q56 + A(27)*q(6) - A(29)*q(5) - A(26);
C(35) = A(36)*q56 + X(8)*q56 + A(33)*q(6) - A(35)*q(5) - A(32);
C(41) = A(42)*q56 + A(39)*q(6) - A(41)*q(5) - A(38);
C(47) = A(48)*q56 + A(45)*q(6) - A(47)*q(5) - q(5)*X(9) - A(44);
C(53) = A(54)*q56 + A(51)*q(6) - A(53)*q(5) + X(8)*q(5) - A(50);
C(59) = A(60)*q56 + A(57)*q(6) - A(59)*q(5) + X(8)*q(6) - A(56) + X(9);
C(65) = A(66)*q56 + A(63)*q(6) - A(65)*q(5) - X(7)*q(6) - A(62);
C(71) = A(72)*q56 + A(69)*q(6) - A(71)*q(5) - A(68) - X(7);
C(77) = A(78)*q56 + X(8)*q56 + A(75)*q(6) - A(77)*q(5) + q(5)*X(9) - A(74);
C(83) = A(84)*q56 - X(7)*q56 + A(81)*q(6) - A(83)*q(5) - A(80);
C(89) = A(90)*q56 + A(87)*q(6) - A(89)*q(5) - X(7)*q(5) - A(86);
C(95) = q(6)*A(96)*q(5) + q(6)*A(93) - A(95)*q(5) + q(6)*X(9) - A(92) - X(8);
C(6) = -A(6)*q55 + X(9)*q55 - A(3)*q(5) + A(4)*q(5) + A(1);
C(12) = -A(12)*q55 - A(9)*q(5) + A(10)*q(5) + A(7);
C(18) = -A(18)*q55 - X(7)*q55 - A(15)*q(5) + A(16)*q(5) + A(13);
C(24) = -A(24)*q55 - A(21)*q(5) + A(22)*q(5) + X(8)*q(5) + A(19);
C(30) = -A(30)*q55 + X(9)*q55 - A(27)*q(5) + A(28)*q(5) - X(7)*q(5) + A(25);
C(36) = -A(36)*q55 - X(8)*q55 - A(33)*q(5) + A(34)*q(5) + A(31);
C(42) = -A(42)*q55 - A(39)*q(5) + A(40)*q(5) + q(5)*X(9) + A(37);
C(48) = -A(48)*q55 - A(45)*q(5) + A(46)*q(5) + A(43);
C(54) = -A(54)*q55 - A(51)*q(5) + A(52)*q(5) - X(7)*q(5) + A(49);
C(60) = -A(60)*q55 - A(57)*q(5) + A(58)*q(5) - X(8)*q(5) + A(55);
C(66) = -A(66)*q55 - A(63)*q(5) + A(64)*q(5) + X(7)*q(5) + A(61) + X(9);
C(72) = -A(72)*q55 - A(69)*q(5) + A(70)*q(5) + A(67) - X(8);
C(78) = -A(78)*q55 - X(8)*q55 - A(75)*q(5) + A(76)*q(5) + A(73);
C(84) = -A(84)*q55 + X(7)*q55 - A(81)*q(5) + A(82)*q(5) + q(5)*X(9) + A(79);
C(90) = -A(90)*q55 - A(87)*q(5) + A(88)*q(5) - X(8)*q(5) + A(85);
C(96) = -A(96)*q55 - q(5)*A(93) + A(94)*q(5) - q(5)*X(9) + A(91) + X(7);

% normalize coefficient matrix so that each row has unit length
C = C./(sqrt(sum(C.^2,2))*ones(1,size(C,2)));

end