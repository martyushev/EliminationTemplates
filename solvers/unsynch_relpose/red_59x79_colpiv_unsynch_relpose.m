% Input: coefficient matrix C of size 4x80

function [w,x,y,z] = red_59x79_colpiv_unsynch_relpose(C)

    i_dx = [1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59];
    j_dx = [1,2,5,11,40,41,44,50,51,54,60,66,2,3,6,12,41,42,45,51,52,55,61,67,3,4,7,13,42,43,46,52,53,56,62,68,5,6,8,14,44,45,47,54,55,57,63,69,6,7,9,15,45,46,48,55,56,58,64,70,8,9,10,16,47,48,49,57,58,59,65,71,20,21,24,30,40,41,44,50,51,54,60,66,21,22,25,31,41,42,45,51,52,55,61,67,22,23,26,32,42,43,46,52,53,56,62,68,24,25,27,33,44,45,47,54,55,57,63,69,25,26,28,34,45,46,48,55,56,58,64,70,27,28,29,35,47,48,49,57,58,59,65,71,11,12,14,17,60,61,63,66,67,69,72,75,12,13,15,18,61,62,64,67,68,70,73,76,14,15,16,19,63,64,65,69,70,71,74,77,30,31,33,36,60,61,63,66,67,69,72,75,31,32,34,37,61,62,64,67,68,70,73,76,33,34,35,38,63,64,65,69,70,71,74,77,17,18,19,72,73,74,75,76,77,78,79,36,37,38,39,72,73,74,75,76,77,78,79,1,2,5,11,40,41,44,50,51,54,60,66,2,3,6,12,41,42,45,51,52,55,61,67,3,4,7,13,42,43,46,52,53,56,62,68,5,6,8,14,44,45,47,54,55,57,63,69,6,7,9,15,45,46,48,55,56,58,64,70,8,9,10,16,47,48,49,57,58,59,65,71,20,21,24,30,40,41,44,50,51,54,60,66,21,22,25,31,41,42,45,51,52,55,61,67,22,23,26,32,42,43,46,52,53,56,62,68,24,25,27,33,44,45,47,54,55,57,63,69,25,26,28,34,45,46,48,55,56,58,64,70,27,28,29,35,47,48,49,57,58,59,65,71,11,12,14,17,60,61,63,66,67,69,72,75,12,13,15,18,61,62,64,67,68,70,73,76,14,15,16,19,63,64,65,69,70,71,74,77,30,31,33,36,60,61,63,66,67,69,72,75,31,32,34,37,61,62,64,67,68,70,73,76,33,34,35,38,63,64,65,69,70,71,74,77,17,18,19,72,73,74,75,76,77,78,79,36,37,38,39,72,73,74,75,76,77,78,79,1,2,5,11,40,41,44,50,51,54,60,66,2,3,6,12,41,42,45,51,52,55,61,67,3,4,7,13,42,43,46,52,53,56,62,68,5,6,8,14,44,45,47,54,55,57,63,69,6,7,9,15,45,46,48,55,56,58,64,70,8,9,10,16,47,48,49,57,58,59,65,71,20,21,24,30,40,41,44,50,51,54,60,66,21,22,25,31,41,42,45,51,52,55,61,67,22,23,26,32,42,43,46,52,53,56,62,68,24,25,27,33,44,45,47,54,55,57,63,69,25,26,28,34,45,46,48,55,56,58,64,70,27,28,29,35,47,48,49,57,58,59,65,71,11,12,14,17,60,61,63,66,67,69,72,75,12,13,15,18,61,62,64,67,68,70,73,76,14,15,16,19,63,64,65,69,70,71,74,77,30,31,33,36,60,61,63,66,67,69,72,75,31,32,34,37,61,62,64,67,68,70,73,76,33,34,35,38,63,64,65,69,70,71,74,77,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79];
    C_dx = [245,249,253,297,285,289,293,301,305,309,313,317,245,249,253,297,285,289,293,301,305,309,313,317,245,249,253,297,285,289,293,301,305,309,313,317,245,249,253,297,285,289,293,301,305,309,313,317,245,249,253,297,285,289,293,301,305,309,313,317,245,249,253,297,285,289,293,301,305,309,313,317,301,305,309,317,245,249,253,285,289,293,297,313,301,305,309,317,245,249,253,285,289,293,297,313,301,305,309,317,245,249,253,285,289,293,297,313,301,305,309,317,245,249,253,285,289,293,297,313,301,305,309,317,245,249,253,285,289,293,297,313,301,305,309,317,245,249,253,285,289,293,297,313,245,249,253,297,285,289,293,301,305,309,313,317,245,249,253,297,285,289,293,301,305,309,313,317,245,249,253,297,285,289,293,301,305,309,313,317,301,305,309,317,245,249,253,285,289,293,297,313,301,305,309,317,245,249,253,285,289,293,297,313,301,305,309,317,245,249,253,285,289,293,297,313,245,249,253,285,289,293,301,305,309,313,317,301,305,309,317,245,249,253,285,289,293,297,313,246,250,254,298,286,290,294,302,306,310,314,318,246,250,254,298,286,290,294,302,306,310,314,318,246,250,254,298,286,290,294,302,306,310,314,318,246,250,254,298,286,290,294,302,306,310,314,318,246,250,254,298,286,290,294,302,306,310,314,318,246,250,254,298,286,290,294,302,306,310,314,318,302,306,310,318,246,250,254,286,290,294,298,314,302,306,310,318,246,250,254,286,290,294,298,314,302,306,310,318,246,250,254,286,290,294,298,314,302,306,310,318,246,250,254,286,290,294,298,314,302,306,310,318,246,250,254,286,290,294,298,314,302,306,310,318,246,250,254,286,290,294,298,314,246,250,254,298,286,290,294,302,306,310,314,318,246,250,254,298,286,290,294,302,306,310,314,318,246,250,254,298,286,290,294,302,306,310,314,318,302,306,310,318,246,250,254,286,290,294,298,314,302,306,310,318,246,250,254,286,290,294,298,314,302,306,310,318,246,250,254,286,290,294,298,314,246,250,254,286,290,294,302,306,310,314,318,302,306,310,318,246,250,254,286,290,294,298,314,247,251,255,299,287,291,295,303,307,311,315,319,247,251,255,299,287,291,295,303,307,311,315,319,247,251,255,299,287,291,295,303,307,311,315,319,247,251,255,299,287,291,295,303,307,311,315,319,247,251,255,299,287,291,295,303,307,311,315,319,247,251,255,299,287,291,295,303,307,311,315,319,303,307,311,319,247,251,255,287,291,295,299,315,303,307,311,319,247,251,255,287,291,295,299,315,303,307,311,319,247,251,255,287,291,295,299,315,303,307,311,319,247,251,255,287,291,295,299,315,303,307,311,319,247,251,255,287,291,295,299,315,303,307,311,319,247,251,255,287,291,295,299,315,247,251,255,299,287,291,295,303,307,311,315,319,247,251,255,299,287,291,295,303,307,311,315,319,247,251,255,299,287,291,295,303,307,311,315,319,303,307,311,319,247,251,255,287,291,295,299,315,303,307,311,319,247,251,255,287,291,295,299,315,303,307,311,319,247,251,255,287,291,295,299,315,4,8,12,16,20,24,28,32,36,40,84,88,92,96,100,104,172,176,180,184,188,192,196,200,204,208,212,216,220,264,268,272,276,280,284,304,308,312,320,44,48,52,56,60,64,68,72,76,80,108,112,116,120,124,128,132,136,140,144,148,152,156,160,164,168,224,228,232,236,240,244,248,252,256,288,292,296,300,316];
    M = sparse(i_dx,j_dx,C(C_dx),59,79);

    [L,~,Pi] = lu(M(:,1:19));
    Pi = Pi';
    M = [Pi*L Pi(:,20:end)]\M(:,20:end);
    M = full(M(20:end,:));

    [L,UR,Pi] = lu(M(:,1:20));
    Pi = Pi';
    M = [Pi*L Pi(:,21:end)]\M(:,21:end);
    MP = M(1:20,:);
    NP = M(21:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-5));
    A = UR\[MP(:,1:end-5)*Pi MP(:,end-4:end)];
    B = U(:,1:20)\[U(:,21:end) Q'*NP(:,end-4:end)];
    M = [-A(:,end-19:end)+A(:,1:end-20)*B; -B];

    xP = [11,12,13,14,15,16,17,18,19,20,41,42,43,44,45,46,47,48,49,50,27,28,29,30,31,32,51,52,53,54,55,56,36,37,38,57,58,59,40,60];
    P1 = [(1:35)*Pi 36:40];
    T = getT(M,[41:60 P1(1:end-20)],P1(end-19:end),xP);

    [V,~] = eig(T);
    sol = V(16:19,:)./repmat(V(20,:),4,1);

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    w = sol(1,I);
    x = sol(2,I);
    y = sol(3,I);
    z = sol(4,I);
end