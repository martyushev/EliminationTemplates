% Input: coefficient matrix C of size 3x24
% Output: solution matrix S of size 3x62

function S = red_63x125_colpiv_3v_triang_laurent(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63];
    jx = [29,30,35,53,54,55,74,76,77,82,83,90,98,100,101,107,116,10,20,22,30,48,49,55,57,58,62,63,69,74,76,77,83,101,30,31,36,56,74,75,77,78,81,83,84,91,99,101,102,108,117,32,33,38,58,76,77,79,80,83,85,86,93,101,103,104,110,118,27,28,35,36,42,54,61,81,83,84,90,91,105,107,108,111,119,36,37,43,62,81,82,84,85,89,91,92,96,106,108,109,112,120,37,38,44,63,82,83,85,86,90,92,93,97,107,109,110,113,121,3,13,22,31,55,56,58,59,61,63,64,70,75,77,78,84,102,8,12,13,32,56,57,59,60,62,64,65,71,76,78,79,85,103,2,8,18,24,33,57,58,60,63,65,66,72,77,79,80,86,104,3,10,11,36,49,50,51,61,63,64,69,70,81,83,84,91,108,3,12,23,37,52,61,62,64,65,68,70,71,82,84,85,92,109,2,6,7,26,39,63,64,66,67,70,72,73,84,86,87,94,122,4,13,19,30,31,33,34,36,38,39,45,56,58,59,64,78,1,2,3,4,6,7,9,13,15,17,18,22,31,33,34,39,59,1,3,5,6,7,12,14,16,23,37,39,40,46,65,40,41,47,66,84,85,87,88,92,93,95,97,109,110,113,121,123,6,17,18,24,34,57,58,60,63,64,66,70,77,78,80,84,102,5,6,16,40,52,63,64,66,67,70,71,73,84,85,87,92,109,27,30,31,36,53,54,56,74,76,77,81,83,98,99,101,105,114,31,32,37,57,74,75,77,78,81,82,84,89,99,100,102,106,115,32,33,38,58,75,76,78,79,82,83,85,90,100,101,103,107,116,33,34,39,59,76,77,79,80,83,84,86,91,101,102,104,108,117,28,38,39,45,64,82,83,85,86,90,91,93,107,108,110,111,119,39,40,46,65,83,84,86,87,91,92,94,96,108,109,112,120,122,3,13,22,31,48,49,50,55,57,58,61,63,74,75,77,81,99,8,12,13,32,55,56,58,59,61,62,64,68,75,76,78,82,100,2,8,18,33,56,57,59,60,62,63,65,69,76,77,79,83,101,3,12,23,25,37,49,50,61,63,64,68,70,81,82,84,89,106,2,6,7,39,51,62,63,65,66,69,70,72,83,84,86,91,108,4,13,19,29,30,32,33,35,36,38,42,55,56,58,61,75,1,2,3,4,8,9,10,11,15,18,20,22,30,31,33,36,56,1,2,3,6,7,10,11,14,21,23,36,37,39,43,62,29,30,35,53,54,55,74,75,76,82,98,100,40,41,47,66,85,86,87,88,93,95,110,123,10,20,22,30,48,49,55,56,57,62,74,76,6,17,18,24,34,58,59,60,64,66,78,80,5,6,16,40,64,65,66,67,71,73,85,87,11,21,23,25,43,50,51,68,69,70,89,91,7,16,26,46,52,70,71,72,73,92,94,55,56,61,75,98,99,100,101,105,107,114,116,56,57,62,76,99,100,101,102,106,108,115,117,58,59,64,78,101,102,103,104,108,110,117,118,63,64,70,84,107,108,109,110,111,113,119,121,65,66,72,86,109,110,113,121,122,123,124,125,30,31,36,56,74,75,76,77,81,83,99,101,31,32,37,57,75,76,77,78,82,84,100,102,32,33,38,58,76,77,78,79,83,85,101,103,33,34,39,59,77,78,79,80,84,86,102,104,27,35,36,42,54,61,81,82,83,90,105,107,36,37,43,62,81,82,83,84,89,91,106,108,37,38,44,63,82,83,84,85,90,92,107,109,38,39,45,64,83,84,85,86,91,93,108,110,39,40,46,65,84,85,86,87,92,94,109,122,3,13,22,31,55,56,57,58,61,63,75,77,8,12,13,32,56,57,58,59,62,64,76,78,2,8,18,33,57,58,59,60,63,65,77,79,3,10,11,36,49,50,61,62,63,69,81,83,3,12,23,37,61,62,63,64,68,70,82,84,2,6,7,39,63,64,65,66,70,72,84,86,4,13,19,30,31,32,33,36,38,56,58,1,2,3,4,8,9,13,15,18,22,31,33,1,2,3,6,7,12,14,23,37,39];
    kx = [1,4,7,16,34,10,19,25,28,37,40,46,52,55,58,64,70,7,1,4,10,16,34,19,25,28,37,40,46,52,55,58,64,70,1,4,7,10,16,19,25,28,34,37,40,46,52,55,58,64,70,1,4,7,10,16,19,25,28,34,37,40,46,52,55,58,64,70,34,46,1,4,7,16,10,19,25,28,37,40,52,55,58,64,70,1,4,7,10,16,19,25,28,34,37,40,46,52,55,58,64,70,1,4,7,10,16,19,25,28,34,37,40,46,52,55,58,64,70,7,4,1,10,16,19,25,28,34,37,40,46,52,55,58,64,70,4,7,1,10,16,19,25,28,34,37,40,46,52,55,58,64,70,7,1,4,28,10,16,19,25,34,37,40,46,52,55,58,64,70,4,1,7,10,16,34,46,19,25,28,37,40,52,55,58,64,70,1,4,7,10,46,16,19,25,28,34,37,40,52,55,58,64,70,1,4,7,46,10,16,19,25,28,34,37,40,52,55,58,64,70,4,10,1,16,19,25,28,34,37,40,46,52,55,58,64,70,7,37,34,10,40,46,1,19,4,28,25,16,52,55,58,64,70,1,16,28,25,37,19,4,40,34,52,55,58,64,70,2,5,8,11,14,17,23,26,32,35,38,44,50,53,62,68,56,8,5,2,26,11,14,17,23,32,35,38,44,50,53,56,62,68,5,2,8,11,44,14,17,23,26,32,35,38,50,53,56,62,68,44,2,5,8,14,32,11,17,23,26,35,38,50,53,56,62,68,2,5,8,11,14,17,23,26,32,35,38,44,50,53,56,62,68,2,5,8,11,14,17,23,26,32,35,38,44,50,53,56,62,68,2,5,8,11,14,17,23,26,32,35,38,44,50,53,56,62,68,44,2,5,8,11,14,17,23,26,32,35,38,50,53,56,62,68,2,5,8,11,14,17,23,26,32,35,38,44,50,53,62,68,56,8,5,2,11,14,32,44,17,23,26,35,38,50,53,56,62,68,5,8,2,11,14,17,23,26,32,35,38,44,50,53,56,62,68,8,2,5,11,14,17,23,26,32,35,38,44,50,53,56,62,68,2,5,8,44,11,14,32,17,23,26,35,38,50,53,56,62,68,2,5,8,11,44,14,17,23,26,32,35,38,50,53,56,62,68,5,11,2,14,17,23,26,32,35,38,44,50,53,56,62,68,8,38,35,11,23,2,32,44,5,26,14,17,50,53,56,62,68,2,23,17,26,38,14,32,5,44,35,50,53,56,62,68,3,6,9,18,36,12,21,24,27,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,9,3,6,12,18,36,21,24,27,39,54,57,9,6,3,27,12,18,21,24,36,39,54,57,6,3,9,12,18,21,24,27,36,39,54,57,3,9,6,36,12,18,39,21,24,27,54,57,3,6,39,12,36,18,21,24,27,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,36,54,24,27,39,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,36,3,6,9,18,12,21,24,27,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,9,6,3,12,18,21,24,27,36,39,54,57,6,9,3,12,18,21,24,27,36,39,54,57,9,3,6,12,18,21,24,27,36,39,54,57,6,3,9,12,18,36,21,24,27,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,6,12,3,18,21,24,27,36,39,54,57,9,39,36,12,24,3,21,6,27,18,54,57,3,24,18,27,39,21,6,36,54,57];
    M = sparse(ix,jx,C(kx),63,125);

    [L,~,P] = lu(M(:,1:28));
    P = P';
    M = [P*L P(:,29:end)]\M(:,29:end);
    M = full(M(29:end,:));

    [L,U,P] = lu(M(:,1:26));
    P = P';
    M = [P*L P(:,27:end)]\M(:,27:end);
    M1 = M(1:26,:);
    M2 = M(27:end,:);

    [Q,R,P] = qr(M2(:,1:end-4));
    A = U\[M1(:,1:end-4)*P M1(:,end-3:end)];
    B = R(:,1:9)\[R(:,10:end) Q'*M2(:,end-3:end)];
    M = [-A(:,end-61:end)+A(:,1:end-62)*B; -B];

    P1 = [72:97 (1:67)*P 68:71];
    P2 = [72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,1,2,3,4,5,6,92,7,8,9,10,11,12,13,93,14,15,16,17,18,19,94,95,96,20,21,22,23,24,25,97,27,28,29,30,31,36,37,38,44,45,46,47,49,53,54,55,32,33,40,68];
    T = getT(M,P1(1:end-62),P1(end-61:end),P2);

    [V,~] = eig(T);
    S = V(59:61,:)./repmat(V(62,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end