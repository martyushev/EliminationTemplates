function C = sat_relpose_7p_fuv_angle(B)

    B1 = B(:,1:4)\B(:,5:22);
    B1 = [eye(4,7) B1(:,1:6) zeros(4,2) B1(:,7:8) zeros(4,1) B1(:,9) zeros(4,1) B1(:,10:11) zeros(4,2) B1(:,12:18)];

    % B1(4,:)*a
    B1(5,:) = [1 B1(4,11) B1(4,12) B1(4,21) B1(4,13) 0 B1(4,17) B1(4,10) 0 B1(4,19) B1(4,22) 0 B1(4,25) 0 B1(4,27) B1(4,26) 0 0 B1(4,28) 0 B1(4,29) 0 0 0 B1(4,30) 0 0 B1(4,31) 0 0 0];
    % B1(4,:)*b
    B1(6,:) = [B1(4,10) 1 B1(4,11) B1(4,19) 0 B1(4,13) 0 0 B1(4,12) 0 B1(4,21) B1(4,22) 0 0 0 B1(4,25) B1(4,26) B1(4,17) 0 0 B1(4,28) B1(4,29) B1(4,27) 0 0 B1(4,30) 0 0 B1(4,31) 0 0];
    % B1(4,:)*p
    B1(7,:) = [0 0 0 0 B1(4,10) 1 B1(4,11) 0 0 0 0 0 B1(4,19) B1(4,13) B1(4,25) B1(4,21) B1(4,22) B1(4,12) 0 B1(4,17) 0 0 B1(4,26) B1(4,27) B1(4,28) B1(4,29) B1(4,30) 0 0 B1(4,31) 0];

    C = B1(:,1:7)\B1(:,8:31);

    C = [C(1,1) 1 0 0 C(1,2) C(1,3) 0 C(1,4) C(1,5) C(1,6) 1 C(1,10) C(1,12) C(1,14) C(1,15) C(1,18) C(1,19) C(1,20) C(1,21) C(1,22) C(1,23) C(1,24);
          C(2,1) 0 1 0 C(2,2) C(2,3) 0 C(2,4) C(2,5) C(2,6) 0 C(2,10) C(2,12) C(2,14) C(2,15) C(2,18) C(2,19) C(2,20) C(2,21) C(2,22) C(2,23) C(2,24);
          C(3,1) 0 0 1 C(3,2) C(3,3) 0 C(3,4) C(3,5) C(3,6) 1 C(3,10) C(3,12) C(3,14) C(3,15) C(3,18) C(3,19) C(3,20) C(3,21) C(3,22) C(3,23) C(3,24);
          0 0 0 0 0 C(4,3) 1 C(4,4) C(4,5) C(4,6) 0 C(4,10) C(4,12) C(4,14) C(4,15) C(4,18) C(4,19) C(4,20) C(4,21) C(4,22) C(4,23) C(4,24);
          0 0 0 0 0 1 0 0 C(5,11) C(5,13) 0 C(5,7) C(5,6) C(5,9) C(5,10) C(5,8) C(5,16) C(5,17) C(5,18) C(5,19) C(5,20) C(5,23);
          0 0 0 0 0 0 1 0 1 0 0 0 C(6,6) C(6,9) C(6,10) 0 1 0 C(6,18) C(6,19) C(6,20) C(6,23);
          0 0 0 0 0 0 0 1 C(7,11) C(7,13) 0 C(7,7) C(7,6) C(7,9) C(7,10) C(7,8) C(7,16) C(7,17) C(7,18) C(7,19) C(7,20) C(7,23)];

    C = C./repmat(sqrt(sum(C.^2,2)),1,size(C,2));

end