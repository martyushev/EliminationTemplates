function C = coefs_relpose_7p_fuv_angle(data)

    F = data{1};
    t = data{2};
    F = reshape(F,9,1);
    F = F./norm(F,'fro');

    f24 = F(2) + F(4);
    f15 = F(1) + F(5);
    f37 = F(3) + F(7);
    f68 = F(6) + F(8);

    F11 = F(1)^2;
    F22 = F(2)^2;
    F33 = F(3)^2;
    F44 = F(4)^2;
    F55 = F(5)^2;
    F66 = F(6)^2;
    F77 = F(7)^2;
    F88 = F(8)^2;
    F99 = F(9)^2;

    F24 = F(2)*F(4);
    F15 = F(1)*F(5);
    F37 = F(3)*F(7);
    F19 = F(1)*F(9);
    F68 = F(6)*F(8);
    F27 = F(2)*F(7);
    F34 = F(3)*F(4);
    F38 = F(3)*F(8);
    F26 = F(2)*F(6);
    F48 = F(4)*F(8);
    F23 = F(2)*F(3);
    F28 = F(2)*F(8);
    F46 = F(4)*F(6);
    F47 = F(4)*F(7);
    F59 = F(5)*F(9);
    F67 = F(6)*F(7);

    B = zeros(4,22);
    
    B(1,1) = -F11*f24;
    B(1,2) = -F(1)*(0.5*f24^2 + F24);
    B(1,3) = -F24*f24;
    B(1,4) = -F(1)*(f24*f37 + F27 + F34);
    B(1,5) = -0.5*F(1)*F11;
    B(1,6) = F(5)*(0.5*F15 - F24);
    B(1,7) = -F11*f37;
    B(1,8) = -F(7)*F22 - F(3)*F44 - 2*F24*f37;
    B(1,9) = (F15 - F24)*f68 - F(5)*(F27 + F34);
    B(1,10) = -F(1)*(F11 + 0.5*(F22 + F44));
    B(1,11) = -f24*(F11 + F24);
    B(1,12) = F(5)*(F15 - 2*F24) - 0.5*F(1)*(F22 + F44);
    B(1,13) = -F(1)*(0.5*f37^2 + F37);
    B(1,14) = -2*F37*f24 - F(2)*F77-F(4)*F33;
    B(1,15) = F(9)*(F15 - F24) - F(5)*F37 + (0.5*F(1)*f68 - F34 - F27)*f68;
    B(1,16) = -F11*f37 - F(7)*F22 - F(3)*F44;
    B(1,17) = -F(1)*(F23 + F47) - F(5)*(F27 + F34) + (F15 - F24)*f68;
    B(1,18) = 0.5*F(1)*(F55 - F22 - F44 - F11) - F(5)*F24;
    B(1,19) = -F37*f37;
    B(1,20) = (F19 - F37)*f68 - F(9)*(F27 + F34);
    B(1,21) = 0.5*F(1)*(F66 + F88 - F33 - F77) - F(6)*F34 - F(8)*F27;
    B(1,22) = F(9)*(0.5*F19 - F37);

    B(2,1) = -F24*f24;
    B(2,2) = -F(5)*(0.5*f24^2 + F24);
    B(2,3) = -F55*f24;
    B(2,4) = -F(6)*F22 - F(8)*F44 - 2*F24*f68;
    B(2,5) = F(1)*(0.5*F15 - F24);
    B(2,6) = -0.5*F(5)*F55;
    B(2,7) = -F(1)*(F26 + F48) + (F15 - F24)*f37;
    B(2,8) = -F(5)*(2*(F26 + F48) + F28 + F46);
    B(2,9) = -F55*f68;
    B(2,10) = -F(5)*(0.5*(F22 + F44) - F11) - 2*F(1)*F24;
    B(2,11) = -f24*(F24 + F55);
    B(2,12) = -F(5)*(F55 + 0.5*(F22 + F44));
    B(2,13) = -(F26 + F48)*f37 - F(1)*F68 - F(9)*F24 + F(5)*(F19 + F37 + 0.5*(F33 + F77));
    B(2,14) = -F(2)*F66 - F(4)*F88 - 2*F68*f24;
    B(2,15) = -F(5)*(0.5*f68^2 + F68);
    B(2,16) = (F15 - F24)*f37 - F(1)*(F26 + F48) - F(5)*(F28 + F46);
    B(2,17) = -F(6)*F22 - F(8)*F44 - F55*f68;
    B(2,18) = -0.5*F(5)*(F22 + F44 + F55 - F11) - F(1)*F24;
    B(2,19) = -F(9)*(F26 + F48) + (F59 - F68)*f37;
    B(2,20) = -F68*f68;
    B(2,21) = -F(3)*F26 - F(7)*F48 - 0.5*F(5)*(F88 + F66 - F33 - F77);
    B(2,22) = F(9)*(0.5*F59 - F68);

    B(3,1) = (F19 - F37)*f24 - F(1)*(F38 + F67);
    B(3,2) = -(F38 + F67)*f24 - F(1)*F68 - F(5)*F37 + F(9)*(F15 + F24 + 0.5*(F22 + F44));
    B(3,3) = (F59 - F68)*f24 - F(5)*(F38 + F67);
    B(3,4) = -F(8)*F33 - 2*F37*f68 - F(6)*F77;
    B(3,5) = F(1)*(0.5*F19 - F37);
    B(3,6) = F(5)*(0.5*F59 - F68);
    B(3,7) = -F37*f37;
    B(3,8) = -2*f37*F68 - F(3)*F88 - F(7)*F66;
    B(3,9) = -F68*f68;
    B(3,10) = -2*F(1)*F37 - F(7)*F46 - F(3)*F28 + F(9)*(0.5*(F22 + F44) + F11);
    B(3,11) = (F19 + F59 - F37 - F68)*f24 - (F38 + F67)*f15;
    B(3,12) = -F(7)*F46 - F(3)*F28 + F(9)*(0.5*(F22 + F44) + F55) - 2*F(5)*F68;
    B(3,13) = -F(9)*(0.5*f37^2 + F37);
    B(3,14) = -F(9)*(F38 + F67 + f37*f68);
    B(3,15) = -F(9)*(0.5*f68^2 + F68);
    B(3,16) = -F(7)*(F33 + F66) - F(3)*(F77 + F88);
    B(3,17) = -F(8)*(F33 + F66) - F(6)*(F77 + F88);
    B(3,18) = -F(1)*F37 - F(5)*F68 - F(6)*F47 - F(3)*F28 + 0.5*F(9)*(F11 + F22 + F44 + F55);
    B(3,19) = -F99*f37;
    B(3,20) = -F99*f68;
    B(3,21) = -0.5*F(9)*(F33 + F66 + F77 + F88);
    B(3,22) = -0.5*F(9)*F99;

    b(1) =  F48*F(1) - (F24 + F15 + F22)*F(7);
    b(2) =  0.5*(F44 - F22)*F(8) - (F47 + 2*F27)*F(5);
    b(3) = -F(5)*(F28 + F(5)*F(7));
    b(4) =  F34*F(8) - F22*F(9) - F27*F(6) - 2*F27*F(8) - F(3)*F(5)*F(7) - F15*F(9) + F68*F(1) - F24*F(9) - F(5)*F77;
    b(5) = -0.5*F(1)*(2*F27 - F(8)*F(1));
    b(6) = -0.5*F(8)*F55;
    b(7) = -F(2)*F(9)*F(1) + F(3)*F(8)*F(1) - F(2)*F(3)*F(7) - F(2)*F77;
    b(8) = -2*F(5)*F(7)*F(8) - F(2)*F88 - F(5)*F67 - 2*F(2)*F59 - F(4)*F59 + F(4)*F68;
    b(9) = -F(5)*(F59 + F88);
    b(10) = -2*F27*F(1) - F47*F(5) - 0.5*F22*F(8) + 0.5*F44*F(8) + F11*F(8);
    b(11) = -(F55 + F24 + F15 + F22)*F(7) - F28*F(5) + F48*F(1);
    b(12) = -F(4)*F(5)*F(7) - 0.5*F22*F(8) + 0.5*F44*F(8) - F55*F(8);
    b(13) = -F(2)*F(3)*F(9) + 0.5*F33*F(8) - 2*F(2)*F(7)*F(9) - 0.5*F77*F(8);
    b(14) = -F(7)*F88 - F(3)*F59 - 2*F(7)*F59 - F26*F(9) + F(3)*F68 - 2*F28*F(9);
    b(15) =  0.5*(F66 - F88)*F(8) - (2*F(8) + F(6))*F59;
    b(16) = -F(2)*F88 - F(5)*F67 - F(4)*F59 - F(2)*F19 + F38*F(1) + F(4)*F68 - F(2)*F37 - F(2)*F77;
    b(17) = -F22*F(9) - F(5)*F77 - F(5)*F88 - F55*F(9);
    b(18) = -F(2)*F(7)*F(1) - F(4)*F(5)*F(7) - 0.5*F22*F(8) + 0.5*F44*F(8) + 0.5*F(8)*F11 - 0.5*F55*F(8);
    b(19) = -F(9)*(F(2)*F(9) + F(7)*F(8));
    b(20) = -F(9)*(F59 + F88);
    b(21) = -(F23 + F(5)*F(6))*F(9) + 0.5*(F33 + F66 - F88 - F77)*F(8);
    b(22) = -0.5*F(8)*F99;

    B(3,:) = B(3,:) + b;

    t2 = t^2 + 1;

    B(4,1) = t2*F(1)*f24;
    B(4,2) = t2*(F15 + 0.5*f24^2);
    B(4,3) = t2*F(5)*f24;
    B(4,4) = t2*(F(1)*f68 + f24*f37);
    B(4,5) = 0.5*t2*F11;
    B(4,6) = 0.5*t2*F55;
    B(4,7) = t2*F(1)*f37;
    B(4,8) = t2*(f24*f68 + F(5)*f37);
    B(4,9) = t2*F(5)*f68;
    B(4,10) = 2*t*(F24 - F15) + 0.5*(t2 - 2)*(F22 + F44) + 2*F24 + t2*F11;
    B(4,11) = t2*f24*f15;
    B(4,12) = 2*t*(F24 - F15) + 0.5*(t2 - 2)*(F22 + F44) + 2*F24 + t2*F55;
    B(4,13) = t2*(F19 + 0.5*f37^2);
    B(4,14) = t2*(F(9)*f24 + f37*f68);
    B(4,15) = t2*(F59 + 0.5*f68^2);
    B(4,16) = (t2*F(1) - 2*t*F(5))*f37 + (t2 - 2)*(F28 + F46) + 2*(t + 1)*(F26 + F48);
    B(4,17) = (t2*F(5) - 2*t*F(1))*f68 + (t2 - 2)*(F23 + F47) + 2*(t + 1)*(F27 + F34);
    B(4,18) = 2*t*(F24 - F15) + 0.5*(t2 - 2)*(F22 + F44) + 0.5*t2*(F55 + F11) + 2*F24;
    B(4,19) = t2*F(9)*f37;
    B(4,20) = t2*F(9)*f68;
    B(4,21) = -2*t*(F59 + F19) + 2*(t + 1)*(F37 + F68) + 0.5*(t2 - 2)*(F33 + F66 + F77 + F88);
    B(4,22) = 0.5*t2*F99;

    B1 = B(:,1:4)\B(:,5:22);
    B1 = [eye(4,7) B1(:,1:6) zeros(4,2) B1(:,7:8) zeros(4,1) B1(:,9) zeros(4,1) B1(:,10:11) zeros(4,2) B1(:,12:18)];

    % B1(4,:)*a
    B1(5,:) = [1 B1(4,11) B1(4,12) B1(4,21) B1(4,13) 0 B1(4,17) B1(4,10) 0 B1(4,19) B1(4,22) 0 B1(4,25) 0 B1(4,27) B1(4,26) 0 0 B1(4,28) 0 B1(4,29) 0 0 0 B1(4,30) 0 0 B1(4,31) 0 0 0];
    % B1(4,:)*b
    B1(6,:) = [B1(4,10) 1 B1(4,11) B1(4,19) 0 B1(4,13) 0 0 B1(4,12) 0 B1(4,21) B1(4,22) 0 0 0 B1(4,25) B1(4,26) B1(4,17) 0 0 B1(4,28) B1(4,29) B1(4,27) 0 0 B1(4,30) 0 0 B1(4,31) 0 0];
    % B1(4,:)*p
    B1(7,:) = [0 0 0 0 B1(4,10) 1 B1(4,11) 0 0 0 0 0 B1(4,19) B1(4,13) B1(4,25) B1(4,21) B1(4,22) B1(4,12) 0 B1(4,17) 0 0 B1(4,26) B1(4,27) B1(4,28) B1(4,29) B1(4,30) 0 0 B1(4,31) 0];

    C = B1(:,1:7)\B1(:,8:31);

    C = [C(1,1) 1 0 0 C(1,2) C(1,3) 0 C(1,4) C(1,5) C(1,6) 1 C(1,10) C(1,12) C(1,14) C(1,15) C(1,18) C(1,19) C(1,20) C(1,21) C(1,22) C(1,23) C(1,24);
          C(2,1) 0 1 0 C(2,2) C(2,3) 0 C(2,4) C(2,5) C(2,6) 0 C(2,10) C(2,12) C(2,14) C(2,15) C(2,18) C(2,19) C(2,20) C(2,21) C(2,22) C(2,23) C(2,24);
          C(3,1) 0 0 1 C(3,2) C(3,3) 0 C(3,4) C(3,5) C(3,6) 1 C(3,10) C(3,12) C(3,14) C(3,15) C(3,18) C(3,19) C(3,20) C(3,21) C(3,22) C(3,23) C(3,24);
          0 0 0 0 0 C(4,3) 1 C(4,4) C(4,5) C(4,6) 0 C(4,10) C(4,12) C(4,14) C(4,15) C(4,18) C(4,19) C(4,20) C(4,21) C(4,22) C(4,23) C(4,24);
          0 0 0 0 0 1 0 0 C(5,11) C(5,13) 0 C(5,7) C(5,6) C(5,9) C(5,10) C(5,8) C(5,16) C(5,17) C(5,18) C(5,19) C(5,20) C(5,23);
          0 0 0 0 0 0 1 0 1 0 0 0 C(6,6) C(6,9) C(6,10) 0 1 0 C(6,18) C(6,19) C(6,20) C(6,23);
          0 0 0 0 0 0 0 1 C(7,11) C(7,13) 0 C(7,7) C(7,6) C(7,9) C(7,10) C(7,8) C(7,16) C(7,17) C(7,18) C(7,19) C(7,20) C(7,23)];

    C = C./repmat(sqrt(sum(C.^2,2)),1,size(C,2));

end