% Input: coefficient matrix C of size 10x40

function S = nstd_14x40_colpiv_relpose_6p_rad_1s(C)

    i_dx = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14];
    j_dx = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,26,27,28,29,30,34,35,36,39,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,26,27,28,29,30,34,35,36,39,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,26,27,28,29,30,34,35,36,39,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,26,27,28,29,30,34,35,36,39,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40];
    C_dx = [1,11,21,31,81,91,101,181,191,291,41,51,61,71,111,121,131,141,151,161,171,201,211,221,231,241,251,261,271,281,301,311,321,331,341,351,361,371,381,391,2,12,22,32,82,92,102,182,192,292,42,52,62,72,112,122,132,142,152,162,172,202,212,222,232,242,252,262,272,282,302,312,322,332,342,352,362,372,382,392,43,53,63,73,153,163,173,273,283,353,113,123,133,143,203,213,223,233,243,253,263,303,313,323,333,343,363,373,383,393,43,53,63,73,113,123,133,143,153,163,173,203,213,223,233,243,253,263,273,283,303,313,323,333,343,353,363,373,383,393,4,14,24,34,84,94,104,184,194,294,44,54,64,74,114,124,134,144,154,164,174,204,214,224,234,244,254,264,274,284,304,314,324,334,344,354,364,374,384,394,5,15,25,35,85,95,105,185,195,295,45,55,65,75,115,125,135,145,155,165,175,205,215,225,235,245,255,265,275,285,305,315,325,335,345,355,365,375,385,395,46,56,66,76,156,166,176,276,286,356,116,126,136,146,206,216,226,236,246,256,266,306,316,326,336,346,366,376,386,396,46,56,66,76,116,126,136,146,156,166,176,206,216,226,236,246,256,266,276,286,306,316,326,336,346,356,366,376,386,396,7,17,27,37,87,97,107,187,197,297,47,57,67,77,117,127,137,147,157,167,177,207,217,227,237,247,257,267,277,287,307,317,327,337,347,357,367,377,387,397,8,18,28,38,88,98,108,188,198,298,48,58,68,78,118,128,138,148,158,168,178,208,218,228,238,248,258,268,278,288,308,318,328,338,348,358,368,378,388,398,49,59,69,79,159,169,179,279,289,359,119,129,139,149,209,219,229,239,249,259,269,309,319,329,339,349,369,379,389,399,49,59,69,79,119,129,139,149,159,169,179,209,219,229,239,249,259,269,279,289,309,319,329,339,349,359,369,379,389,399,50,60,70,80,160,170,180,280,290,360,120,130,140,150,210,220,230,240,250,260,270,310,320,330,340,350,370,380,390,400,50,60,70,80,120,130,140,150,160,170,180,210,220,230,240,250,260,270,280,290,310,320,330,340,350,360,370,380,390,400];
    M = sparse(i_dx,j_dx,C(C_dx),14,40);
    M = full(M);

    [L,UR,Pi] = lu(M(:,1:10));
    Pi = Pi';
    M = [Pi*L Pi(:,11:end)]\M(:,11:end);
    MP = M(1:10,:);
    NP = M(11:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-4));
    A = UR\[MP(:,1:end-4)*Pi MP(:,end-3:end)];
    B = U(:,1:4)\[U(:,5:end) Q'*NP(:,end-3:end)];
    M = [-A(:,end-25:end)+A(:,1:end-26)*B; -B];

    xP = [31,32,33,34,1,2,3,4,35,36,37,5,6,7,8,9,10,11,38,39,16,17,18,19,20,40,24,25,26,29];
    P1 = [(1:26)*Pi 27:30];
    T = getT(M,[31:40 P1(1:end-26)],P1(end-25:end),xP);

    [V,~] = eig(T);
    S = V(23:25,:)./repmat(V(26,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end