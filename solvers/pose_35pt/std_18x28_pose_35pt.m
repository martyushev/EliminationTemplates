% Input: coefficient matrix C of size 4x25

function S = std_18x28_pose_35pt(C)

    i_dx = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18];
    j_dx = [1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,19,20,23,3,5,7,8,9,10,11,12,13,15,16,17,18,19,20,21,23,24,26,2,5,6,9,12,13,14,17,18,21,22,25,4,6,8,9,11,12,13,14,16,17,18,20,21,22,24,25,27,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,19,20,23,3,5,7,8,9,10,11,12,13,15,16,17,18,19,20,21,23,24,26,2,5,6,9,12,13,14,17,18,21,22,25,4,6,8,9,11,12,13,14,16,17,18,20,21,22,24,25,27,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,3,5,7,8,9,10,11,12,13,15,16,17,18,19,20,21,23,24,26,4,6,8,9,11,12,13,14,16,17,18,20,21,22,24,25,27,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,1,2,3,4,5,6,7,8,9,10,11,12,13,15,16,17,19,20,23,3,5,7,8,9,10,11,12,13,15,16,17,18,19,20,21,23,24,26,2,5,6,9,12,13,14,17,18,21,22,25,4,6,8,9,11,12,13,14,16,17,18,20,21,22,24,25,27,7,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28];
    C_dx = [1,5,17,21,25,29,41,45,49,61,65,69,73,77,81,85,89,93,97,1,5,17,21,25,41,45,49,53,61,65,69,73,77,81,85,89,93,97,1,17,21,41,61,65,85,77,81,89,93,97,1,5,17,21,41,45,49,73,61,65,69,77,81,85,89,93,97,1,5,17,21,25,29,57,41,45,49,53,61,65,69,73,77,81,85,89,93,97,2,6,18,22,26,30,42,46,50,62,66,70,74,78,82,86,90,94,98,2,6,18,22,26,42,46,50,54,62,66,70,74,78,82,86,90,94,98,2,18,22,42,62,66,86,78,82,90,94,98,2,6,18,22,42,46,50,74,62,66,70,78,82,86,90,94,98,2,6,18,22,26,30,58,42,46,50,54,62,66,70,74,78,82,86,90,94,98,3,7,19,23,27,43,47,51,55,63,67,71,75,79,83,87,91,95,99,3,7,19,23,43,47,51,75,63,67,71,79,83,87,91,95,99,3,7,19,23,27,31,59,43,47,51,55,63,67,71,75,79,83,87,91,95,99,4,8,20,24,28,32,44,48,52,64,68,72,76,80,84,88,92,96,100,4,8,20,24,28,44,48,52,56,64,68,72,76,80,84,88,92,96,100,4,20,24,44,64,68,88,80,84,92,96,100,4,8,20,24,44,48,52,76,64,68,72,80,84,88,92,96,100,4,8,20,24,28,32,60,44,48,52,56,64,68,72,76,80,84,88,92,96,100];
    M = sparse(i_dx,j_dx,C(C_dx),18,28);

    [L,~,Pi] = lu(M(:,1:14));
    Pi = Pi';
    M = [Pi*L Pi(:,15:end)]\M(:,15:end);
    M = M(end-3:end,:);

    T = zeros(10);
    T(1:4,:) = -M(:,1:4)\M(:,5:end);
    T([5,16,27,48,59,80]) = 1;

    [V,~] = eig(T);
    S = V(8:9,:)./repmat(V(10,:),2,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end