% Input: coefficient matrix C of size 4x24

function S = nstd_132x148_colpiv_wpnp(C)

    i_dx = [1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46,46,46,46,46,46,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,54,54,54,54,54,54,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,72,72,72,72,72,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,76,77,77,77,77,77,77,78,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,80,80,80,80,80,81,81,81,81,81,81,81,81,82,82,82,82,82,82,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,94,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,100,100,100,100,100,100,100,100,100,101,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,104,104,104,104,104,104,104,104,104,105,105,105,105,105,105,105,106,106,106,106,106,106,106,106,106,107,107,107,107,107,107,107,107,107,108,108,108,108,108,108,108,108,108,109,109,109,109,109,109,109,109,109,110,110,110,110,110,110,110,110,110,111,111,111,111,111,111,111,111,111,112,112,112,112,112,112,112,112,112,113,113,113,113,113,113,113,114,114,114,114,114,114,114,115,115,115,115,115,115,115,115,116,116,116,116,116,116,117,117,117,117,117,117,117,117,117,118,118,118,118,118,118,118,118,119,119,119,119,119,119,119,119,119,120,120,120,120,120,120,120,121,121,121,121,121,121,121,121,121,122,122,122,122,122,122,122,122,123,123,123,123,123,123,123,124,124,124,124,124,124,124,124,125,125,125,125,125,125,125,125,126,126,126,126,126,126,126,126,126,127,127,127,127,127,127,127,127,127,128,128,128,128,128,128,128,128,128,129,129,129,129,129,129,129,129,129,130,130,130,130,130,130,130,130,130,131,131,131,131,131,131,131,131,131,132,132,132,132,132,132,132,132,132];
    j_dx = [119,121,126,133,136,144,146,147,148,1,3,14,39,54,70,75,89,110,8,10,19,44,59,75,76,92,113,14,16,47,76,77,95,116,4,6,17,42,57,90,91,94,112,10,12,21,46,61,93,94,96,115,15,17,23,48,63,95,96,97,117,105,107,113,124,129,135,137,140,144,106,108,114,125,130,137,139,142,146,110,111,116,127,132,140,142,143,147,51,53,61,74,121,122,125,131,59,61,126,127,128,134,67,69,130,131,133,138,28,30,41,58,69,108,109,112,122,71,73,132,133,134,141,43,45,65,116,117,118,128,33,35,44,61,72,98,111,114,124,27,29,40,57,68,107,108,111,121,38,40,63,113,114,116,126,55,57,63,124,125,127,133,26,28,39,56,67,98,106,107,120,39,41,47,64,114,115,117,127,54,56,123,124,126,132,32,34,43,60,71,98,110,113,123,34,36,45,62,73,111,112,115,125,50,52,60,73,79,120,121,124,130,66,75,80,81,85,98,99,119,135,19,21,49,77,78,97,118,89,90,95,102,103,104,115,124,142,84,86,92,99,100,102,111,120,137,75,77,82,83,93,104,117,126,143,85,87,93,100,101,103,112,121,139,9,11,20,45,60,92,93,95,114,3,26,28,39,67,84,85,89,106,9,32,34,43,70,71,75,89,110,34,50,52,60,79,98,106,107,120,15,38,40,75,76,92,113,39,54,56,98,110,113,123,80,81,89,99,105,107,113,129,135,5,28,30,41,69,86,87,90,108,35,51,53,61,107,108,111,121,16,39,41,47,92,93,95,114,40,55,57,63,98,111,114,124,56,67,69,120,121,124,130,20,43,45,76,77,95,116,44,59,61,113,114,116,126,60,71,73,123,124,126,132,81,82,92,102,110,111,116,132,140,98,119,121,126,135,136,137,140,144,6,29,31,42,87,88,91,109,12,35,37,46,74,90,91,94,112,17,40,42,48,93,94,96,115,41,56,58,64,111,112,115,125,57,68,121,122,125,131,21,44,46,49,95,96,97,117,45,60,62,65,114,115,117,127,61,72,74,124,125,127,133,73,79,130,131,133,138,90,100,101,103,107,109,115,131,139,93,98,102,103,104,112,117,133,142,111,120,122,127,137,138,139,142,146,82,83,95,104,113,115,118,134,143,114,123,125,128,140,141,142,143,147,124,129,131,134,144,145,146,147,148,120,122,127,132,138,144,146,147,148,2,4,15,38,55,70,75,89,110,9,11,20,43,60,75,76,92,113,15,17,23,63,76,77,95,116,5,7,18,41,58,90,91,94,112,11,13,22,45,62,93,94,96,115,16,18,24,47,64,95,96,97,117,79,136,138,141,145,106,108,114,123,130,135,137,140,144,107,109,115,124,131,137,139,142,146,98,112,117,126,133,140,142,143,147,26,28,39,54,67,105,106,110,119,67,69,129,130,132,136,50,52,60,71,79,119,120,123,129,60,62,65,126,127,128,134,68,130,131,133,138,29,31,42,57,108,109,112,122,72,74,132,133,134,141,44,46,49,116,117,118,128,34,36,45,60,73,98,111,114,124,28,30,41,56,69,107,108,111,121,39,41,47,113,114,116,126,27,29,40,55,68,98,106,107,120,40,42,48,63,114,115,117,127,55,57,63,123,124,126,132,33,35,44,59,72,98,110,113,123,35,37,46,61,74,111,112,115,125,51,53,61,72,120,121,124,130,80,81,84,86,92,99,110,120,135,81,82,89,90,95,102,113,124,140,20,22,25,65,77,78,97,118,85,87,93,98,99,100,102,121,137,82,83,92,94,97,104,116,127,143,86,88,94,100,101,103,111,122,139,10,12,21,44,61,92,93,95,114,123,125,128,130,141,144,146,147,148,2,4,15,27,55,84,85,89,106,8,10,19,33,59,70,75,89,110,14,16,39,75,76,92,113,4,6,17,29,57,86,87,90,108,19,21,44,76,77,95,116,11,13,22,36,62,90,91,94,112,16,18,24,41,64,93,94,96,115,20,22,25,45,65,95,96,97,117,110,111,116,120,132,135,137,140,144,98,112,117,121,133,137,139,142,146,113,115,118,124,134,140,142,143,147,32,34,43,50,71,105,106,110,119,71,73,79,129,130,132,136,54,56,67,119,120,123,129,56,58,64,69,121,122,125,131,72,74,130,131,133,138,35,37,46,53,74,108,109,112,122,39,41,47,56,98,111,114,124,34,36,45,52,73,107,108,111,121,43,45,60,113,114,116,126,33,35,44,51,72,98,106,107,120,44,46,49,61,114,115,117,127,38,40,55,98,110,113,123,40,42,48,57,111,112,115,125,55,57,63,68,120,121,124,130,75,77,81,82,93,98,102,126,140,92,94,97,102,103,104,111,127,142,1,3,14,26,54,66,70,84,105,5,7,18,30,58,87,88,91,109,89,90,95,99,100,102,107,124,137,76,78,82,83,96,104,114,128,143,15,17,23,40,63,92,93,95,114];
    C_dx = [1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,89,85,93,1,9,29,57,65,77,89,85,93,1,9,57,77,89,85,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,77,85,89,93,1,9,77,85,89,93,1,9,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,77,85,89,93,1,9,57,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,57,77,85,89,93,1,9,29,77,85,89,93,1,9,29,57,65,89,77,85,93,1,9,29,57,77,85,89,93,1,9,77,85,89,93,1,9,29,57,65,85,77,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,29,77,89,9,57,85,65,93,1,9,57,77,89,85,93,1,9,29,77,85,89,57,65,93,1,9,29,77,85,89,57,65,93,1,29,77,89,9,85,57,65,93,1,9,29,77,85,89,57,65,93,1,9,29,57,65,77,85,89,93,22,42,50,62,82,78,86,90,94,22,42,50,62,78,82,90,86,94,22,42,50,62,82,90,78,86,94,22,42,50,78,90,86,94,22,42,50,86,78,90,94,78,90,22,86,42,50,62,82,94,22,42,50,62,82,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,78,86,90,94,22,42,50,78,90,86,94,22,42,50,78,86,90,94,22,42,50,78,86,90,94,78,90,22,86,42,50,62,82,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,82,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,78,86,90,94,22,42,78,86,90,94,22,78,86,90,42,50,62,82,94,22,42,78,86,90,50,62,82,94,22,42,50,62,78,82,86,90,94,78,90,22,86,42,50,62,82,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,91,87,95,7,15,35,55,71,79,91,87,95,7,15,35,71,79,91,87,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,79,87,91,95,7,79,87,91,95,7,15,35,55,79,87,91,95,7,15,79,87,91,95,7,15,35,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,79,87,91,95,7,15,35,55,71,91,79,87,95,7,15,35,55,79,87,91,95,7,15,35,79,87,91,95,7,15,35,55,71,87,79,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,79,87,91,95,79,91,7,15,35,87,55,71,95,79,91,7,15,35,87,55,71,95,7,15,35,71,79,91,87,95,7,15,35,55,79,87,91,71,95,79,91,7,15,35,87,55,71,95,7,15,35,79,87,91,55,71,95,7,15,35,55,71,79,87,91,95,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,92,88,96,20,28,48,80,92,88,96,20,28,40,48,76,80,88,92,96,20,28,48,80,92,88,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,48,80,88,92,96,20,28,48,80,88,92,96,20,28,40,48,80,88,92,96,20,28,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,48,80,88,92,96,20,28,40,48,76,92,80,88,96,20,28,40,48,80,88,92,96,20,28,48,88,80,92,96,20,28,40,48,80,88,92,96,20,28,40,48,80,88,92,96,20,40,80,92,28,48,88,76,96,20,28,40,80,88,92,48,76,96,20,28,40,48,76,80,92,88,96,20,28,40,48,76,80,88,92,96,20,28,40,80,88,92,48,76,96,20,40,80,92,28,88,48,76,96,20,28,40,48,76,80,88,92,96];
    M = sparse(i_dx,j_dx,C(C_dx),132,148);

    [L,~,Pi] = lu(M(:,1:83));
    Pi = Pi';
    M = [Pi*L Pi(:,84:end)]\M(:,84:end);
    M = full(M(84:end,:));

    [L,UR,Pi] = lu(M(:,1:21));
    Pi = Pi';
    M = [Pi*L Pi(:,22:end)]\M(:,22:end);
    MP = M(1:21,:);
    NP = M(22:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-5));
    A = UR\[MP(:,1:end-5)*Pi MP(:,end-4:end)];
    B = U(:,1:28)\[U(:,29:end) Q'*NP(:,end-4:end)];
    M = [-A(:,end-15:end)+A(:,1:end-16)*B; -B];

    xP = [45,46,47,48,49,50,51,52,53,54,55,56,57,58,2,3,4,5,59,7,8,10,11,13,16,17,18,20,21,23,60,26,61,27,62,63,29,64,65,33,34,35,38,42];
    P1 = [(1:39)*Pi 40:44];
    T = getT(M,[45:65 P1(1:end-16)],P1(end-15:end),xP);

    [V,~] = eig(T);
    S = V(12:15,:)./repmat(V(16,:),4,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end