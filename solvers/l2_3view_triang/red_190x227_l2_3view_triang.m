% Input: coefficient matrix C of size 8x25
% Output: solution matrix S of size 8x37

function S = red_190x227_l2_3view_triang(C)

    M = sparse([1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,14,14,14,14,14,15,15,15,15,15,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,19,19,19,19,19,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,28,28,28,28,28,29,29,29,29,29,30,30,30,30,30,31,31,31,31,31,32,32,32,32,32,33,33,33,33,33,34,34,34,34,34,35,35,35,35,35,36,36,36,36,36,37,37,37,37,37,38,38,38,38,38,39,39,39,39,39,40,40,40,40,40,41,41,41,41,41,42,42,42,42,42,43,43,43,43,43,44,44,44,44,44,45,45,45,45,45,46,46,46,46,46,47,47,47,47,47,48,48,48,48,48,49,49,49,49,49,50,50,50,50,50,51,51,51,51,51,52,52,52,52,52,53,53,53,53,53,53,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,58,58,58,58,58,58,59,59,59,59,59,59,60,60,60,60,60,60,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,73,73,73,73,73,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,76,76,76,76,76,76,77,77,77,77,77,77,78,78,78,78,78,78,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,91,91,91,91,91,92,92,92,92,92,93,93,93,93,93,94,94,94,94,94,95,95,95,95,95,96,96,96,96,96,97,97,97,97,97,98,98,98,98,98,99,99,99,99,99,100,100,100,100,100,101,101,101,101,101,102,102,102,102,102,103,103,103,103,103,104,104,104,104,104,105,105,105,105,105,106,106,106,106,106,107,107,107,107,107,108,108,108,108,108,109,109,109,109,109,110,110,110,110,110,111,111,111,111,111,112,112,112,112,112,113,113,113,113,113,114,114,114,114,114,115,115,115,115,115,116,116,116,116,116,117,117,117,117,117,118,118,118,118,118,119,119,119,119,119,120,120,120,120,120,121,121,121,121,121,122,122,122,122,122,123,123,123,123,123,124,124,124,124,124,125,125,125,125,125,126,126,126,126,126,127,127,127,127,127,128,128,128,128,128,129,129,129,129,129,130,130,130,130,130,131,131,131,131,131,132,132,132,132,132,133,133,133,133,133,134,134,134,134,134,135,135,135,135,135,136,136,136,136,136,137,137,137,137,137,138,138,138,138,138,139,139,139,139,139,140,140,140,140,140,141,141,141,141,141,142,142,142,142,142,143,143,143,143,143,144,144,144,144,144,145,145,145,145,145,146,146,146,146,146,147,147,147,147,147,148,148,148,148,148,149,149,149,149,149,150,150,150,150,150,151,151,151,151,151,152,152,152,152,152,153,153,153,153,153,154,154,154,154,154,154,154,155,155,155,155,155,155,155,155,155,156,156,156,156,156,156,156,156,157,157,157,157,157,157,157,157,157,158,158,158,158,158,158,158,158,159,159,159,159,159,160,160,160,160,160,160,160,160,160,161,161,161,161,161,161,161,161,161,162,162,162,162,162,162,162,162,162,163,163,163,163,163,163,163,163,163,164,164,164,164,164,164,164,164,164,165,165,165,165,165,165,165,165,165,166,166,166,166,166,166,166,166,166,167,167,167,167,167,167,167,167,167,168,168,168,168,168,168,168,168,168,169,169,169,169,169,169,169,169,169,170,170,170,170,170,170,170,170,170,171,171,171,171,171,171,171,171,171,172,172,172,172,172,172,172,172,172,173,173,173,173,173,173,174,174,174,174,174,174,174,174,174,175,175,175,175,175,175,175,175,176,176,176,176,176,176,176,176,176,177,177,177,177,177,177,177,177,177,178,178,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,179,180,180,180,180,180,180,180,180,180,181,181,181,181,181,181,182,182,182,182,182,182,182,182,182,183,183,183,183,183,183,183,183,183,184,184,184,184,184,184,184,184,184,185,185,185,185,185,185,185,185,185,186,186,186,186,186,186,186,186,186,187,187,187,187,187,187,187,187,187,188,188,188,188,188,188,188,188,188,189,189,189,189,189,189,189,189,189,190,190,190,190,190,190,190,190,190],[3,71,166,191,202,74,167,192,193,203,9,10,78,168,204,12,14,84,111,146,158,170,196,197,206,14,15,86,112,147,15,16,87,171,207,21,22,91,116,151,23,24,95,117,152,26,97,174,198,210,100,175,198,199,211,29,30,102,176,212,31,32,104,177,213,54,57,120,179,215,55,58,121,139,153,58,59,124,140,154,60,61,128,180,216,62,63,133,181,217,76,77,164,182,218,110,143,184,206,220,111,112,144,185,221,112,169,186,207,222,115,116,148,187,223,172,188,210,211,224,139,140,178,189,226,183,190,221,222,227,3,72,166,191,202,75,167,192,193,203,9,10,79,168,204,12,14,85,111,146,159,170,196,197,206,14,15,112,147,160,15,16,161,171,207,21,22,92,116,151,23,24,96,117,152,26,98,174,198,210,101,175,198,199,211,29,30,103,176,212,31,32,105,177,213,53,56,120,178,214,55,58,122,139,153,58,59,125,140,154,60,61,129,180,216,62,63,134,181,217,76,77,165,182,218,109,143,183,205,219,111,112,145,185,221,112,170,186,207,222,115,116,149,187,223,173,188,210,211,224,139,140,179,189,226,184,190,221,222,227,1,8,66,76,80,141,11,45,49,85,110,122,145,13,46,50,86,124,169,194,205,47,51,125,160,170,194,195,206,19,20,93,116,131,151,25,52,99,135,174,210,27,28,136,162,175,211,33,60,62,111,139,221,53,54,73,123,139,141,153,156,56,57,126,140,142,154,155,157,82,83,141,168,182,200,201,218,106,107,128,133,144,178,183,219,107,108,129,134,145,179,184,220,109,110,130,135,146,153,185,221,131,136,147,154,186,205,206,222,113,114,132,137,150,180,187,223,137,138,174,181,188,208,209,224,118,119,216,217,221,225,226,227,153,166,167,182,189,214,215,226,180,181,185,189,190,219,220,227,2,70,77,81,142,13,46,50,87,124,169,194,205,47,51,125,161,170,194,195,206,19,20,94,116,131,151,27,28,136,163,175,211,34,61,63,140,207,222,53,54,73,126,139,141,153,156,56,57,127,140,142,154,155,157,82,83,142,168,182,200,201,218,106,107,128,133,169,178,183,219,107,108,129,134,170,179,184,220,109,110,130,135,147,153,185,221,131,136,154,171,186,205,206,222,113,114,132,137,151,180,187,223,137,138,175,181,188,208,209,224,118,119,216,217,222,225,226,227,154,166,167,182,189,214,215,226,180,181,186,189,190,219,220,227,4,6,71,78,164,5,7,72,79,165,9,10,202,204,218,35,38,89,122,145,36,39,90,123,146,37,40,91,124,169,38,41,92,125,170,39,42,93,126,147,42,43,94,127,171,44,46,95,128,148,45,47,96,129,149,48,50,102,133,172,49,51,103,134,173,60,61,117,216,223,62,63,212,217,224,64,67,128,164,178,65,68,129,165,179,69,70,131,142,154,73,132,155,166,180,137,156,157,167,181,76,77,216,218,226,80,81,166,168,182,121,124,148,178,183,122,125,149,179,184,123,126,150,153,185,126,127,151,154,186,130,131,152,180,187,135,136,176,181,188,139,140,223,226,227,141,142,180,182,189,153,154,187,189,190,4,6,74,78,164,5,7,75,79,165,9,10,203,204,218,35,38,98,122,145,36,39,99,123,146,37,40,100,124,169,38,41,101,125,170,39,42,126,147,162,42,43,127,163,171,44,46,102,128,148,45,47,103,129,149,48,50,104,133,172,49,51,105,134,173,60,61,212,216,223,62,63,213,217,224,64,67,133,164,178,65,68,134,165,179,66,69,135,141,153,69,70,136,142,154,73,137,155,166,180,138,156,157,167,181,76,77,217,218,226,80,81,167,168,182,121,124,172,178,183,122,125,173,179,184,123,126,153,174,185,126,127,154,175,186,130,131,176,180,187,135,136,177,181,188,139,140,224,226,227,141,142,181,182,189,153,154,188,189,190,1,2,76,77,200,201,218,4,5,6,7,78,79,80,81,168,11,107,108,110,194,195,206,220,17,18,19,20,113,114,115,116,223,25,27,28,208,209,210,211,224,33,34,118,119,225,37,38,40,41,124,125,126,127,154,44,45,46,47,128,129,130,131,180,48,49,50,51,133,134,135,136,181,53,54,56,57,139,140,214,215,226,64,65,67,68,141,142,164,165,182,84,85,86,144,145,146,147,160,185,86,87,147,160,161,169,170,171,186,88,89,91,92,148,149,150,151,187,97,98,100,101,172,173,174,175,188,109,110,205,206,219,220,221,222,227,121,122,124,125,153,154,178,179,189,144,145,169,170,183,184,185,186,190,3,76,77,191,192,193,202,203,218,8,80,81,82,83,168,17,19,25,27,109,113,205,208,219,18,20,28,110,114,206,209,220,21,22,112,116,198,199,207,211,222,23,24,29,30,115,116,117,212,223,29,30,31,32,210,211,212,213,224,44,46,48,50,121,124,128,133,178,45,47,49,51,122,125,129,134,179,52,135,136,137,138,181,60,61,62,63,139,140,216,217,226,73,141,142,155,156,157,166,167,182,88,91,97,100,144,148,169,172,183,89,92,98,101,145,149,170,173,184,90,93,99,146,147,150,162,174,185,93,94,147,151,162,163,171,175,186,115,116,210,211,221,222,223,224,227,130,131,135,136,153,154,180,181,189,150,151,174,175,185,186,187,188,190],C([81,129,193,89,177,129,193,81,89,177,81,89,129,193,177,81,89,129,177,193,129,193,81,89,177,81,89,129,177,193,81,89,129,193,177,81,89,129,177,193,81,89,129,177,193,81,129,193,89,177,129,193,81,89,177,81,89,129,193,177,81,89,129,193,177,81,89,129,193,177,81,89,129,177,193,81,89,129,177,193,81,89,129,193,177,81,89,129,193,177,81,89,129,193,177,81,129,193,89,177,81,89,129,193,177,81,129,193,89,177,81,89,129,193,177,129,193,81,89,177,81,89,129,193,177,129,193,81,89,177,82,138,194,90,178,138,194,82,90,178,82,90,138,194,178,82,90,138,178,194,138,194,82,90,178,82,90,178,194,138,82,90,138,194,178,82,90,138,178,194,82,90,138,178,194,82,138,194,90,178,138,194,82,90,178,82,90,138,194,178,82,90,138,194,178,82,90,138,194,178,82,90,138,178,194,82,90,138,178,194,82,90,138,194,178,82,90,138,194,178,82,90,138,194,178,82,138,194,90,178,82,90,138,194,178,82,138,194,90,178,82,90,138,194,178,138,194,82,90,178,82,90,138,194,178,138,194,82,90,178,67,115,147,179,187,195,67,115,123,147,179,187,195,67,115,123,147,187,195,75,179,115,123,187,147,195,67,75,179,67,75,147,179,187,195,67,115,147,187,195,179,67,75,187,147,195,179,67,115,123,147,187,195,67,75,115,147,179,187,195,123,67,75,147,179,187,195,115,123,115,123,147,187,195,67,75,179,67,75,115,123,147,187,195,179,67,75,115,123,147,187,195,179,67,75,115,123,147,187,195,179,115,123,147,187,195,67,75,179,67,75,115,123,147,187,195,179,115,123,147,187,195,67,75,179,67,75,115,123,147,179,187,195,147,115,123,187,195,67,75,179,115,123,147,187,195,67,75,179,68,156,180,188,196,68,116,124,156,188,196,76,180,116,124,188,156,196,68,76,180,68,76,156,180,188,196,68,76,188,156,196,180,68,116,124,188,156,196,68,76,116,156,180,188,196,124,68,76,156,180,188,196,116,124,116,124,156,188,196,68,76,180,68,76,116,124,156,188,196,180,68,76,116,124,156,188,196,180,68,76,116,124,156,188,196,180,116,124,188,156,196,68,76,180,68,76,116,124,156,188,196,180,116,124,156,188,196,68,76,180,68,76,116,124,156,180,188,196,156,116,124,188,196,68,76,180,116,124,156,188,196,68,76,180,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,165,109,189,197,165,101,109,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,190,198,174,102,110,190,174,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,174,110,190,198,174,102,110,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,190,174,198,102,110,190,174,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,7,23,151,159,135,143,199,7,15,23,31,135,143,151,159,199,7,135,143,151,23,31,159,199,7,15,23,31,135,143,151,159,199,7,23,31,135,143,151,159,199,7,23,135,143,199,7,15,23,31,135,143,151,159,199,7,15,23,31,135,143,151,159,199,7,15,23,31,135,143,151,159,199,7,15,23,31,151,159,135,143,199,7,15,23,31,151,159,135,143,199,7,15,23,135,143,151,159,31,199,7,23,151,15,31,135,143,159,199,7,15,23,31,135,143,151,159,199,7,15,23,31,135,143,151,159,199,7,15,23,31,135,143,151,159,199,7,15,23,31,151,159,135,143,199,7,15,23,31,135,143,151,159,199,40,152,160,48,56,64,168,176,200,40,152,160,168,176,200,40,48,56,64,152,168,160,176,200,40,48,64,152,168,160,176,200,40,48,152,168,56,64,160,176,200,40,48,56,64,152,160,168,176,200,40,48,56,64,152,160,168,176,200,40,48,56,64,152,160,168,176,200,40,48,56,64,152,160,168,176,200,40,152,160,168,176,200,40,48,56,64,152,160,168,176,200,40,152,160,48,56,64,168,176,200,40,48,56,64,152,168,160,176,200,40,48,56,64,152,168,160,176,200,40,48,56,152,160,168,64,176,200,40,48,152,168,56,64,160,176,200,40,48,56,64,152,160,168,176,200,40,48,56,64,152,160,168,176,200,40,48,56,64,152,160,168,176,200]),190,227);

    [L,~,P] = lu(M(:,1:154));
    P = P';
    M = [P*L P(:,155:end)]\M(:,155:end);
    M = M(end-35:end,:);

    T0 = zeros(37);
    T0([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37],:) = -M(:,37:end);
    T0([1367]) = 1;
    T1 = zeros(37);
    T1([1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,36,37]) = M(:,1:36);
    T1([1293]) = 1;

    [V,~] = eig(T0,T1);
    S = V(29:36,:)./repmat(V(37,:),8,1);

    I = ~any(isnan(S)) & ~any(isinf(S));
    %I = I & ~any(imag(S)); % uncomment this line for real roots only
    S = S(:,I);

end