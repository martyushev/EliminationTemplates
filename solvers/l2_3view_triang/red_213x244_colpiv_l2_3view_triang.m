% Input: coefficient matrix C of size 8x25
% Output: solution matrix S of size 8x31

function S = red_213x244_colpiv_l2_3view_triang(C)

    ix = [1,1,1,1,1,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,13,13,14,14,14,14,14,15,15,15,15,15,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,19,19,19,19,19,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,28,28,28,28,28,29,29,29,29,29,30,30,30,30,30,31,31,31,31,31,32,32,32,32,32,33,33,33,33,33,34,34,34,34,34,35,35,35,35,35,36,36,36,36,36,37,37,37,37,37,38,38,38,38,38,39,39,39,39,39,40,40,40,40,40,41,41,41,41,41,42,42,42,42,42,43,43,43,43,43,44,44,44,44,44,45,45,45,45,45,46,46,46,46,46,47,47,47,47,47,48,48,48,48,48,49,49,49,49,49,50,50,50,50,50,51,51,51,51,51,52,52,52,52,52,53,53,53,53,53,54,54,54,54,54,55,55,55,55,55,56,56,56,56,56,57,57,57,57,57,58,58,58,58,58,59,59,59,59,59,60,60,60,60,60,61,61,61,61,61,62,62,62,62,62,63,63,63,63,63,64,64,64,64,64,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,69,69,69,69,69,69,69,70,70,70,70,70,70,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,73,73,73,73,73,73,74,74,74,74,74,74,75,75,75,75,75,75,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,97,97,97,97,97,97,98,98,98,98,98,98,98,98,99,99,99,99,99,99,100,100,100,100,100,100,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,104,104,104,104,104,104,104,104,105,105,105,105,105,105,105,105,106,106,106,106,106,106,106,106,107,107,107,107,107,107,107,107,108,108,108,108,108,108,108,108,109,109,109,109,109,109,109,109,110,110,110,110,110,110,110,110,111,111,111,111,111,111,111,111,112,112,112,112,112,112,112,112,113,113,113,113,113,113,113,113,114,114,114,114,114,114,114,114,115,115,115,115,115,115,115,115,116,116,116,116,116,116,116,116,117,117,117,117,117,118,118,118,118,118,119,119,119,119,119,120,120,120,120,120,121,121,121,121,121,122,122,122,122,122,123,123,123,123,123,124,124,124,124,124,125,125,125,125,125,126,126,126,126,126,127,127,127,127,127,128,128,128,128,128,129,129,129,129,129,130,130,130,130,130,131,131,131,131,131,132,132,132,132,132,133,133,133,133,133,134,134,134,134,134,135,135,135,135,135,136,136,136,136,136,137,137,137,137,137,138,138,138,138,138,139,139,139,139,139,140,140,140,140,140,141,141,141,141,141,142,142,142,142,142,143,143,143,143,143,144,144,144,144,144,145,145,145,145,145,146,146,146,146,146,147,147,147,147,147,148,148,148,148,148,149,149,149,149,149,150,150,150,150,150,151,151,151,151,151,152,152,152,152,152,153,153,153,153,153,154,154,154,154,154,155,155,155,155,155,156,156,156,156,156,157,157,157,157,157,158,158,158,158,158,159,159,159,159,159,160,160,160,160,160,161,161,161,161,161,162,162,162,162,162,163,163,163,163,163,164,164,164,164,164,165,165,165,165,165,166,166,166,166,166,167,167,167,167,167,168,168,168,168,168,169,169,169,169,169,170,170,170,170,170,171,171,171,171,171,171,171,171,171,172,172,172,172,172,172,172,172,172,173,173,173,173,173,173,173,173,174,174,174,174,174,174,174,174,174,175,175,175,175,175,175,175,175,175,176,176,176,176,176,176,176,176,176,177,177,177,177,177,177,177,177,178,178,178,178,178,178,178,179,179,179,179,179,179,179,179,179,180,180,180,180,180,180,180,180,181,181,181,181,181,181,182,182,182,182,182,182,182,182,182,183,183,183,183,183,183,183,183,183,184,184,184,184,184,184,184,184,184,185,185,185,185,185,185,185,185,185,186,186,186,186,186,186,186,186,186,187,187,187,187,187,187,187,187,187,188,188,188,188,188,188,188,188,188,189,189,189,189,189,189,189,189,189,190,190,190,190,190,190,190,190,190,191,191,191,191,191,191,191,191,191,192,192,192,192,192,192,192,192,192,193,193,193,193,193,193,193,193,193,194,194,194,194,194,194,194,194,194,195,195,195,195,195,195,195,195,195,196,196,196,196,196,196,196,196,197,197,197,197,197,197,197,197,197,198,198,198,198,198,198,198,198,198,199,199,199,199,199,199,199,199,200,200,200,200,200,200,201,201,201,201,201,201,201,201,201,202,202,202,202,202,202,202,202,202,203,203,203,203,203,203,204,204,204,204,204,204,204,204,204,205,205,205,205,205,205,205,205,205,206,206,206,206,206,206,206,206,206,207,207,207,207,207,207,207,207,207,208,208,208,208,208,208,208,208,208,209,209,209,209,209,209,209,209,209,210,210,210,210,210,210,210,210,210,211,211,211,211,211,211,211,211,211,212,212,212,212,212,212,212,212,212,213,213,213,213,213,213,213,213,213];
    jx = [19,41,94,102,164,20,42,95,103,165,21,45,97,104,166,22,46,98,105,167,169,172,203,222,237,170,173,205,223,238,27,66,106,132,171,28,67,107,133,172,173,174,207,224,239,29,69,108,134,174,30,71,109,137,175,176,177,215,226,241,31,74,110,140,177,36,82,111,146,178,37,84,112,147,179,52,91,118,149,190,53,92,119,150,191,192,193,228,234,243,54,113,120,151,193,55,94,121,152,194,56,97,122,153,195,57,118,123,154,196,65,124,128,155,201,106,129,143,156,221,107,130,144,157,222,223,224,236,242,244,108,132,145,158,224,109,135,146,159,225,110,138,147,160,226,90,143,148,161,227,120,149,154,162,234,145,156,161,163,242,19,42,94,102,164,20,43,95,103,165,21,46,97,104,166,22,47,98,105,167,169,172,204,222,237,170,173,206,223,238,27,67,106,132,171,28,68,107,133,172,173,174,208,224,239,29,70,108,134,174,30,72,109,137,175,176,177,216,226,241,31,75,110,140,177,36,83,111,146,178,37,85,112,147,179,52,92,118,149,190,53,93,119,150,191,192,193,229,234,243,54,114,120,151,193,55,95,121,152,194,56,98,122,153,195,57,119,123,154,196,65,125,128,155,201,106,130,143,156,221,107,131,144,157,222,223,224,237,242,244,108,133,145,158,224,109,136,146,159,225,110,139,147,160,226,90,144,148,161,227,120,150,154,162,234,145,157,161,163,242,23,24,41,45,79,91,129,202,24,25,42,46,80,92,130,203,25,26,43,47,81,93,131,204,5,15,206,222,229,237,3,6,12,106,113,132,207,4,6,107,114,133,208,171,172,187,189,209,224,231,239,27,28,44,48,108,115,134,210,11,16,109,116,137,214,9,18,217,226,233,241,13,17,110,117,140,218,32,33,49,50,86,99,141,219,34,35,50,51,87,100,142,220,1,194,195,223,227,234,242,190,191,199,200,230,234,235,243,52,53,60,62,101,120,151,231,61,63,102,103,121,126,152,232,63,64,104,105,122,127,153,233,79,80,94,97,143,149,156,236,80,81,95,98,144,150,157,237,221,222,232,233,238,242,243,244,106,107,116,117,145,151,158,239,82,83,96,99,146,152,159,240,84,85,99,100,147,153,160,241,88,89,121,122,148,154,161,242,118,119,126,127,154,155,162,243,143,144,152,153,161,162,163,244,23,24,41,45,66,79,91,129,24,25,42,46,67,80,92,130,25,26,43,47,68,81,93,131,168,169,186,188,209,223,230,238,3,6,12,69,106,113,132,4,6,70,107,114,133,171,172,187,189,210,224,231,239,11,16,73,109,116,137,13,17,76,110,117,140,32,33,49,50,77,86,99,141,34,35,50,51,78,87,100,142,2,55,56,90,108,120,145,190,191,199,200,231,234,235,243,52,53,60,62,101,115,120,151,61,63,102,103,116,121,126,152,63,64,104,105,117,122,127,153,79,80,94,97,132,143,149,156,80,81,95,98,133,144,150,157,221,222,232,233,239,242,243,244,106,107,116,117,134,145,151,158,82,83,96,99,137,146,152,159,84,85,99,100,140,147,153,160,88,89,121,122,145,148,154,161,118,119,126,127,151,154,155,162,143,144,152,153,158,161,162,163,21,32,84,104,166,22,33,85,105,167,180,183,212,229,237,181,184,213,230,238,38,71,113,132,182,39,72,114,133,183,184,185,214,231,239,40,73,115,134,185,188,189,219,233,241,48,77,117,140,189,56,86,122,147,195,57,111,123,148,196,58,94,124,149,197,59,95,125,150,198,60,96,126,152,199,62,99,127,153,200,65,121,128,154,201,113,135,149,156,228,114,136,150,157,229,230,231,240,243,244,115,137,151,158,231,117,141,153,160,233,120,146,154,161,234,101,152,155,162,235,151,159,162,163,243,20,33,83,103,165,21,34,84,104,166,22,35,85,105,167,180,183,216,229,237,181,184,217,230,238,38,74,113,132,182,39,75,114,133,183,184,185,218,231,239,40,76,115,134,185,44,77,116,137,187,188,189,220,233,241,48,78,117,140,189,55,86,121,146,194,56,87,122,147,195,57,112,123,148,196,58,97,124,149,197,59,98,125,150,198,60,99,126,152,199,62,100,127,153,200,65,122,128,154,201,113,138,149,156,228,114,139,150,157,229,230,231,241,243,244,115,140,151,158,231,116,141,152,159,232,117,142,153,160,233,120,147,154,161,234,101,153,155,162,235,151,160,162,163,243,19,20,55,102,103,121,164,165,194,21,22,56,104,105,122,166,167,195,4,5,6,80,81,107,144,222,168,169,171,172,221,222,223,224,242,27,28,106,107,108,145,171,172,224,7,11,14,16,82,83,109,146,225,9,13,17,84,85,110,147,226,1,2,88,89,90,148,227,38,39,113,114,115,151,182,183,231,8,12,15,94,95,116,152,232,10,97,98,117,153,233,52,53,118,119,120,154,190,191,234,58,59,101,124,125,155,197,198,235,66,67,129,130,132,156,202,203,236,67,68,130,131,133,157,203,204,237,205,206,207,208,236,237,238,239,244,69,70,132,133,134,158,207,208,239,71,72,135,136,137,159,211,212,240,74,75,138,139,140,160,215,216,241,106,107,143,144,145,161,221,222,242,113,114,149,150,151,162,228,229,243,132,133,156,157,158,163,236,237,244,19,21,52,102,104,118,164,166,190,20,22,53,103,105,119,165,167,191,7,9,11,13,82,84,106,143,221,14,16,17,83,85,107,144,222,30,31,108,109,110,145,175,177,224,36,37,90,111,112,148,178,179,227,8,10,12,94,97,113,149,228,15,95,98,114,150,229,186,187,188,189,230,231,232,233,243,44,48,115,116,117,151,187,189,231,18,99,100,117,153,233,55,56,120,121,122,154,194,195,234,60,62,101,126,127,155,199,200,235,71,74,132,135,138,156,211,215,236,72,75,133,136,139,157,212,216,237,213,214,217,218,238,239,240,241,244,73,76,134,137,140,158,214,218,239,77,78,140,141,142,160,219,220,241,109,110,145,146,147,161,225,226,242,116,117,151,152,153,162,232,233,243,137,140,158,159,160,163,240,241,244];
    kx = [89,129,193,177,81,89,129,193,177,81,89,129,193,177,81,89,129,193,177,81,81,89,129,177,193,81,89,129,177,193,89,129,177,193,81,89,129,177,193,81,81,89,129,177,193,89,129,177,193,81,89,129,177,193,81,81,89,129,177,193,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,81,89,129,177,193,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,81,89,129,177,193,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,89,129,177,193,81,90,138,194,178,82,90,138,194,178,82,90,138,194,178,82,90,138,194,178,82,82,90,138,178,194,82,90,138,178,194,90,138,178,194,82,90,138,178,194,82,82,90,138,178,194,90,138,178,194,82,90,138,178,194,82,82,90,138,178,194,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,82,90,138,178,194,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,82,90,138,178,194,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,90,138,178,194,82,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,115,147,179,187,195,67,75,115,179,187,195,147,75,67,179,187,195,147,67,75,115,123,147,179,187,195,67,75,115,123,179,187,195,147,67,75,179,187,195,147,67,115,147,179,187,195,67,75,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,115,123,147,179,187,195,67,75,115,123,147,179,187,195,67,75,115,123,187,179,195,147,115,123,67,75,179,187,195,147,115,123,67,75,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,147,179,187,195,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,67,75,115,123,179,187,195,147,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,156,180,188,196,76,68,156,180,188,196,68,76,116,124,156,180,188,196,68,76,156,180,188,196,68,76,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,116,124,180,156,188,196,68,76,116,124,156,180,188,196,68,76,116,124,188,156,180,196,116,124,68,76,156,180,188,196,116,124,68,76,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,68,76,116,124,156,180,188,196,109,165,197,189,101,109,165,197,189,101,101,109,165,189,197,101,109,165,189,197,109,165,189,197,101,109,165,189,197,101,101,109,165,189,197,109,165,189,197,101,101,109,165,189,197,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,101,109,165,189,197,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,109,165,189,197,101,110,174,198,190,102,110,174,198,190,102,110,174,198,190,102,102,110,174,190,198,102,110,174,190,198,110,174,190,198,102,110,174,190,198,102,102,110,174,190,198,110,174,190,198,102,110,174,190,198,102,102,110,174,190,198,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,102,110,174,190,198,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,110,174,190,198,102,23,31,159,135,143,199,7,15,151,23,31,159,135,143,199,7,15,151,31,7,23,135,143,159,199,151,7,15,23,31,135,143,151,159,199,23,31,135,143,159,199,7,15,151,7,23,15,31,135,143,159,199,151,7,23,31,135,143,159,199,151,7,23,135,143,159,199,151,23,31,135,143,159,199,7,15,151,7,23,15,135,143,159,199,151,7,135,143,159,199,151,23,31,135,143,159,199,7,15,151,23,31,159,135,143,199,7,15,151,23,31,135,143,159,199,7,15,151,23,31,135,143,159,199,7,15,151,7,15,23,31,135,143,151,159,199,23,31,135,143,159,199,7,15,151,23,31,135,143,159,199,7,15,151,23,31,135,143,159,199,7,15,151,23,31,135,143,159,199,7,15,151,23,31,135,143,159,199,7,15,151,23,31,135,143,159,199,7,15,151,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,40,56,48,64,168,176,160,200,152,40,48,64,168,176,160,200,152,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,40,56,48,168,176,160,200,152,40,168,176,160,200,152,40,48,56,64,152,160,168,176,200,48,64,160,168,176,200,40,56,152,40,168,176,160,200,152,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,40,48,56,64,152,160,168,176,200,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152,48,64,160,168,176,200,40,56,152];
    M = sparse(ix,jx,C(kx),213,244);

    [L,~,P] = lu(M(:,1:101));
    P = P';
    M = [P*L P(:,102:end)]\M(:,102:end);
    M = full(M(102:end,:));

    [L,U,P] = lu(M(:,1:62));
    P = P';
    M = [P*L P(:,63:end)]\M(:,63:end);
    M1 = M(1:62,:);
    M2 = M(63:end,:);

    [Q,R,P] = qr(M2(:,1:end-9));
    A = U\[M1(:,1:end-9)*P M1(:,end-8:end)];
    B = R(:,1:50)\[R(:,51:end) Q'*M2(:,end-8:end)];
    M = [-A(:,end-30:end)+A(:,1:end-31)*B; -B];

    P1 = [82:143 (1:72)*P 73:81];
    P2 = [82,83,84,85,58,59,60,86,87,61,88,89,63,90,91,92,66,67,93,94,68,95,69,96,70,97,98,99,71,100,101,102,103,104,105,106,107,108,109,110,111,73,74,112,113,76,114,115,116,77,117,118,119,78,120,121,122,123,124,79,125,126,127,128,129,130,80,131,132,133,134,135,136,137,81,138,139,140,141,142,143];
    T = getT(M,P1(1:end-31),P1(end-30:end),P2);

    [V,~] = eig(T);
    S = V(23:30,:)./repmat(V(31,:),8,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end