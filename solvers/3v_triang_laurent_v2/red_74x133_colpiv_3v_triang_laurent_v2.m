% Input: coefficient matrix C of size 3x24
% Output: solution matrix S of size 3x59

function S = red_74x133_colpiv_3v_triang_laurent_v2(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,74];
    jx = [15,19,26,32,39,41,42,47,49,50,57,81,109,111,112,117,123,13,17,21,26,32,34,35,39,41,42,50,71,94,96,97,104,112,32,33,40,47,48,50,51,56,57,58,63,95,122,123,124,128,129,7,8,15,21,26,28,29,32,34,35,42,64,81,83,84,90,97,26,27,33,39,40,42,43,48,50,51,58,82,110,112,113,118,124,27,28,34,40,41,43,44,49,51,52,59,83,111,113,114,119,125,28,29,35,41,42,44,45,50,52,53,60,84,112,114,115,120,126,29,30,36,42,43,45,46,51,53,54,61,85,113,115,121,127,130,20,30,31,37,43,44,46,52,54,55,62,86,114,130,131,132,133,21,22,27,32,33,35,36,40,42,43,51,72,95,97,98,105,113,22,23,28,33,34,36,37,41,43,44,52,73,96,98,99,106,114,23,24,29,34,35,37,38,42,44,45,53,74,97,99,100,107,115,18,24,25,30,35,36,38,43,45,46,54,75,98,100,101,108,130,8,9,22,26,27,29,30,33,35,36,43,65,82,84,85,91,98,9,10,23,27,28,30,31,34,36,37,44,66,83,85,86,92,99,10,11,16,24,28,29,31,35,37,38,45,67,84,86,87,93,100,1,4,6,9,21,22,24,25,27,29,30,36,72,74,75,79,85,1,5,10,14,22,23,25,28,30,31,37,73,75,76,80,86,1,2,3,8,9,11,12,22,24,25,30,65,67,68,70,75,16,20,31,38,43,44,46,52,53,55,60,87,114,115,120,126,131,14,18,25,31,35,36,38,43,44,46,52,76,98,99,101,106,114,35,36,43,49,50,52,53,57,58,60,63,98,123,124,126,128,129,11,12,16,25,28,29,31,35,36,38,43,68,84,85,87,91,98,19,26,27,33,39,41,42,47,48,50,56,82,109,110,112,116,122,28,29,35,40,41,43,44,49,50,52,57,84,111,112,114,117,123,29,30,36,41,42,44,45,50,51,53,58,85,112,113,115,118,124,30,31,37,42,43,45,46,51,52,54,59,86,113,114,119,125,130,17,21,22,27,32,34,35,39,40,42,48,72,94,95,97,102,110,22,23,28,32,33,35,36,40,41,43,49,73,95,96,98,103,111,23,24,29,33,34,36,37,41,42,44,50,74,96,97,99,104,112,24,25,30,34,35,37,38,42,43,45,51,75,97,98,100,105,113,8,9,15,22,26,28,29,32,33,35,40,65,81,82,84,88,95,9,10,23,26,27,29,30,33,34,36,41,66,82,83,85,89,96,10,11,24,27,28,30,31,34,35,37,42,67,83,84,86,90,97,1,4,6,9,13,21,23,24,26,27,29,33,71,72,74,77,82,1,5,10,21,22,24,25,27,28,30,34,72,73,75,78,83,1,2,3,7,8,10,11,21,22,24,27,64,65,67,69,72,15,19,26,32,39,40,41,47,49,81,109,111,16,20,31,38,44,45,46,53,55,87,115,131,81,82,88,95,109,110,111,112,116,117,122,123,83,84,90,97,111,112,113,114,117,119,123,125,84,85,91,98,112,113,114,115,118,120,124,126,85,86,92,99,113,114,115,119,121,125,127,130,86,87,93,100,114,115,120,126,130,131,132,133,13,17,21,26,32,33,34,39,41,71,94,96,14,18,25,31,36,37,38,44,46,76,99,101,71,72,77,82,94,95,96,97,102,104,110,112,72,73,78,83,95,96,97,98,103,105,111,113,74,75,79,85,97,98,99,100,105,107,113,115,75,76,80,86,98,99,100,101,106,108,114,130,32,33,40,47,48,49,50,56,57,95,122,123,34,35,42,49,50,51,52,57,59,97,123,125,35,36,43,50,51,52,53,58,60,98,124,126,36,37,44,51,52,53,54,59,61,99,125,127,37,38,45,52,53,54,55,60,62,100,126,133,7,8,15,21,26,27,28,32,34,64,81,83,11,12,16,25,29,30,31,36,38,68,85,87,64,65,69,72,81,82,83,84,88,90,95,97,67,68,70,75,84,85,86,87,91,93,98,100,26,27,33,39,40,41,42,48,50,82,110,112,27,28,34,40,41,42,43,49,51,83,111,113,28,29,35,41,42,43,44,50,52,84,112,114,29,30,36,42,43,44,45,51,53,85,113,115,30,31,37,43,44,45,46,52,54,86,114,130,21,22,27,32,33,34,35,40,42,72,95,97,22,23,28,33,34,35,36,41,43,73,96,98,23,24,29,34,35,36,37,42,44,74,97,99,24,25,30,35,36,37,38,43,45,75,98,100,8,9,22,26,27,28,29,33,35,65,82,84,9,10,23,27,28,29,30,34,36,66,83,85,10,11,24,28,29,30,31,35,37,67,84,86,1,4,6,9,21,22,23,24,27,29,72,74,1,5,10,22,23,24,25,28,30,73,75,1,2,3,8,9,10,11,22,24,65,67];
    kx = [1,16,4,10,19,25,28,52,55,58,70,7,34,37,40,46,64,1,16,4,10,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,16,10,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,46,64,40,28,1,4,10,16,19,25,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,28,1,4,10,16,19,25,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,28,10,16,19,25,52,55,58,70,7,34,37,40,46,64,4,1,7,10,16,19,25,28,52,55,58,70,34,37,40,46,64,1,4,10,28,16,19,25,52,55,58,70,34,37,40,46,64,10,1,4,16,19,25,28,52,55,58,70,34,37,40,46,64,5,26,2,11,14,17,23,50,53,56,68,8,32,35,44,62,38,5,26,2,11,14,17,23,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,26,11,14,17,23,50,53,56,68,8,32,35,38,44,62,14,2,5,11,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,44,62,38,14,2,5,11,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,14,11,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,5,2,8,11,14,17,23,26,50,53,56,68,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,32,35,38,44,62,11,2,5,14,17,23,26,50,53,56,68,32,35,38,44,62,3,18,6,12,21,24,27,54,57,9,36,39,6,27,3,12,18,21,24,54,57,9,36,39,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,36,39,54,57,27,3,6,9,12,18,21,36,54,24,27,39,57,3,18,6,12,21,24,27,54,57,9,36,39,6,27,3,12,18,21,24,54,57,9,36,39,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,18,12,21,24,27,54,57,9,36,39,3,6,27,12,18,21,24,54,57,9,36,39,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,6,3,9,12,18,21,24,27,54,57,36,39,3,6,12,18,21,24,27,54,57,36,39,12,3,6,18,21,24,27,54,57,36,39];
    M = sparse(ix,jx,C(kx),74,133);

    [L,~,P] = lu(M(:,1:20));
    P = P';
    M = [P*L P(:,21:end)]\M(:,21:end);
    M = full(M(21:end,:));

    [L,U,P] = lu(M(:,1:43));
    P = P';
    M = [P*L P(:,44:end)]\M(:,44:end);
    M1 = M(1:43,:);
    M2 = M(44:end,:);

    [Q,R,P] = qr(M2(:,1:end-4));
    A = U\[M1(:,1:end-4)*P M1(:,end-3:end)];
    B = R(:,1:11)\[R(:,12:end) Q'*M2(:,end-3:end)];
    M = [-A(:,end-58:end)+A(:,1:end-59)*B; -B];

    P1 = [71:113 (1:66)*P 67:70];
    P2 = [71,72,73,74,75,9,12,76,77,78,79,80,81,19,20,22,23,82,83,84,85,86,87,88,32,33,34,35,36,37,89,90,91,92,93,94,95,96,47,48,49,50,51,52,67,97,98,99,100,101,102,103,59,60,61,62,63,64,106,107,108,109,110,111,66,113,104,105,70,112];
    T = getT(M,P1(1:end-59),P1(end-58:end),P2);

    [V,~] = eig(T);
    S = V(56:58,:)./repmat(V(59,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end