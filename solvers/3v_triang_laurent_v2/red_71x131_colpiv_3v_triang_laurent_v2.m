% Input: coefficient matrix C of size 3x24
% Output: solution matrix S of size 3x60

function S = red_71x131_colpiv_3v_triang_laurent_v2(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71];
    jx = [12,16,25,31,38,40,41,46,48,49,56,81,109,111,112,117,122,10,14,20,25,31,33,34,38,40,41,49,71,94,96,97,104,112,31,32,39,46,47,49,50,55,56,57,61,95,121,122,123,126,127,6,7,12,20,25,27,28,31,33,34,41,64,81,83,84,90,97,25,26,32,38,39,41,42,47,49,50,57,82,110,112,113,118,123,26,27,33,39,40,42,43,48,50,51,58,83,111,113,114,119,124,27,28,34,40,41,43,44,49,51,52,59,84,112,114,115,120,125,17,29,30,36,42,43,45,51,53,54,60,86,114,128,129,130,131,20,21,26,31,32,34,35,39,41,42,50,72,95,97,98,105,113,21,22,27,32,33,35,36,40,42,43,51,73,96,98,99,106,114,22,23,28,33,34,36,37,41,43,44,52,74,97,99,100,107,115,15,23,24,29,34,35,37,42,44,45,53,75,98,100,101,108,128,7,18,21,25,26,28,29,32,34,35,42,65,82,84,85,91,98,18,19,22,26,27,29,30,33,35,36,43,66,83,85,86,92,99,8,13,19,23,27,28,30,34,36,37,44,67,84,86,87,93,100,3,4,18,20,21,23,24,26,28,29,35,62,72,74,75,79,85,4,5,11,19,21,22,24,27,29,30,36,63,73,75,76,80,86,1,2,4,7,8,9,18,21,23,24,29,65,67,68,70,75,13,17,30,37,42,43,45,51,52,54,59,87,114,115,120,125,129,11,15,24,30,34,35,37,42,43,45,51,76,98,99,101,106,114,34,35,42,48,49,51,52,56,57,59,61,98,122,123,125,126,127,8,9,13,24,27,28,30,34,35,37,42,68,84,85,87,91,98,16,25,26,32,38,40,41,46,47,49,55,82,109,110,112,116,121,27,28,34,39,40,42,43,48,49,51,56,84,111,112,114,117,122,28,29,35,40,41,43,44,49,50,52,57,85,112,113,115,118,123,29,30,36,41,42,44,45,50,51,53,58,86,113,114,119,124,128,14,20,21,26,31,33,34,38,39,41,47,72,94,95,97,102,110,21,22,27,31,32,34,35,39,40,42,48,73,95,96,98,103,111,22,23,28,32,33,35,36,40,41,43,49,74,96,97,99,104,112,23,24,29,33,34,36,37,41,42,44,50,75,97,98,100,105,113,7,12,18,21,25,27,28,31,32,34,39,65,81,82,84,88,95,18,19,22,25,26,28,29,32,33,35,40,66,82,83,85,89,96,8,19,23,26,27,29,30,33,34,36,41,67,83,84,86,90,97,3,4,10,18,20,22,23,25,26,28,32,62,71,72,74,77,82,4,5,19,20,21,23,24,26,27,29,33,63,72,73,75,78,83,1,2,4,6,7,8,19,20,21,23,26,64,65,67,69,72,12,16,25,31,38,39,40,46,48,81,109,111,13,17,30,37,43,44,45,52,54,87,115,129,81,82,88,95,109,110,111,112,116,117,121,122,83,84,90,97,111,112,113,114,117,119,122,124,84,85,91,98,112,113,114,115,118,120,123,125,86,87,93,100,114,115,120,125,128,129,130,131,10,14,20,25,31,32,33,38,40,71,94,96,11,15,24,30,35,36,37,43,45,76,99,101,71,72,77,82,94,95,96,97,102,104,110,112,72,73,78,83,95,96,97,98,103,105,111,113,74,75,79,85,97,98,99,100,105,107,113,115,75,76,80,86,98,99,100,101,106,108,114,128,31,32,39,46,47,48,49,55,56,95,121,122,33,34,41,48,49,50,51,56,58,97,122,124,34,35,42,49,50,51,52,57,59,98,123,125,36,37,44,51,52,53,54,59,60,100,125,131,6,7,12,20,25,26,27,31,33,64,81,83,8,9,13,24,28,29,30,35,37,68,85,87,64,65,69,72,81,82,83,84,88,90,95,97,67,68,70,75,84,85,86,87,91,93,98,100,25,26,32,38,39,40,41,47,49,82,110,112,26,27,33,39,40,41,42,48,50,83,111,113,27,28,34,40,41,42,43,49,51,84,112,114,28,29,35,41,42,43,44,50,52,85,113,115,29,30,36,42,43,44,45,51,53,86,114,128,20,21,26,31,32,33,34,39,41,72,95,97,21,22,27,32,33,34,35,40,42,73,96,98,22,23,28,33,34,35,36,41,43,74,97,99,23,24,29,34,35,36,37,42,44,75,98,100,7,18,21,25,26,27,28,32,34,65,82,84,18,19,22,26,27,28,29,33,35,66,83,85,8,19,23,27,28,29,30,34,36,67,84,86,3,4,18,20,21,22,23,26,28,62,72,74,4,5,19,21,22,23,24,27,29,63,73,75,1,2,4,7,8,18,19,21,23,65,67];
    kx = [1,16,4,10,19,25,28,52,55,58,70,7,34,37,40,46,64,1,16,4,10,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,16,10,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,28,1,4,10,16,19,25,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,28,1,4,10,16,19,25,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,4,28,1,10,16,19,25,52,55,58,70,7,34,37,40,46,64,1,4,10,16,19,25,28,52,55,58,70,7,34,37,40,46,64,1,4,28,10,16,19,25,52,55,58,70,7,34,37,40,46,64,1,4,10,16,25,28,19,52,55,58,70,34,37,40,46,64,5,26,2,11,14,17,23,50,53,56,68,8,32,35,44,62,38,5,26,2,11,14,17,23,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,26,11,14,17,23,50,53,56,68,8,32,35,38,44,62,14,2,5,11,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,44,62,38,14,2,5,11,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,14,5,11,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,5,2,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,14,11,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,23,26,50,53,56,68,8,32,35,38,44,62,2,5,11,14,17,26,23,50,53,56,68,32,35,38,44,62,3,18,6,12,21,24,27,54,57,9,36,39,6,27,3,12,18,21,24,54,57,9,36,39,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,36,54,24,27,39,57,3,18,6,12,21,24,27,54,57,9,36,39,6,27,3,12,18,21,24,54,57,9,36,39,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,18,12,21,24,27,54,57,9,36,39,3,6,27,12,18,21,24,54,57,9,36,39,3,6,9,12,18,21,24,27,36,39,54,57,3,6,9,12,18,21,24,27,36,39,54,57,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,6,3,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,21,24,27,54,57,9,36,39,3,6,12,18,27,21,24,54,57,36,39];
    M = sparse(ix,jx,C(kx),71,131);

    [L,~,P] = lu(M(:,1:17));
    P = P';
    M = [P*L P(:,18:end)]\M(:,18:end);
    M = full(M(18:end,:));

    [L,U,P] = lu(M(:,1:44));
    P = P';
    M = [P*L P(:,45:end)]\M(:,45:end);
    M1 = M(1:44,:);
    M2 = M(45:end,:);

    [Q,R,P] = qr(M2(:,1:end-4));
    A = U\[M1(:,1:end-4)*P M1(:,end-3:end)];
    B = R(:,1:10)\[R(:,11:end) Q'*M2(:,end-3:end)];
    M = [-A(:,end-59:end)+A(:,1:end-60)*B; -B];

    P1 = [71:114 (1:66)*P 67:70];
    P2 = [71,72,73,74,75,76,77,11,14,78,79,80,81,82,83,21,22,24,25,84,85,86,87,88,89,90,34,35,36,37,38,39,91,92,93,94,95,96,97,98,49,50,51,52,53,54,67,99,100,101,102,103,104,105,60,61,62,63,64,108,109,110,111,112,66,114,106,107,70,113];
    T = getT(M,P1(1:end-60),P1(end-59:end),P2);

    [V,~] = eig(T);
    S = V(57:59,:)./repmat(V(60,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end