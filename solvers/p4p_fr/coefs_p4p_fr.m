function C = coefs_p4p_fr(data)

    m1 = data{1};
    m2 = data{2};
    m3 = data{3};

    C = zeros(4,20);

    C(25) = m1(1)*m2(1)+m1(2)*m2(2)+m1(3)*m2(3)+m1(4)*m2(4);
    C(26) = m1(1)*m3(1)+m1(2)*m3(2)+m1(3)*m3(3)+m1(4)*m3(4);
    C(2) = m1(1)*m3(13)+m1(2)*m3(14)+m1(3)*m3(15)+m1(4)*m3(16);
    C(57) = m1(5)*m2(5)+m1(6)*m2(6)+m1(7)*m2(7)+m1(8)*m2(8);
    C(58) = m1(5)*m3(5)+m1(6)*m3(6)+m1(7)*m3(7)+m1(8)*m3(8);
    C(22) = m1(5)*m3(17)+m1(6)*m3(18)+m1(7)*m3(19)+m1(8)*m3(20);
    C(41) = m1(9)*m2(9)+m1(10)*m2(10)+m1(11)*m2(11)+m1(12)*m2(12);
    C(42) = m1(9)*m3(9)+m1(10)*m3(10)+m1(11)*m3(11)+m1(12)*m3(12);
    C(10) = m1(9)*m3(21)+m1(10)*m3(22)+m1(11)*m3(23)+m1(12)*m3(24);
    C(66) = m1(13)*m3(25)+m1(14)*m3(26)+m1(15)*m3(27)+m1(16)*m3(28);
    C(78) = m1(13)*m3(29)+m1(16)*m3(32)+m1(15)*m3(31)+m1(14)*m3(30);
    C(77) = m1(14)*m2(14)+m1(13)*m2(13)+m1(16)*m2(16)+m1(15)*m2(15);
    C(27) = m2(1)*m3(1)+m2(2)*m3(2)+m2(3)*m3(3)+m2(4)*m3(4);
    C(3) = m2(1)*m3(13)+m2(2)*m3(14)+m2(3)*m3(15)+m2(4)*m3(16);
    C(59) = m2(5)*m3(5)+m2(6)*m3(6)+m2(7)*m3(7)+m2(8)*m3(8);
    C(23) = m2(5)*m3(17)+m2(6)*m3(18)+m2(7)*m3(19)+m2(8)*m3(20);
    C(43) = m2(9)*m3(9)+m2(10)*m3(10)+m2(11)*m3(11)+m2(12)*m3(12);
    C(11) = m2(9)*m3(21)+m2(10)*m3(22)+m2(11)*m3(23)+m2(12)*m3(24);
    C(67) = m2(13)*m3(25)+m2(14)*m3(26)+m2(15)*m3(27)+m2(16)*m3(28);
    C(79) = m2(13)*m3(29)+m2(14)*m3(30)+m2(15)*m3(31)+m2(16)*m3(32);
    C(28) = m1(1)^2+m1(2)^2-m2(3)^2-m2(2)^2+m1(4)^2-m2(4)^2-m2(1)^2+m1(3)^2;
    C(44) = m1(11)^2+m1(9)^2+m1(10)^2-m2(9)^2-m2(11)^2+m1(12)^2-m2(10)^2-m2(12)^2;
    C(80) = m1(13)^2+m1(14)^2+m1(15)^2+m1(16)^2-m2(13)^2-m2(14)^2-m2(15)^2-m2(16)^2;
    C(60) = -m2(6)^2+m1(8)^2+m1(7)^2+m1(5)^2-m2(5)^2-m2(7)^2+m1(6)^2-m2(8)^2;
    C(48) = 2*m1(1)*m1(5)+2*m1(2)*m1(6)+2*m1(3)*m1(7)+2*m1(4)*m1(8)-2*m2(1)*m2(5)-2*m2(2)*m2(6)-2*m2(3)*m2(7)-2*m2(4)*m2(8);
    C(36) = 2*m1(1)*m1(9)+2*m1(2)*m1(10)+2*m1(3)*m1(11)+2*m1(4)*m1(12)-2*m2(1)*m2(9)-2*m2(2)*m2(10)-2*m2(3)*m2(11)-2*m2(4)*m2(12);
    C(64) = 2*m1(1)*m1(13)+2*m1(2)*m1(14)+2*m1(3)*m1(15)+2*m1(4)*m1(16)-2*m2(1)*m2(13)-2*m2(2)*m2(14)-2*m2(3)*m2(15)-2*m2(4)*m2(16);
    C(45) = m1(1)*m2(5)+m1(5)*m2(1)+m1(2)*m2(6)+m1(6)*m2(2)+m1(3)*m2(7)+m1(7)*m2(3)+m1(4)*m2(8)+m1(8)*m2(4);
    C(33) = m1(1)*m2(9)+m1(9)*m2(1)+m1(2)*m2(10)+m1(10)*m2(2)+m1(3)*m2(11)+m1(11)*m2(3)+m1(4)*m2(12)+m1(12)*m2(4);
    C(61) = m1(1)*m2(13)+m1(13)*m2(1)+m1(2)*m2(14)+m1(14)*m2(2)+m1(3)*m2(15)+m1(15)*m2(3)+m1(4)*m2(16)+m1(16)*m2(4);
    C(46) = m1(1)*m3(5)+m1(5)*m3(1)+m1(2)*m3(6)+m1(6)*m3(2)+m1(3)*m3(7)+m1(7)*m3(3)+m1(4)*m3(8)+m1(8)*m3(4);
    C(34) = m1(1)*m3(9)+m1(9)*m3(1)+m1(2)*m3(10)+m1(10)*m3(2)+m1(3)*m3(11)+m1(11)*m3(3)+m1(4)*m3(12)+m1(12)*m3(4);
    C(30) = m1(1)*m3(25)+m1(13)*m3(13)+m1(2)*m3(26)+m1(14)*m3(14)+m1(3)*m3(27)+m1(15)*m3(15)+m1(4)*m3(28)+m1(16)*m3(16);
    C(62) = m1(1)*m3(29)+m1(13)*m3(1)+m1(2)*m3(30)+m1(14)*m3(2)+m1(3)*m3(31)+m1(15)*m3(3)+m1(4)*m3(32)+m1(16)*m3(4);
    C(14) = m1(4)*m3(20)+m1(1)*m3(17)+m1(5)*m3(13)+m1(2)*m3(18)+m1(6)*m3(14)+m1(3)*m3(19)+m1(7)*m3(15)+m1(8)*m3(16);
    C(56) = 2*m1(5)*m1(9)+2*m1(6)*m1(10)+2*m1(7)*m1(11)+2*m1(8)*m1(12)-2*m2(5)*m2(9)-2*m2(6)*m2(10)-2*m2(7)*m2(11)-2*m2(8)*m2(12);
    C(76) = 2*m1(5)*m1(13)+2*m1(6)*m1(14)+2*m1(7)*m1(15)+2*m1(8)*m1(16)-2*m2(5)*m2(13)-2*m2(6)*m2(14)-2*m2(7)*m2(15)-2*m2(8)*m2(16);
    C(53) = m1(5)*m2(9)+m1(9)*m2(5)+m1(6)*m2(10)+m1(10)*m2(6)+m1(7)*m2(11)+m1(11)*m2(7)+m1(8)*m2(12)+m1(12)*m2(8);
    C(73) = m1(5)*m2(13)+m1(13)*m2(5)+m1(6)*m2(14)+m1(14)*m2(6)+m1(7)*m2(15)+m1(15)*m2(7)+m1(8)*m2(16)+m1(16)*m2(8);
    C(54) = m1(5)*m3(9)+m1(9)*m3(5)+m1(6)*m3(10)+m1(10)*m3(6)+m1(7)*m3(11)+m1(11)*m3(7)+m1(8)*m3(12)+m1(12)*m3(8);
    C(50) = m1(5)*m3(25)+m1(13)*m3(17)+m1(6)*m3(26)+m1(14)*m3(18)+m1(7)*m3(27)+m1(15)*m3(19)+m1(8)*m3(28)+m1(16)*m3(20);
    C(74) = m1(5)*m3(29)+m1(13)*m3(5)+m1(6)*m3(30)+m1(14)*m3(6)+m1(7)*m3(31)+m1(15)*m3(7)+m1(8)*m3(32)+m1(16)*m3(8);
    C(18) = m1(7)*m3(23)+m1(11)*m3(19)+m1(5)*m3(21)+m1(9)*m3(17)+m1(6)*m3(22)+m1(10)*m3(18)+m1(8)*m3(24)+m1(12)*m3(20);
    C(72) = 2*m1(9)*m1(13)+2*m1(10)*m1(14)+2*m1(11)*m1(15)+2*m1(12)*m1(16)-2*m2(9)*m2(13)-2*m2(10)*m2(14)-2*m2(11)*m2(15)-2*m2(12)*m2(16);
    C(69) = m1(9)*m2(13)+m1(13)*m2(9)+m1(10)*m2(14)+m1(14)*m2(10)+m1(11)*m2(15)+m1(15)*m2(11)+m1(12)*m2(16)+m1(16)*m2(12);
    C(38) = m1(9)*m3(25)+m1(13)*m3(21)+m1(10)*m3(26)+m1(14)*m3(22)+m1(11)*m3(27)+m1(15)*m3(23)+m1(12)*m3(28)+m1(16)*m3(24);
    C(70) = m1(9)*m3(29)+m1(13)*m3(9)+m1(10)*m3(30)+m1(14)*m3(10)+m1(11)*m3(31)+m1(15)*m3(11)+m1(12)*m3(32)+m1(16)*m3(12);
    C(6) = m1(11)*m3(15)+m1(1)*m3(21)+m1(9)*m3(13)+m1(2)*m3(22)+m1(10)*m3(14)+m1(3)*m3(23)+m1(4)*m3(24)+m1(12)*m3(16);
    C(47) = m2(1)*m3(5)+m2(5)*m3(1)+m2(2)*m3(6)+m2(6)*m3(2)+m2(3)*m3(7)+m2(7)*m3(3)+m2(4)*m3(8)+m2(8)*m3(4);
    C(35) = m2(1)*m3(9)+m2(9)*m3(1)+m2(2)*m3(10)+m2(10)*m3(2)+m2(3)*m3(11)+m2(11)*m3(3)+m2(4)*m3(12)+m2(12)*m3(4);
    C(15) = m2(1)*m3(17)+m2(5)*m3(13)+m2(2)*m3(18)+m2(6)*m3(14)+m2(3)*m3(19)+m2(7)*m3(15)+m2(4)*m3(20)+m2(8)*m3(16);
    C(7) = m2(1)*m3(21)+m2(9)*m3(13)+m2(2)*m3(22)+m2(10)*m3(14)+m2(3)*m3(23)+m2(11)*m3(15)+m2(4)*m3(24)+m2(12)*m3(16);
    C(31) = m2(1)*m3(25)+m2(13)*m3(13)+m2(2)*m3(26)+m2(14)*m3(14)+m2(3)*m3(27)+m2(15)*m3(15)+m2(4)*m3(28)+m2(16)*m3(16);
    C(63) = m2(1)*m3(29)+m2(13)*m3(1)+m2(2)*m3(30)+m2(14)*m3(2)+m2(3)*m3(31)+m2(15)*m3(3)+m2(4)*m3(32)+m2(16)*m3(4);
    C(55) = m2(5)*m3(9)+m2(9)*m3(5)+m2(6)*m3(10)+m2(10)*m3(6)+m2(7)*m3(11)+m2(11)*m3(7)+m2(8)*m3(12)+m2(12)*m3(8);
    C(19) = m2(5)*m3(21)+m2(9)*m3(17)+m2(6)*m3(22)+m2(10)*m3(18)+m2(7)*m3(23)+m2(11)*m3(19)+m2(8)*m3(24)+m2(12)*m3(20);
    C(51) = m2(5)*m3(25)+m2(13)*m3(17)+m2(6)*m3(26)+m2(14)*m3(18)+m2(7)*m3(27)+m2(15)*m3(19)+m2(8)*m3(28)+m2(16)*m3(20);
    C(75) = m2(5)*m3(29)+m2(13)*m3(5)+m2(6)*m3(30)+m2(14)*m3(6)+m2(7)*m3(31)+m2(15)*m3(7)+m2(8)*m3(32)+m2(16)*m3(8);
    C(39) = m2(9)*m3(25)+m2(13)*m3(21)+m2(10)*m3(26)+m2(14)*m3(22)+m2(11)*m3(27)+m2(15)*m3(23)+m2(12)*m3(28)+m2(16)*m3(24);
    C(71) = m2(9)*m3(29)+m2(13)*m3(9)+m2(10)*m3(30)+m2(14)*m3(10)+m2(11)*m3(31)+m2(15)*m3(11)+m2(12)*m3(32)+m2(16)*m3(12);

    C = C./repmat(sqrt(sum(C.^2,2)),1,size(C,2));

end