% Input: coefficient matrix C of size 11x56
% Output: solution matrix S of size 4x22

function S = red_34x56_relpose_7p_fr_1s(C)

    M = sparse([1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,19,19,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34],[24,32,33,34,55,56,21,28,29,31,49,52,22,50,53,54,55,56,23,24,30,33,51,55,17,42,47,48,50,54,20,23,27,30,44,51,15,16,21,25,28,45,16,41,45,46,49,52,12,13,18,19,20,23,5,6,14,15,25,37,1,2,9,10,12,18,19,22,43,50,51,55,13,19,36,43,44,51,7,8,38,39,41,46,11,17,35,42,43,50,18,19,22,23,24,26,3,4,11,35,36,43,10,11,17,19,22,40,2,3,10,11,13,19,6,7,16,37,38,45,9,10,11,17,18,19,22,23,24,26,30,32,33,34,35,40,42,43,47,48,50,51,53,54,55,56,1,2,3,4,10,11,12,13,17,18,19,20,22,23,24,27,30,33,35,36,42,43,44,50,51,55,1,2,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,27,28,29,30,31,33,34,35,36,37,38,39,41,42,43,44,45,46,48,49,50,51,52,54,55,56,1,2,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,27,28,29,30,31,33,34,35,36,37,38,39,41,42,43,44,45,46,48,49,50,51,52,54,55,56,9,10,11,14,17,18,19,22,23,24,26,28,30,32,33,34,35,38,40,42,43,47,48,50,51,53,54,55,56,1,2,3,4,5,7,10,11,12,13,17,18,19,20,21,22,23,24,27,30,33,35,36,42,43,44,50,51,55,1,2,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,27,29,30,31,33,34,35,36,37,38,39,41,42,43,44,45,46,48,49,50,51,52,54,55,56,1,2,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,27,29,30,31,33,34,35,36,37,38,39,41,42,43,44,45,46,48,49,50,51,52,54,55,56,9,10,11,17,18,19,22,23,24,26,30,32,33,34,35,37,39,40,42,43,47,48,50,51,52,53,54,55,56,1,2,3,4,6,8,10,11,12,13,17,18,19,20,22,23,24,27,30,33,35,36,42,43,44,49,50,51,55,1,2,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,27,28,29,30,31,33,34,35,36,37,39,41,42,43,44,45,46,48,49,50,51,52,54,55,56,1,2,3,4,5,6,7,8,10,11,12,13,15,16,17,18,19,20,21,22,23,24,25,27,28,29,30,31,33,34,35,36,37,39,41,42,43,44,45,46,48,49,50,51,52,54,55,56,9,10,11,17,18,19,22,23,24,25,26,30,31,32,33,34,35,40,42,43,46,47,48,50,51,53,54,55,56,1,2,3,4,10,11,12,13,15,17,18,19,20,22,23,24,27,29,30,33,35,36,41,42,43,44,50,51,55],C([529,573,595,606,540,584,529,573,595,606,540,584,529,540,573,584,595,606,529,573,595,606,540,584,529,540,573,584,595,606,529,573,595,606,540,584,529,540,595,573,606,584,529,540,573,584,595,606,529,540,573,584,595,606,529,540,573,595,606,584,529,540,573,584,595,606,529,573,540,584,595,606,529,573,540,584,595,606,529,540,573,584,595,606,529,573,540,584,595,606,529,540,584,595,606,573,529,540,573,584,595,606,529,540,584,595,606,573,529,540,573,584,595,606,529,540,595,573,584,606,90,101,112,255,277,288,420,442,530,398,552,574,596,607,123,233,266,299,365,376,431,453,497,508,541,585,90,101,112,123,233,255,277,288,365,398,420,442,497,530,574,552,596,607,266,299,376,431,453,508,541,585,3,14,25,36,47,58,69,80,102,113,135,146,212,223,256,278,289,311,388,421,443,531,333,465,476,520,553,564,597,608,124,157,179,190,201,245,267,300,322,344,355,377,410,432,454,487,509,542,586,4,15,26,37,48,59,70,81,103,114,136,147,213,224,257,279,290,312,389,422,444,532,334,466,477,521,554,565,598,609,125,158,180,191,202,246,268,301,323,345,356,378,411,433,455,488,510,543,587,93,104,115,170,258,280,291,423,445,533,401,478,555,577,599,610,126,192,236,269,302,368,379,434,456,500,511,544,588,93,104,115,126,170,192,236,258,280,291,368,401,423,445,478,500,533,577,555,599,610,269,302,379,434,456,511,544,588,6,17,28,39,50,61,72,83,105,116,138,149,215,226,259,281,292,314,391,424,446,534,336,468,523,556,567,600,611,127,160,182,193,204,248,270,303,325,347,358,380,413,435,457,490,512,545,589,7,18,29,40,51,62,73,84,106,117,139,150,216,227,260,282,293,315,392,425,447,535,337,469,524,557,568,601,612,128,161,183,194,205,249,271,304,326,348,359,381,414,436,458,491,513,546,590,96,107,118,261,283,294,426,448,536,404,558,580,602,613,129,184,206,239,272,305,371,382,437,459,492,503,514,547,591,96,107,118,129,184,206,239,261,283,294,371,404,426,448,503,536,580,558,602,613,272,305,382,437,459,492,514,547,591,9,20,31,42,53,64,75,86,108,119,141,152,218,229,262,284,295,317,394,427,449,537,339,471,482,526,559,570,603,614,130,163,185,207,251,273,306,328,350,361,383,416,438,460,493,515,548,592,10,21,32,43,54,65,76,87,109,120,142,153,219,230,263,285,296,318,395,428,450,538,340,472,483,527,560,571,604,615,131,164,186,208,252,274,307,329,351,362,384,417,439,461,494,516,549,593,99,110,121,264,286,297,429,451,539,341,407,561,572,583,605,616,132,242,275,308,363,374,385,440,462,506,517,550,594,99,110,121,132,242,264,286,297,341,374,407,429,451,506,539,583,561,572,605,616,275,308,363,385,440,462,517,550,594]),34,56);

    [L,~,P] = lu(M(:,1:24));
    P = P';
    M = [P*L P(:,25:end)]\M(:,25:end);
    M = M(end-9:end,:);

    T0 = zeros(22);
    T0([3,6,10,11,15,17,18,19,21,22],:) = -M(:,11:end);
    T0([177,200,224,247,315,338,361,386,409,432,456,482]) = 1;
    T1 = zeros(22);
    T1([3,6,10,11,15,17,18,19,21,22],[3,6,10,11,15,17,18,19,21,22]) = M(:,1:10);
    T1([1,24,70,93,139,162,185,254,277,300,346,438]) = 1;

    [V,~] = eig(T0,T1);
    S = V(18:21,:)./repmat(V(22,:),4,1);

    I = ~any(isnan(S)) & ~any(isinf(S));
    %I = I & ~any(imag(S)); % uncomment this line for real roots only
    S = S(:,I);

end