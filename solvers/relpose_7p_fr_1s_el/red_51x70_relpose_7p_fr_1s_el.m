% Input: coefficient matrix C of size 14x70
% Output: solution matrix S of size 4x19

function S = red_51x70_relpose_7p_fr_1s_el(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51];
    jx = [7,8,9,11,12,14,21,22,24,34,35,37,46,53,60,10,11,12,13,14,15,23,24,25,36,37,38,47,54,61,17,18,19,21,22,24,27,28,40,41,53,56,60,63,67,20,21,22,23,24,25,52,53,54,57,59,60,61,64,68,26,27,28,52,53,54,55,56,57,58,62,63,64,65,69,30,31,32,34,35,37,40,41,43,44,46,49,60,63,67,33,34,35,36,37,38,45,46,47,50,59,60,61,64,68,39,40,41,59,60,61,62,63,64,65,66,67,68,69,70,42,43,44,45,46,47,48,49,50,51,66,67,68,69,70,3,4,5,8,9,12,18,19,22,28,31,32,35,41,44,7,8,9,11,12,14,21,22,24,34,35,37,46,53,60,10,11,12,13,14,15,23,24,25,36,37,38,47,54,61,17,18,19,21,22,24,27,28,40,41,53,56,60,63,67,20,21,22,23,24,25,52,53,54,57,59,60,61,64,68,26,27,28,52,53,54,55,56,57,58,62,63,64,65,69,30,31,32,34,35,37,40,41,43,44,46,49,60,63,67,33,34,35,36,37,38,45,46,47,50,59,60,61,64,68,39,40,41,59,60,61,62,63,64,65,66,67,68,69,70,42,43,44,45,46,47,48,49,50,51,66,67,68,69,70,3,4,5,8,9,12,18,19,22,28,31,32,35,41,44,6,7,8,10,11,13,20,21,23,33,34,36,45,52,59,7,8,9,11,12,14,21,22,24,34,35,37,46,53,60,10,11,12,13,14,15,23,24,25,36,37,38,47,54,61,16,17,18,20,21,23,26,27,39,40,52,55,59,62,66,17,18,19,21,22,24,27,28,40,41,53,56,60,63,67,20,21,22,23,24,25,52,53,54,57,59,60,61,64,68,26,27,28,52,53,54,55,56,57,58,62,63,64,65,69,29,30,31,33,34,36,39,40,42,43,45,48,59,62,66,30,31,32,34,35,37,40,41,43,44,46,49,60,63,67,33,34,35,36,37,38,45,46,47,50,59,60,61,64,68,39,40,41,59,60,61,62,63,64,65,66,67,68,69,70,42,43,44,45,46,47,48,49,50,51,66,67,68,69,70,1,2,3,4,6,7,8,10,11,13,16,17,18,20,21,23,26,27,29,30,31,33,34,36,39,40,42,43,45,48,52,55,59,62,66,2,3,4,5,7,8,9,11,12,14,17,18,19,21,22,24,27,28,30,31,32,34,35,37,40,41,43,44,46,49,53,56,60,63,67,6,7,8,9,10,11,12,13,14,15,20,21,22,23,24,25,33,34,35,36,37,38,45,46,47,50,52,53,54,57,59,60,61,64,68,16,17,18,19,20,21,22,23,24,25,26,27,28,39,40,41,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,6,7,8,10,11,13,16,17,18,20,21,23,26,27,29,30,31,33,34,36,39,40,42,43,45,48,52,55,59,62,66,2,3,4,5,7,8,9,11,12,14,17,18,19,21,22,24,27,28,30,31,32,34,35,37,40,41,43,44,46,49,53,56,60,63,67,6,7,8,9,10,11,12,13,14,15,20,21,22,23,24,25,33,34,35,36,37,38,45,46,47,50,52,53,54,57,59,60,61,64,68,16,17,18,19,20,21,22,23,24,25,26,27,28,39,40,41,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70];
    kx = [771,785,799,813,827,841,855,869,883,911,925,939,967,897,953,771,785,799,813,827,841,855,869,883,911,925,939,967,897,953,771,785,799,813,827,841,855,869,911,925,883,897,939,953,967,771,785,799,813,827,841,855,869,883,897,911,925,939,953,967,771,785,799,813,827,841,855,869,883,897,911,925,939,953,967,771,785,799,813,827,841,855,869,911,925,939,967,883,897,953,771,785,799,813,827,841,911,925,939,967,855,869,883,897,953,771,785,799,813,827,841,855,869,883,897,911,925,939,953,967,771,785,799,813,827,841,911,925,939,967,855,869,883,897,953,772,786,800,814,828,842,856,870,884,898,912,926,940,954,968,772,786,800,814,828,842,856,870,884,912,926,940,968,898,954,772,786,800,814,828,842,856,870,884,912,926,940,968,898,954,772,786,800,814,828,842,856,870,912,926,884,898,940,954,968,772,786,800,814,828,842,856,870,884,898,912,926,940,954,968,772,786,800,814,828,842,856,870,884,898,912,926,940,954,968,772,786,800,814,828,842,856,870,912,926,940,968,884,898,954,772,786,800,814,828,842,912,926,940,968,856,870,884,898,954,772,786,800,814,828,842,856,870,884,898,912,926,940,954,968,772,786,800,814,828,842,912,926,940,968,856,870,884,898,954,773,787,801,815,829,843,857,871,885,899,913,927,941,955,969,773,787,801,815,829,843,857,871,885,913,927,941,969,899,955,773,787,801,815,829,843,857,871,885,913,927,941,969,899,955,773,787,801,815,829,843,857,871,885,913,927,941,969,899,955,773,787,801,815,829,843,857,871,913,927,885,899,941,955,969,773,787,801,815,829,843,857,871,913,927,885,899,941,955,969,773,787,801,815,829,843,857,871,885,899,913,927,941,955,969,773,787,801,815,829,843,857,871,885,899,913,927,941,955,969,773,787,801,815,829,843,857,871,913,927,941,969,885,899,955,773,787,801,815,829,843,857,871,913,927,941,969,885,899,955,773,787,801,815,829,843,913,927,941,969,857,871,885,899,955,773,787,801,815,829,843,857,871,885,899,913,927,941,955,969,773,787,801,815,829,843,913,927,941,969,857,871,885,899,955,494,508,522,536,550,564,578,592,606,620,634,648,662,676,690,704,718,732,774,788,802,816,830,844,858,872,914,928,942,970,746,760,886,900,956,494,508,522,536,550,564,578,592,606,620,634,648,662,676,690,704,718,732,774,788,802,816,830,844,858,872,914,928,942,970,746,760,886,900,956,494,508,522,536,550,564,578,592,606,620,634,648,662,676,690,704,774,788,802,816,830,844,914,928,942,970,718,732,746,760,858,872,886,900,956,494,508,522,536,550,564,578,592,606,620,634,648,662,774,788,802,676,690,704,718,732,746,760,816,830,844,858,872,886,900,914,928,942,956,970,494,508,522,536,550,564,578,592,606,620,634,648,662,774,788,802,816,830,844,914,928,942,970,676,690,704,718,732,746,760,858,872,886,900,956,495,509,523,537,551,565,579,593,607,621,635,649,663,677,691,705,719,733,775,789,803,817,831,845,859,873,915,929,943,971,747,761,887,901,957,495,509,523,537,551,565,579,593,607,621,635,649,663,677,691,705,719,733,775,789,803,817,831,845,859,873,915,929,943,971,747,761,887,901,957,495,509,523,537,551,565,579,593,607,621,635,649,663,677,691,705,775,789,803,817,831,845,915,929,943,971,719,733,747,761,859,873,887,901,957,495,509,523,537,551,565,579,593,607,621,635,649,663,775,789,803,677,691,705,719,733,747,761,817,831,845,859,873,887,901,915,929,943,957,971,495,509,523,537,551,565,579,593,607,621,635,649,663,775,789,803,817,831,845,915,929,943,971,677,691,705,719,733,747,761,859,873,887,901,957,6,20,34,48,62,76,90,104,118,132,146,160,174,188,202,216,230,244,258,272,286,300,314,328,342,356,370,384,496,510,524,538,552,566,580,594,608,622,636,650,664,776,790,804,818,832,846,916,930,944,972,398,412,426,440,454,468,482,678,692,706,720,734,748,762,860,874,888,902,958,7,21,35,49,63,77,91,105,119,133,147,161,175,189,203,217,231,245,259,273,287,301,315,329,343,357,371,385,497,511,525,539,553,567,581,595,609,623,637,651,665,777,791,805,819,833,847,917,931,945,973,399,413,427,441,455,469,483,679,693,707,721,735,749,763,861,875,889,903,959,8,22,36,50,64,78,92,106,120,134,148,162,176,190,204,218,232,246,260,274,288,302,316,330,344,358,372,386,498,512,526,540,554,568,582,596,610,624,638,652,666,778,792,806,820,834,848,918,932,946,974,400,414,428,442,456,470,484,680,694,708,722,736,750,764,862,876,890,904,960,9,23,37,51,65,79,93,107,121,135,149,163,177,191,205,219,233,247,261,275,289,303,317,331,345,359,373,387,499,513,527,541,555,569,583,597,611,625,639,653,667,779,793,807,821,835,849,919,933,947,975,401,415,429,443,457,471,485,681,695,709,723,737,751,765,863,877,891,905,961,10,24,38,52,66,80,94,108,122,136,150,164,178,192,206,220,234,248,262,276,290,304,318,332,346,360,374,388,500,514,528,542,556,570,584,598,612,626,640,654,668,780,794,808,822,836,850,920,934,948,976,402,416,430,444,458,472,486,682,696,710,724,738,752,766,864,878,892,906,962,11,25,39,53,67,81,95,109,123,137,151,165,179,193,207,221,235,249,263,277,291,305,319,333,347,361,375,389,501,515,529,543,557,571,585,599,613,627,641,655,669,781,795,809,823,837,851,921,935,949,977,403,417,431,445,459,473,487,683,697,711,725,739,753,767,865,879,893,907,963,12,26,40,54,68,82,96,110,124,138,152,166,180,194,208,222,236,250,264,278,292,306,320,334,348,362,376,390,502,516,530,544,558,572,586,600,614,628,642,656,670,782,796,810,824,838,852,922,936,950,978,404,418,432,446,460,474,488,684,698,712,726,740,754,768,866,880,894,908,964,13,27,41,55,69,83,97,111,125,139,153,167,181,195,209,223,237,251,265,279,293,307,321,335,349,363,377,391,503,517,531,545,559,573,587,601,615,629,643,657,671,783,797,811,825,839,853,923,937,951,979,405,419,433,447,461,475,489,685,699,713,727,741,755,769,867,881,895,909,965,14,28,42,56,70,84,98,112,126,140,154,168,182,196,210,224,238,252,266,280,294,308,322,336,350,364,378,392,504,518,532,546,560,574,588,602,616,630,644,658,672,784,798,812,826,840,854,924,938,952,980,406,420,434,448,462,476,490,686,700,714,728,742,756,770,868,882,896,910,966];
    M = sparse(ix,jx,C(kx),51,70);

    [L,~,P] = lu(M(:,1:44));
    P = P';
    M = [P*L P(:,45:end)]\M(:,45:end);
    M = M(end-6:end,:);

    T = zeros(19);
    T([8,9,10,15,16,17,19],:) = -M(:,1:7)\M(:,8:end);
    T([134,154,174,194,214,234,254,277,297,317,337,360]) = 1;

    [V,~] = eig(T);
    S = V(15:18,:)./repmat(V(19,:),4,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end