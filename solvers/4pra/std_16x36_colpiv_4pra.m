% Input: coefficient matrix C of size 5x35

function S = std_16x36_colpiv_4pra(C)

    i_dx = [1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,12,12,12,12,13,13,13,13,14,14,14,14,15,15,15,15,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36];
    j_dx = [7,26,28,41,1,8,27,42,5,10,29,45,13,35,37,48,2,9,28,43,4,21,30,46,14,32,36,49,7,9,17,31,16,34,38,51,17,41,43,53,1,3,22,44,5,6,23,47,11,15,37,50,8,18,22,24,12,33,39,52,18,42,44,54,10,19,23,25,13,15,20,40,19,45,47,55,20,48,50,56,1,2,4,5,7,8,9,10,13,14,16,17,21,26,27,28,29,30,31,32,33,34,35,36,37,38,41,42,43,45,46,48,49,51,53,1,2,3,4,5,6,8,9,11,12,14,15,18,21,22,23,24,27,28,30,32,33,34,36,37,39,42,43,44,46,47,49,50,52,54,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,29,30,31,33,34,38,39,40,45,46,47,51,52,55,11,12,13,14,15,16,17,18,19,20,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,1,2,4,5,7,8,9,10,13,14,16,17,21,26,27,28,29,30,31,32,33,34,35,36,37,38,41,42,43,45,46,48,49,51,53,1,2,3,4,5,6,8,9,11,12,14,15,18,21,22,23,24,27,28,30,32,33,34,36,37,39,42,43,44,46,47,49,50,52,54,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,29,30,31,33,34,38,39,40,45,46,47,51,52,55,11,12,13,14,15,16,17,18,19,20,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,1,2,4,5,7,8,9,10,13,14,16,17,21,26,27,28,29,30,31,32,33,34,35,36,37,38,41,42,43,45,46,48,49,51,53,1,2,3,4,5,6,8,9,11,12,14,15,18,21,22,23,24,27,28,30,32,33,34,36,37,39,42,43,44,46,47,49,50,52,54,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,29,30,31,33,34,38,39,40,45,46,47,51,52,55,11,12,13,14,15,16,17,18,19,20,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,1,2,4,5,7,8,9,10,13,14,16,17,21,26,27,28,29,30,31,32,33,34,35,36,37,38,41,42,43,45,46,48,49,51,53,1,2,3,4,5,6,8,9,11,12,14,15,18,21,22,23,24,27,28,30,32,33,34,36,37,39,42,43,44,46,47,49,50,52,54,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,29,30,31,33,34,38,39,40,45,46,47,51,52,55,11,12,13,14,15,16,17,18,19,20,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56];
    C_dx = [155,130,140,175,140,155,130,175,140,155,130,175,155,130,140,175,140,155,130,175,130,140,155,175,155,140,130,175,130,140,175,155,155,140,130,175,155,130,140,175,130,140,155,175,130,140,155,175,140,155,130,175,130,175,140,155,140,130,155,175,155,130,140,175,130,175,140,155,130,140,175,155,155,130,140,175,155,130,140,175,16,21,31,36,46,51,56,61,111,116,121,151,41,1,6,11,26,66,71,91,101,106,76,81,86,96,126,131,136,141,146,156,161,166,171,11,16,21,26,31,41,46,51,91,106,111,116,151,36,56,66,71,1,6,61,86,96,101,76,81,121,126,131,136,141,146,156,161,166,171,6,11,21,26,31,36,46,91,96,101,106,111,141,146,151,166,16,41,56,66,71,1,51,61,81,86,76,116,121,126,131,136,156,161,171,21,41,46,51,56,61,111,116,121,151,16,31,36,1,6,11,26,66,71,76,81,86,91,96,101,106,126,131,136,141,146,156,161,166,171,17,22,32,37,47,52,57,62,112,117,122,152,42,2,7,12,27,67,72,92,102,107,77,82,87,97,127,132,137,142,147,157,162,167,172,12,17,22,27,32,42,47,52,92,107,112,117,152,37,57,67,72,2,7,62,87,97,102,77,82,122,127,132,137,142,147,157,162,167,172,7,12,22,27,32,37,47,92,97,102,107,112,142,147,152,167,17,42,57,67,72,2,52,62,82,87,77,117,122,127,132,137,157,162,172,22,42,47,52,57,62,112,117,122,152,17,32,37,2,7,12,27,67,72,77,82,87,92,97,102,107,127,132,137,142,147,157,162,167,172,18,23,33,38,48,53,58,63,113,118,123,153,43,3,8,13,28,68,73,93,103,108,78,83,88,98,128,133,138,143,148,158,163,168,173,13,18,23,28,33,43,48,53,93,108,113,118,153,38,58,68,73,3,8,63,88,98,103,78,83,123,128,133,138,143,148,158,163,168,173,8,13,23,28,33,38,48,93,98,103,108,113,143,148,153,168,18,43,58,68,73,3,53,63,83,88,78,118,123,128,133,138,158,163,173,23,43,48,53,58,63,113,118,123,153,18,33,38,3,8,13,28,68,73,78,83,88,93,98,103,108,128,133,138,143,148,158,163,168,173,19,24,34,39,49,54,59,64,114,119,124,154,44,4,9,14,29,69,74,94,104,109,79,84,89,99,129,134,139,144,149,159,164,169,174,14,19,24,29,34,44,49,54,94,109,114,119,154,39,59,69,74,4,9,64,89,99,104,79,84,124,129,134,139,144,149,159,164,169,174,9,14,24,29,34,39,49,94,99,104,109,114,144,149,154,169,19,44,59,69,74,4,54,64,84,89,79,119,124,129,134,139,159,164,174,24,44,49,54,59,64,114,119,124,154,19,34,39,4,9,14,29,69,74,79,84,89,94,99,104,109,129,134,139,144,149,159,164,169,174];
    M = sparse(i_dx,j_dx,C(C_dx),36,56);

    M = full(M(21:end,21:end)-(M(21:end,1:20)/M(1:20,1:20))*M(1:20,21:end)); % Schur complement reduction

    [L,~,Pi] = lu(M(:,1:5));
    Pi = Pi';
    M = [Pi*L Pi(:,6:end)]\M(:,6:end);
    M = M(6:end,:);

    [L,UR,Pi] = lu(M(:,1:9));
    Pi = Pi';
    M = [Pi*L Pi(:,10:end)]\M(:,10:end);
    MP = M(1:9,:);
    NP = M(10:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-4));
    A = UR\[MP(:,1:end-4)*Pi MP(:,end-3:end)];
    B = U(:,1:2)\[U(:,3:end) Q'*NP(:,end-3:end)];
    M = [-A(:,end-19:end)+A(:,1:end-20)*B; -B];

    xP = [23,24,25,26,27,28,1,2,3,29,4,30,31,7,8,9,11,12,14,15,17,19];
    P1 = [(1:18)*Pi 19:22];
    T = getT(M,[23:31 P1(1:end-20)],P1(end-19:end),xP);

    [V,~] = eig(T);
    S = V(17:19,:)./repmat(V(20,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end