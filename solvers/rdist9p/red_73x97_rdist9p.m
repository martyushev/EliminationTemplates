% Input: coefficient matrix C of size 4x52
% Output: solution matrix S of size 4x24

function S = red_73x97_rdist9p(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73];
    jx = [3,5,10,11,13,18,20,28,29,33,56,60,4,6,12,13,14,19,21,34,55,56,57,62,7,10,22,25,28,37,38,41,44,51,8,11,26,29,38,39,42,45,52,9,12,23,27,40,41,55,59,74,78,10,13,28,41,42,56,60,75,79,12,14,55,57,62,74,75,76,81,16,18,25,26,28,31,33,44,45,47,60,66,17,19,27,28,32,34,48,55,59,60,62,68,18,20,28,29,33,35,49,56,60,61,63,69,19,21,34,55,56,57,58,62,63,64,77,84,24,27,36,37,40,43,50,51,59,65,78,85,25,28,37,38,41,44,51,52,60,66,79,86,26,29,38,39,42,45,52,53,61,67,80,87,27,40,41,55,59,62,68,74,78,79,81,88,28,41,42,56,60,63,69,75,79,80,82,89,55,57,62,74,75,76,77,81,82,83,84,90,30,32,43,44,46,48,54,59,65,66,68,72,31,33,44,45,47,49,60,66,67,69,70,91,32,34,48,59,60,62,64,68,69,71,84,92,43,50,51,59,65,68,72,78,85,86,88,93,44,51,52,60,66,69,79,86,87,89,91,94,59,62,68,78,79,81,84,88,89,90,92,95,46,48,54,65,66,68,71,72,73,91,92,96,65,68,72,85,86,88,92,93,94,95,96,97,1,3,7,8,10,16,18,25,26,28,31,44,2,4,9,10,12,17,19,27,28,32,55,59,3,5,10,11,13,18,20,28,29,33,56,60,4,6,12,13,14,19,21,34,55,56,57,62,7,10,22,25,28,37,38,41,44,51,8,11,26,29,38,39,42,45,52,9,12,23,27,40,41,55,59,74,78,10,13,28,41,42,56,60,75,79,12,14,55,57,62,74,75,76,81,15,17,24,25,27,30,32,43,44,46,59,65,16,18,25,26,28,31,33,44,45,47,60,66,17,19,27,28,32,34,48,55,59,60,62,68,18,20,28,29,33,35,49,56,60,61,63,69,19,21,34,55,56,57,58,62,63,64,77,84,24,27,36,37,40,43,50,51,59,65,78,85,25,28,37,38,41,44,51,52,60,66,79,86,26,29,38,39,42,45,52,53,61,67,80,87,27,40,41,55,59,62,68,74,78,79,81,88,28,41,42,56,60,63,69,75,79,80,82,89,55,57,62,74,75,76,77,81,82,83,84,90,30,32,43,44,46,48,54,59,65,66,68,72,31,33,44,45,47,49,60,66,67,69,70,91,32,34,48,59,60,62,64,68,69,71,84,92,43,50,51,59,65,68,72,78,85,86,88,93,44,51,52,60,66,69,79,86,87,89,91,94,59,62,68,78,79,81,84,88,89,90,92,95,46,48,54,65,66,68,71,72,73,91,92,96,65,68,72,85,86,88,92,93,94,95,96,97,25,26,28,37,38,41,44,51,27,28,40,41,55,59,74,78,28,29,41,42,56,60,75,79,55,56,57,62,74,75,76,81,34,35,58,62,63,64,77,84,43,44,50,51,59,65,78,85,44,45,51,52,60,66,79,86,59,60,62,68,78,79,81,88,60,61,63,69,79,80,82,89,62,63,77,81,82,83,84,90,46,47,48,54,65,66,68,72,48,49,64,68,69,71,84,92,65,66,68,72,85,86,88,93,66,67,69,86,87,89,91,94,68,69,84,88,89,90,92,95,54,70,71,72,73,91,92,96,72,91,92,93,94,95,96,97,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,22,23,24,25,26,27,28,30,31,32,36,37,38,40,41,43,44,46,50,51,55,59,65,74,78,85,16,17,18,19,20,21,25,26,27,28,29,30,31,32,33,34,37,38,39,40,41,42,43,44,45,46,47,48,50,51,52,54,55,56,57,59,60,62,65,66,68,72,74,75,76,78,79,81,85,86,88,93,31,32,33,34,35,44,45,46,47,48,49,51,52,53,54,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97];
    kx = [113,125,149,153,161,173,181,189,193,201,197,205,113,125,149,153,161,173,181,201,189,193,197,205,113,125,149,173,181,189,193,197,201,205,113,125,173,181,189,193,197,201,205,113,125,149,173,189,193,181,201,197,205,113,125,173,189,193,181,201,197,205,113,125,173,181,201,189,193,197,205,113,125,149,153,161,173,181,189,193,201,197,205,113,125,149,153,173,181,201,161,189,193,197,205,113,125,149,153,173,181,201,161,189,193,197,205,113,125,173,149,153,161,181,189,193,201,197,205,113,125,149,153,161,173,189,193,181,201,197,205,113,125,149,153,161,173,189,193,181,201,197,205,113,125,149,153,161,173,189,193,181,201,197,205,113,149,153,125,173,181,201,161,189,193,197,205,113,149,153,125,173,181,201,161,189,193,197,205,113,125,173,149,153,161,181,189,193,197,201,205,113,125,149,153,173,181,201,161,189,193,197,205,113,125,149,153,173,181,161,189,193,197,201,205,113,125,173,149,153,161,181,189,193,201,197,205,113,149,153,125,173,181,201,161,189,193,197,205,113,149,153,125,173,181,161,189,193,197,201,205,113,125,173,149,153,161,181,189,193,197,201,205,113,125,173,149,153,161,181,189,201,193,197,205,113,125,173,149,153,161,181,189,193,197,201,205,114,126,150,154,162,174,182,190,194,198,202,206,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,162,174,182,202,190,194,198,206,114,126,150,174,182,190,194,198,202,206,114,126,174,182,190,194,198,202,206,114,126,150,174,190,194,182,202,198,206,114,126,174,190,194,182,202,198,206,114,126,174,182,202,190,194,198,206,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,162,174,182,190,194,202,198,206,114,126,150,154,174,182,202,162,190,194,198,206,114,126,150,154,174,182,202,162,190,194,198,206,114,126,174,150,154,162,182,190,194,202,198,206,114,126,150,154,162,174,190,194,182,202,198,206,114,126,150,154,162,174,190,194,182,202,198,206,114,126,150,154,162,174,190,194,182,202,198,206,114,150,154,126,174,182,202,162,190,194,198,206,114,150,154,126,174,182,202,162,190,194,198,206,114,126,174,150,154,162,182,190,194,198,202,206,114,126,150,154,174,182,202,162,190,194,198,206,114,126,150,154,174,182,162,190,194,198,202,206,114,126,174,150,154,162,182,190,194,202,198,206,114,150,154,126,174,182,202,162,190,194,198,206,114,150,154,126,174,182,162,190,194,198,202,206,114,126,174,150,154,162,182,190,194,198,202,206,114,126,174,150,154,162,182,190,202,194,198,206,114,126,174,150,154,162,182,190,194,198,202,206,175,179,183,191,195,199,203,207,175,179,191,195,183,203,199,207,175,179,191,195,183,203,199,207,175,179,183,203,191,195,199,207,175,179,183,191,195,203,199,207,175,179,191,195,183,203,199,207,175,179,191,195,183,203,199,207,175,179,183,203,191,195,199,207,175,179,183,203,191,195,199,207,175,179,183,191,195,199,203,207,175,179,183,203,191,195,199,207,175,179,183,191,195,203,199,207,175,179,183,203,191,195,199,207,175,179,183,191,195,199,203,207,175,179,183,191,195,199,203,207,175,179,183,191,203,195,199,207,175,179,183,191,195,199,203,207,4,8,12,16,20,24,28,32,36,40,44,48,52,56,60,64,68,72,76,80,92,116,120,124,128,132,140,144,148,152,156,160,164,168,176,180,188,192,196,136,184,204,172,200,208,4,8,12,16,20,24,28,32,36,40,44,60,64,68,72,76,80,84,88,92,96,100,116,120,124,140,144,148,152,156,160,188,48,52,56,128,132,136,176,180,184,204,104,108,112,164,168,172,192,196,200,208,4,8,12,16,20,28,32,60,64,68,72,80,84,88,140,24,36,40,44,48,52,76,116,120,124,128,132,144,148,176,188,56,92,96,100,104,108,112,136,152,156,160,164,168,172,180,184,192,196,200,204,208];
    M = sparse(ix,jx,C(kx),73,97);

    [L,~,P] = lu(M(:,1:54));
    P = P';
    M = [P*L P(:,55:end)]\M(:,55:end);
    M = M(end-18:end,:);

    T = zeros(24);
    T([1,2,3,4,5,6,7,8,9,11,12,13,14,15,16,18,19,20,23],:) = -M(:,1:19)\M(:,20:end);
    T([82,257,429,454,552]) = 1;

    [V,~] = eig(T);
    S = V(20:23,:)./repmat(V(24,:),4,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end