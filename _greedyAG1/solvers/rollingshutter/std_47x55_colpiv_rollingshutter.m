% Input: coefficient matrix C of size 10x21

function [x1,x2,x3,x4,x5] = std_47x55_colpiv_rollingshutter(C)

    i_dx = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47];
    j_dx = [20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51,4,5,6,7,8,9,13,14,15,18,26,27,28,29,33,41,42,43,44,48,53,10,11,12,13,14,15,16,17,18,19,30,31,32,33,34,45,46,47,48,49,54,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,38,41,45,50,1,2,3,4,5,7,10,11,13,16,21,22,24,27,31,36,37,39,42,46,51];
    C_dx = [1,11,21,31,41,51,61,71,81,91,101,111,121,131,141,151,161,171,181,191,201,21,41,51,71,81,91,111,121,131,141,1,11,31,61,101,151,161,171,181,191,201,21,41,51,71,81,91,111,121,131,141,1,11,31,61,101,151,161,171,181,191,201,21,41,51,71,81,91,111,121,131,141,1,11,31,61,101,151,161,171,181,191,201,1,11,21,31,41,51,61,71,81,91,101,111,121,131,141,151,161,171,181,191,201,2,12,22,32,42,52,62,72,82,92,102,112,122,132,142,152,162,172,182,192,202,22,42,52,72,82,92,112,122,132,142,2,12,32,62,102,152,162,172,182,192,202,22,42,52,72,82,92,112,122,132,142,2,12,32,62,102,152,162,172,182,192,202,22,42,52,72,82,92,112,122,132,142,2,12,32,62,102,152,162,172,182,192,202,2,12,22,32,42,52,62,72,82,92,102,112,122,132,142,152,162,172,182,192,202,3,13,23,33,43,53,63,73,83,93,103,113,123,133,143,153,163,173,183,193,203,23,43,53,73,83,93,113,123,133,143,3,13,33,63,103,153,163,173,183,193,203,23,43,53,73,83,93,113,123,133,143,3,13,33,63,103,153,163,173,183,193,203,23,43,53,73,83,93,113,123,133,143,3,13,33,63,103,153,163,173,183,193,203,3,13,23,33,43,53,63,73,83,93,103,113,123,133,143,153,163,173,183,193,203,4,14,24,34,44,54,64,74,84,94,104,114,124,134,144,154,164,174,184,194,204,24,44,54,74,84,94,114,124,134,144,4,14,34,64,104,154,164,174,184,194,204,24,44,54,74,84,94,114,124,134,144,4,14,34,64,104,154,164,174,184,194,204,24,44,54,74,84,94,114,124,134,144,4,14,34,64,104,154,164,174,184,194,204,4,14,24,34,44,54,64,74,84,94,104,114,124,134,144,154,164,174,184,194,204,5,15,25,35,45,55,65,75,85,95,105,115,125,135,145,155,165,175,185,195,205,25,45,55,75,85,95,115,125,135,145,5,15,35,65,105,155,165,175,185,195,205,25,45,55,75,85,95,115,125,135,145,5,15,35,65,105,155,165,175,185,195,205,25,45,55,75,85,95,115,125,135,145,5,15,35,65,105,155,165,175,185,195,205,5,15,25,35,45,55,65,75,85,95,105,115,125,135,145,155,165,175,185,195,205,6,16,26,36,46,56,66,76,86,96,106,116,126,136,146,156,166,176,186,196,206,26,46,56,76,86,96,116,126,136,146,6,16,36,66,106,156,166,176,186,196,206,26,46,56,76,86,96,116,126,136,146,6,16,36,66,106,156,166,176,186,196,206,26,46,56,76,86,96,116,126,136,146,6,16,36,66,106,156,166,176,186,196,206,6,16,26,36,46,56,66,76,86,96,106,116,126,136,146,156,166,176,186,196,206,7,17,27,37,47,57,67,77,87,97,107,117,127,137,147,157,167,177,187,197,207,27,47,57,77,87,97,117,127,137,147,7,17,37,67,107,157,167,177,187,197,207,27,47,57,77,87,97,117,127,137,147,7,17,37,67,107,157,167,177,187,197,207,27,47,57,77,87,97,117,127,137,147,7,17,37,67,107,157,167,177,187,197,207,7,17,27,37,47,57,67,77,87,97,107,117,127,137,147,157,167,177,187,197,207,8,18,28,38,48,58,68,78,88,98,108,118,128,138,148,158,168,178,188,198,208,28,48,58,78,88,98,118,128,138,148,8,18,38,68,108,158,168,178,188,198,208,28,48,58,78,88,98,118,128,138,148,8,18,38,68,108,158,168,178,188,198,208,28,48,58,78,88,98,118,128,138,148,8,18,38,68,108,158,168,178,188,198,208,8,18,28,38,48,58,68,78,88,98,108,118,128,138,148,158,168,178,188,198,208,9,19,29,39,49,59,69,79,89,99,109,119,129,139,149,159,169,179,189,199,209,29,49,59,79,89,99,119,129,139,149,9,19,39,69,109,159,169,179,189,199,209,29,49,59,79,89,99,119,129,139,149,9,19,39,69,109,159,169,179,189,199,209,29,49,59,79,89,99,119,129,139,149,9,19,39,69,109,159,169,179,189,199,209,9,19,29,39,49,59,69,79,89,99,109,119,129,139,149,159,169,179,189,199,209,10,20,30,40,50,60,70,80,90,100,110,120,130,140,150,160,170,180,190,200,210,30,50,60,80,90,100,120,130,140,150,10,20,40,70,110,160,170,180,190,200,210];
    M = sparse(i_dx,j_dx,C(C_dx),47,55);

    [L,~,Pi] = lu(M(:,1:19));
    Pi = Pi';
    M = [Pi*L Pi(:,20:end)]\M(:,20:end);
    M = full(M(20:end,:));

    [L,UR,Pi] = lu(M(:,1:15));
    Pi = Pi';
    M = [Pi*L Pi(:,16:end)]\M(:,16:end);
    MP = M(1:15,:);
    NP = M(16:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-6));
    A = UR\[MP(:,1:end-6)*Pi MP(:,end-5:end)];
    B = U(:,1:13)\[U(:,14:end) Q'*NP(:,end-5:end)];
    M = [-A(:,end-7:end)+A(:,1:end-8)*B; -B];

    xP = [22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,1,2,4,7,11,16];
    P1 = [(1:15)*Pi 16:21];
    T = getT(M,[22:36 P1(1:end-8)],P1(end-7:end),xP);

    [V,D] = eig(T);
    sol = [V([4,5,6,7],:)./repmat(V(8,:),4,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    x2 = sol(1,I);
    x3 = sol(2,I);
    x4 = sol(3,I);
    x5 = sol(4,I);
    x1 = sol(5,I);

end