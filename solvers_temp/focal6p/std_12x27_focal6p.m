% Input: coefficient matrix C of size 10x26

% Monomial vector: [g^2*u^2, u^3*g, g^2*u*v, u^2*v*g, g^2*v^2, g*u*v^2, g*v^3, u*g^2, g*u^2, u^3, v*g^2, g*v*u, v*u^2, v^2*g, v^2*u, v^3, g^2, g*u, u^2, v*g, v*u, v^2, g, u, v, 1]

function [g, u, v] = std_12x27_focal6p(C)

    i_dx = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11, 12, 12, 12, 12, 12, 12, 12, 12, 12, 12];
    j_dx = [1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 2, 3, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 1, 2, 3, 4, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 2, 3, 4, 5, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 2, 3, 6, 7, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 2, 3, 6, 7, 10, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 3, 6, 7, 9, 11, 12, 13, 14, 15, 16, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 17, 19, 20, 24, 3, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 2, 6, 7, 9, 12, 13, 14, 19, 20, 24, 3, 15, 16, 18, 21, 22, 23, 25, 26, 27];
    C_dx = [41, 61, 151, 21, 51, 31, 11, 101, 71, 131, 111, 81, 141, 121, 161, 91, 191, 171, 211, 201, 181, 221, 241, 231, 251, 62, 152, 22, 2, 52, 32, 12, 102, 72, 132, 112, 82, 142, 122, 162, 92, 192, 172, 212, 202, 182, 222, 242, 232, 252, 63, 153, 53, 33, 13, 103, 73, 133, 113, 83, 143, 123, 163, 93, 193, 173, 213, 203, 183, 223, 243, 233, 253, 44, 64, 154, 24, 54, 34, 14, 104, 74, 134, 114, 84, 144, 124, 164, 94, 194, 174, 214, 204, 184, 224, 244, 234, 254, 65, 155, 25, 5, 55, 35, 15, 105, 75, 135, 115, 85, 145, 125, 165, 95, 195, 175, 215, 205, 185, 225, 245, 235, 255, 66, 156, 56, 36, 16, 106, 76, 136, 116, 86, 146, 126, 166, 96, 196, 176, 216, 206, 186, 226, 246, 236, 256, 67, 157, 57, 37, 107, 137, 117, 87, 147, 127, 97, 197, 177, 217, 207, 187, 227, 247, 237, 158, 58, 38, 18, 78, 138, 118, 88, 148, 128, 98, 198, 178, 218, 208, 188, 228, 248, 238, 139, 159, 119, 89, 149, 129, 169, 99, 199, 179, 219, 209, 189, 229, 249, 239, 259, 159, 139, 119, 89, 149, 129, 169, 99, 199, 179, 219, 209, 189, 229, 249, 239, 259, 160, 150, 130, 100, 220, 210, 190, 250, 240, 260, 160, 150, 130, 100, 220, 210, 190, 250, 240, 260];
    M = sparse(i_dx,j_dx,C(C_dx),12,27);

    [L,~,Pi] = lu(M(:,1:3));
    Pi = Pi';
    M = [Pi*L Pi(:,4:end)]\M(:,4:end);
    M = M(end-8:end,:);

    T = zeros(15);
    T(1:9,:) = -M(:,1:9)\M(:,10:end);
    T([10, 26, 72, 103, 119, 180]) = 1;

    [V,D] = eig(T);
    sol = [V([14, 13],:)./repmat(V(15,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))) & not(imag(sol(1,:))));
    u = sol(1,I);
    v = sol(2,I);
    g = sol(3,I);

end