% Input: coefficient matrix C of size 10x26

% Monomial vector: [g^2*u^2, g*u^3, g^2*u*v, g*u^2*v, g^2*v^2, v^2*u*g, v^3*g, u*g^2, u^2*g, u^3, v*g^2, g*u*v, v*u^2, g*v^2, v^2*u, v^3, g^2, g*u, u^2, g*v, v*u, v^2, g, u, v, 1]

function [g, u, v] = nstd_11x26_focal6p(C)

    i_dx = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11];
    j_dx = [1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 3, 4, 5, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 4, 6, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 6, 8, 10, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 2, 4, 6, 8, 9, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 2, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 4, 6, 8, 12, 14, 16, 18, 19, 20, 2, 13, 15, 17, 21, 22, 23, 24, 25, 26];
    C_dx = [61, 151, 11, 21, 31, 41, 51, 71, 101, 161, 81, 91, 111, 121, 131, 141, 171, 191, 221, 181, 201, 211, 231, 241, 251, 62, 152, 2, 12, 22, 32, 52, 72, 102, 162, 82, 92, 112, 122, 132, 142, 172, 192, 222, 182, 202, 212, 232, 242, 252, 63, 153, 13, 33, 53, 73, 103, 163, 83, 93, 113, 123, 133, 143, 173, 193, 223, 183, 203, 213, 233, 243, 253, 64, 154, 14, 24, 34, 44, 54, 74, 104, 164, 84, 94, 114, 124, 134, 144, 174, 194, 224, 184, 204, 214, 234, 244, 254, 65, 155, 5, 15, 25, 35, 55, 75, 105, 165, 85, 95, 115, 125, 135, 145, 175, 195, 225, 185, 205, 215, 235, 245, 255, 66, 156, 16, 36, 56, 76, 106, 166, 86, 96, 116, 126, 136, 146, 176, 196, 226, 186, 206, 216, 236, 246, 256, 67, 157, 37, 57, 107, 87, 97, 117, 127, 137, 147, 177, 197, 227, 187, 207, 217, 237, 247, 158, 18, 38, 58, 78, 88, 98, 118, 128, 138, 148, 178, 198, 228, 188, 208, 218, 238, 248, 159, 169, 89, 99, 119, 129, 139, 149, 179, 199, 229, 189, 209, 219, 239, 249, 259, 160, 100, 130, 150, 190, 210, 220, 240, 250, 260, 160, 100, 130, 150, 190, 210, 220, 240, 250, 260];
    M = sparse(i_dx,j_dx,C(C_dx),11,26);

    [L,~,Pi] = lu(M(:,1:2));
    Pi = Pi';
    M = [Pi*L Pi(:,3:end)]\M(:,3:end);
    M = M(end-8:end,:);

    T = zeros(15);
    T(1:9,:) = -M(:,1:9)\M(:,10:end);
    T([10, 41, 72, 103, 119, 135]) = 1;

    [V,D] = eig(T);
    sol = [V([13, 14],:)./repmat(V(15,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))) & not(imag(sol(1,:))));
    u = sol(1,I);
    v = sol(2,I);
    g = sol(3,I);

end