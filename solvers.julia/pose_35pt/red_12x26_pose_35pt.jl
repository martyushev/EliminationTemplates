# Input: coefficient matrix C of size 4x25
# Output: solution matrix S of size 2x14

function red_12x26_pose_35pt(C::Array{Float64})

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],[3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,1,3,4,5,6,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,4,5,7,8,9,10,11,13,14,15,16,18,19,20,22,23,25,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,1,3,4,5,6,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,4,5,7,8,9,10,11,13,14,15,16,18,19,20,22,23,25,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,1,3,4,5,6,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,4,5,7,8,9,10,11,13,14,15,16,18,19,20,22,23,25,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,1,3,4,5,6,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,4,5,7,8,9,10,11,13,14,15,16,18,19,20,22,23,25],C[[1,5,17,37,57,73,85,93,97,21,25,29,33,41,45,49,53,61,65,69,77,81,89,1,17,21,25,41,45,49,53,57,61,65,69,73,77,81,85,89,93,97,1,17,21,57,73,85,93,97,41,45,49,53,61,65,69,77,81,89,2,6,18,38,58,74,86,94,98,22,26,30,34,42,46,50,54,62,66,70,78,82,90,2,18,22,26,42,46,50,54,58,62,66,70,74,78,82,86,90,94,98,2,18,22,58,74,86,94,98,42,46,50,54,62,66,70,78,82,90,3,7,19,39,59,75,87,95,99,23,27,31,35,43,47,51,55,63,67,71,79,83,91,3,19,23,27,43,47,51,55,59,63,67,71,75,79,83,87,91,95,99,3,19,23,59,75,87,95,99,43,47,51,55,63,67,71,79,83,91,4,8,20,40,60,76,88,96,100,24,28,32,36,44,48,52,56,64,68,72,80,84,92,4,20,24,28,44,48,52,56,60,64,68,72,76,80,84,88,92,96,100,4,20,24,60,76,88,96,100,44,48,52,56,64,68,72,80,84,92]],12,26)
    M = Matrix(M)

    L,_,p = lu(M[:,1:7])
    Id = Matrix{Float64}(I,12,12)
    M = [L Id[:,8:end]][invperm(p),:]\M[:,8:end]
    M = M[end-4:end,:]

    T0 = zeros(14,14)
    T0[[4,8,11,13,14],:] = -M[:,6:end]
    T0[[71,86,101,117,132,147,163,178,194]] .= 1
    T1 = zeros(14,14)
    T1[[4,8,11,13,14],[4,8,11,13,14]] = M[:,1:5]
    T1[[1,16,31,61,76,91,121,136,166]] .= 1

    _,V = eigen(T0,T1)
    S = V[12:13,:]./repeat(V[14:14,:],2)
    S = S[:,vec(all(c -> !isinf(c) && !isnan(c), S; dims=1))]

    return S

end