# Input: coefficient matrix C of size 4x18
# Output: solution matrix S of size 4x36

function red_38x74_pose_quiver(C::Array{Float64})

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38],[13,19,23,25,27,29,33,34,50,69,72,74,12,18,22,24,26,28,32,33,48,60,70,71,11,16,19,20,23,24,29,30,45,50,66,73,3,5,6,10,18,22,28,29,43,48,55,64,15,17,19,21,22,26,27,37,42,47,61,70,2,4,5,9,16,19,24,25,41,45,51,59,14,15,16,17,18,22,23,35,40,42,48,56,1,2,3,8,14,15,18,19,39,40,43,52,13,24,29,33,35,37,65,67,73,74,5,8,11,24,29,35,51,58,63,73,19,23,27,29,33,38,50,57,72,74,18,22,26,28,32,37,48,60,70,73,16,19,23,24,29,36,45,50,53,73,3,6,18,22,28,35,43,48,51,55,15,17,21,22,26,33,42,47,50,70,2,5,16,19,24,31,41,45,46,51,14,15,17,18,22,29,40,42,45,48,11,24,29,33,35,37,67,68,73,74,5,8,9,24,29,35,51,63,65,73,19,23,27,29,33,36,50,62,72,74,18,22,26,28,32,35,48,60,70,74,16,19,23,24,29,31,45,50,57,73,3,6,8,18,22,28,43,48,55,73,15,17,21,22,26,29,42,47,70,72,2,5,7,16,19,24,41,45,51,53,14,15,17,18,22,24,40,42,48,50,1,3,5,14,15,18,39,40,43,45,12,24,29,33,35,37,67,71,73,74,5,8,10,24,29,35,51,63,64,73,19,23,27,29,33,37,50,61,72,74,13,25,30,34,36,38,57,62,68,69,16,19,23,24,29,35,45,50,56,73,15,17,21,22,26,32,42,47,54,70,11,20,25,30,31,36,53,57,65,66,2,5,8,16,19,24,41,45,51,52,14,15,17,18,22,28,40,42,48,49,4,7,9,20,25,31,46,53,58,59,1,3,6,14,15,18,39,40,43,44],C[[5,49,65,17,69,45,61,53,41,1,57,33,5,49,65,17,69,45,61,53,41,33,57,1,5,49,65,17,69,45,61,53,41,57,1,33,49,17,45,5,65,69,61,53,41,57,33,1,49,65,17,69,45,61,53,5,41,57,1,33,49,17,45,5,65,69,61,53,41,57,33,1,49,65,17,69,45,61,53,5,41,57,33,1,49,17,45,5,65,69,61,53,41,57,33,1,30,50,66,70,46,62,10,34,42,58,50,46,30,66,70,62,42,10,34,58,50,66,70,46,62,30,42,10,58,34,50,66,70,46,62,30,42,34,58,10,50,66,70,46,62,30,42,58,10,34,50,46,66,70,62,30,42,58,10,34,50,66,70,46,62,30,42,58,10,34,50,46,66,70,62,30,42,58,10,34,50,66,70,46,62,30,42,58,10,34,15,51,67,71,47,63,35,23,43,59,51,47,15,67,71,63,43,35,23,59,51,67,71,47,63,15,43,23,59,35,51,67,71,47,63,15,43,35,59,23,51,67,71,47,63,15,43,59,23,35,51,47,15,67,71,63,43,59,35,23,51,67,71,47,63,15,43,59,35,23,51,47,15,67,71,63,43,59,35,23,51,67,71,47,63,15,43,59,35,23,51,47,15,67,71,63,43,59,35,23,40,52,68,72,48,64,36,28,44,60,52,48,40,68,72,64,44,36,28,60,52,68,72,48,64,40,44,28,60,36,40,52,68,72,48,64,44,60,36,28,52,68,72,48,64,40,44,60,28,36,52,68,72,48,64,40,44,60,28,36,40,52,68,72,48,64,44,60,36,28,52,48,40,68,72,64,44,60,36,28,52,68,72,48,64,40,44,60,36,28,52,48,40,68,72,64,44,60,36,28,52,48,40,68,72,64,44,60,36,28]],38,74)
    M = Matrix(M)

    L,_,p = lu(M[:,1:13])
    Id = Matrix{Float64}(I,38,38)
    M = [L Id[:,14:end]][invperm(p),:]\M[:,14:end]
    M = M[end-24:end,:]

    T0 = zeros(36,36)
    T0[[1,2,3,4,5,7,8,9,10,12,13,15,32,34,17,35,19,20,22,36,24,25,27,29,30],:] = -M[:,26:end]
    T0[[42,119,230,304,414,525,1211,1250,676,859,1293]] .= 1
    T1 = zeros(36,36)
    T1[[1,2,3,4,5,7,8,9,10,12,13,15,32,34,17,35,19,20,22,36,24,25,27,29,30],[1,2,3,4,5,7,8,9,10,12,13,15,32,34,17,35,19,20,22,36,24,25,27,29,30]] = M[:,1:25]
    T1[[186,371,482,556,630,741,815,926,1000,1111,1185]] .= 1

    _,V = eigen(T0,T1)
    S = Matrix{Complex}(undef,4,36)
    S[[2,4],:] = V[[33,35],:]./repeat(V[36:36,:],2)
    S[[1,3],:] = repeat(V[36:36,:],2)./V[[32,34],:]
    S = S[:,vec(all(c -> !isinf(c) && !isnan(c), S; dims=1))]

    return S

end