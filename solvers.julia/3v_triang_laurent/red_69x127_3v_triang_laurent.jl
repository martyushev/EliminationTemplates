# Input: coefficient matrix C of size 3x24
# Output: solution matrix S of size 3x58

function red_69x127_3v_triang_laurent(C::Array{Float64})

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69],[7,44,45,62,68,69,75,80,81,83,90,95,96,101,102,104,123,30,35,36,48,49,68,80,95,101,102,104,109,114,115,120,121,123,1,11,53,59,60,70,73,75,84,87,88,90,95,96,114,124,125,2,14,15,44,55,61,62,71,74,75,77,89,90,94,95,97,116,3,10,12,58,64,65,78,79,86,93,94,98,99,100,101,119,124,4,11,12,13,59,65,66,80,87,95,99,101,102,120,124,125,126,5,13,60,66,67,73,79,81,88,94,96,100,102,103,121,125,126,6,61,67,68,74,79,80,82,89,94,95,97,100,101,103,104,122,10,16,22,26,27,58,86,93,94,105,106,108,111,112,113,114,124,23,28,29,46,60,73,88,94,96,107,108,110,113,115,116,125,127,17,24,29,30,47,48,61,74,89,94,95,97,108,109,113,114,116,12,27,32,33,65,99,101,106,112,114,117,118,120,121,124,126,127,13,28,33,34,66,100,102,107,113,115,118,119,121,122,125,126,127,29,34,35,67,79,94,100,101,103,108,113,114,116,119,120,122,123,33,37,39,40,51,57,58,60,63,64,66,67,118,119,121,126,127,34,38,40,41,52,58,59,61,64,65,67,68,100,113,119,120,122,19,21,22,23,25,26,28,29,37,42,43,51,57,58,60,127,22,26,27,29,31,32,34,35,40,58,64,65,67,119,1,11,50,56,57,70,72,73,84,85,87,88,92,93,94,112,125,5,13,57,63,64,73,78,79,88,93,94,98,99,100,101,118,125,21,25,26,46,57,73,88,93,94,105,107,108,111,112,113,114,125,26,31,32,64,79,94,99,100,101,108,112,113,114,117,118,120,121,2,11,14,52,58,59,71,74,75,87,89,90,95,96,113,124,125,6,12,58,64,65,74,79,80,89,94,95,99,101,102,119,124,126,7,13,59,65,66,75,80,81,90,95,96,100,102,103,120,125,126,8,60,66,67,76,79,81,82,91,94,96,97,100,101,103,104,121,9,15,44,45,61,67,68,77,80,82,83,95,97,101,102,104,122,17,22,26,27,58,74,89,94,95,106,108,109,112,114,115,124,127,18,23,28,29,47,48,60,76,91,94,96,97,108,110,113,114,116,27,32,33,65,80,95,101,102,109,114,115,118,119,121,122,126,127,28,33,34,66,81,96,100,102,103,110,113,115,116,119,120,122,123,29,34,35,47,48,49,67,82,97,101,103,104,114,116,120,121,123,33,37,39,40,54,58,60,61,64,65,67,68,102,115,119,121,122,34,38,40,41,55,59,61,62,65,66,68,69,103,116,120,122,123,20,22,23,24,26,27,29,30,37,42,43,54,58,60,61,115,24,27,29,30,32,33,35,36,40,61,65,67,68,122,11,50,56,57,72,85,87,92,93,112,124,125,13,57,63,64,78,93,98,99,100,118,125,126,44,45,62,68,69,81,83,96,102,103,104,123,1,2,11,70,71,73,74,75,94,108,113,114,3,5,10,12,13,73,78,79,118,119,126,127,4,6,11,12,13,74,79,80,100,113,119,120,5,7,13,73,75,79,80,81,101,114,120,121,6,8,74,76,79,80,81,82,102,115,121,122,7,9,75,77,80,81,82,83,103,116,122,123,16,19,21,22,46,51,86,88,105,106,107,108,17,18,20,23,24,47,54,89,91,108,109,110,21,25,26,57,93,105,107,111,112,113,125,127,26,31,32,64,99,100,112,113,117,118,119,120,30,35,36,48,49,68,102,104,115,121,122,123,10,51,57,58,73,86,88,93,94,124,125,127,11,52,58,59,74,87,89,94,95,113,124,125,53,59,60,73,75,88,90,94,95,96,114,125,54,60,61,74,76,89,91,94,95,96,97,115,15,44,55,61,62,75,77,90,95,96,97,116,12,58,64,65,79,94,99,100,101,119,124,126,13,59,65,66,80,95,100,101,102,120,125,126,60,66,67,79,81,94,96,100,101,102,103,121,61,67,68,80,82,95,97,101,102,103,104,122,22,26,27,58,94,106,108,112,113,114,124,127,23,28,29,60,94,96,108,110,113,114,115,116,24,29,30,47,48,61,95,97,109,114,115,116,27,32,33,65,101,114,118,119,120,121,126,127,28,33,34,66,100,102,113,115,119,120,121,122,29,34,35,67,101,103,114,116,120,121,122,123,33,37,39,40,58,60,64,65,66,67,119,121,34,38,40,41,59,61,65,66,67,68,120,122,22,23,26,27,28,29,37,42,43,58,60,27,29,32,33,34,35,40,65,67],C[[70,34,16,7,4,1,64,58,55,52,46,40,37,28,25,19,10,7,4,1,34,16,10,70,64,58,55,52,46,40,37,28,25,19,70,58,7,4,1,64,55,52,46,40,37,34,19,16,10,28,25,70,46,34,16,7,4,1,64,58,55,52,40,37,28,25,19,10,70,64,55,7,4,1,58,52,46,40,34,28,25,19,16,10,37,70,64,58,55,7,4,1,52,46,34,28,19,16,10,40,37,25,70,58,7,4,1,64,55,52,46,37,34,25,19,16,10,40,28,70,7,4,1,64,58,55,52,46,40,37,34,28,25,19,16,10,70,46,7,4,1,10,64,58,52,40,37,34,28,25,19,16,55,7,4,1,46,10,70,64,55,52,40,37,34,25,19,16,58,28,46,7,4,1,34,16,10,70,64,58,55,52,40,37,28,25,19,70,7,4,1,10,58,52,46,40,34,28,25,19,16,64,55,37,70,7,4,1,10,55,52,46,37,34,28,25,19,16,64,58,40,7,4,1,10,70,64,58,55,52,46,40,37,34,28,25,19,16,10,7,4,1,46,40,37,34,28,25,19,16,58,55,52,70,64,10,7,4,1,46,40,37,34,28,25,19,16,70,64,58,55,52,46,40,37,34,28,25,19,16,10,7,4,64,58,55,52,70,46,40,37,34,28,25,19,16,10,64,58,55,52,70,68,53,8,5,2,62,56,50,44,38,35,32,26,23,14,11,17,68,53,8,5,2,62,56,50,44,38,32,26,23,17,14,11,35,8,5,2,44,11,68,62,56,50,38,35,32,26,23,17,14,53,8,5,2,11,68,62,56,53,50,44,38,35,32,26,23,17,14,68,56,44,8,5,2,62,53,50,38,35,32,17,14,11,26,23,68,56,8,5,2,62,53,50,44,35,32,26,17,14,11,38,23,68,56,8,5,2,62,53,50,44,35,32,23,17,14,11,38,26,68,8,5,2,62,56,53,50,44,38,35,32,26,23,17,14,11,68,44,32,14,8,5,2,62,56,53,50,38,35,26,23,17,11,44,8,5,2,11,68,62,53,50,38,35,32,26,17,14,56,23,44,8,5,2,32,14,11,68,62,56,53,50,38,35,26,23,17,8,5,2,11,68,62,53,50,44,35,32,26,23,17,14,56,38,8,5,2,11,68,62,56,53,50,44,38,35,32,26,23,17,14,8,5,2,44,32,14,11,68,62,56,53,50,38,35,26,23,17,11,8,5,2,44,38,35,32,26,23,17,14,68,62,56,53,50,11,8,5,2,44,38,35,32,26,23,17,14,68,62,56,53,50,44,38,35,32,26,23,17,14,11,8,5,62,56,53,50,68,44,38,35,32,26,23,17,14,11,62,56,53,50,68,54,9,6,3,57,39,36,27,24,12,21,18,54,9,6,3,57,39,27,24,18,12,36,21,36,18,9,6,3,57,54,39,27,24,21,12,57,54,27,39,36,24,21,18,12,9,6,3,57,54,39,24,21,36,27,18,6,3,12,9,57,54,39,27,24,36,21,18,12,9,6,3,57,54,27,39,36,24,21,18,12,9,6,3,57,54,39,36,27,24,21,18,12,9,6,3,57,54,39,36,27,24,21,18,12,9,6,3,39,9,6,3,36,12,57,54,27,24,21,18,39,36,9,6,3,18,12,57,54,27,24,21,9,6,3,12,57,39,36,27,24,18,54,21,9,6,3,12,57,54,39,36,27,24,21,18,9,6,3,36,18,12,57,54,39,27,24,21,57,9,6,3,54,39,36,27,18,24,21,12,57,9,6,3,54,39,36,21,18,12,27,24,9,6,3,57,54,39,36,24,21,18,12,27,9,6,3,57,54,39,36,27,24,21,18,12,36,18,9,6,3,57,54,39,27,24,21,12,57,9,6,3,54,36,27,21,18,12,39,24,57,9,6,3,54,36,24,21,18,12,39,27,9,6,3,57,54,39,36,27,24,21,18,12,9,6,3,57,54,39,36,27,24,21,18,12,9,6,3,12,54,39,36,27,21,18,57,24,9,6,3,12,57,54,39,36,27,24,21,18,9,6,3,36,18,12,57,54,39,27,24,21,9,6,3,12,54,36,27,24,21,18,57,39,9,6,3,12,57,54,39,36,27,24,21,18,9,6,3,12,57,54,39,36,27,24,21,18,12,9,6,3,39,36,27,24,21,18,57,54,12,9,6,3,39,36,27,24,21,18,57,54,39,36,27,24,21,18,12,9,6,57,54,39,36,27,24,21,18,12,57,54]],69,127)
    M = Matrix(M)

    L,_,p = lu(M[:,1:43])
    Id = Matrix{Float64}(I,69,69)
    M = [L Id[:,44:end]][invperm(p),:]\M[:,44:end]
    M = M[end-25:end,:]

    T0 = zeros(58,58)
    T0[[8,14,15,22,28,35,36,37,38,39,40,41,42,43,58,44,45,46,47,48,49,50,51,52,53,54],:] = -M[:,27:end]
    T0[[1045,1162,1337,1396,1455,1514,1573,1691,1808,1867,1926,1985,2046,2105,2164,2223,2282,2341,2401,2460,2577,2636,2695,2755,2814,2931,2990,3049,3108,3361,2550,2899]] .= 1
    T1 = zeros(58,58)
    T1[[8,14,15,22,28,35,36,37,38,39,40,41,42,43,58,44,45,46,47,48,49,50,51,52,53,54],[8,14,15,22,28,35,36,37,38,39,40,41,42,43,58,44,45,46,47,48,49,50,51,52,53,54]] = M[:,1:26]
    T1[[1,60,119,178,237,296,355,473,532,591,650,709,886,945,1004,1063,1122,1181,1299,1358,1417,1476,1535,1653,1712,1771,1830,1889,1948,3187,3246,3305]] .= 1

    _,V = eigen(T0,T1)
    S = repeat(V[58:58,:],3)./V[55:57,:]
    S = S[:,vec(all(c -> !isinf(c) && !isnan(c), S; dims=1))]

    return S

end