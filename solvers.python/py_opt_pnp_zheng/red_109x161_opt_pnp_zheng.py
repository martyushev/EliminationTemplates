import numpy as np
from scipy.sparse import csr_matrix
from scipy.linalg import lu, solve, eig

# Input: coefficient matrix C of size 4x24
# Output: solution matrix S of size 4x52

def red_109x161_opt_pnp_zheng(C):
    M = csr_matrix((C.flat[[3,6,8,9,21,12,22,14,15,23,17,18,20,0,1,2,4,5,7,10,11,13,16,19,3,6,8,9,21,12,22,14,15,23,17,18,20,0,1,2,4,5,7,10,11,13,16,19,0,1,2,3,6,8,12,9,21,22,14,15,23,17,18,20,4,5,7,10,11,13,16,19,3,6,8,9,21,12,22,14,15,23,17,18,20,0,1,2,4,5,7,10,19,11,13,16,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,19,21,22,23,0,1,2,3,6,8,9,12,21,22,14,15,23,17,18,20,4,5,7,10,19,11,13,16,0,1,2,3,4,5,6,8,9,21,12,14,22,15,23,17,18,20,7,10,19,11,13,16,0,1,2,3,12,6,8,9,21,22,14,15,23,17,18,20,4,5,7,10,19,11,13,16,0,1,2,3,4,5,6,7,8,9,10,19,11,21,12,13,22,14,15,16,17,18,20,23,0,1,2,3,4,5,6,7,8,9,10,11,21,12,22,14,15,17,23,18,20,19,13,16,0,4,5,6,12,14,1,2,3,8,9,21,22,15,23,17,18,20,7,10,19,11,13,16,0,1,2,3,4,5,6,7,8,10,11,12,9,19,21,13,22,14,15,16,17,18,20,23,3,6,8,9,21,22,12,14,15,23,17,18,20,0,1,2,4,5,7,10,19,11,13,16,0,1,4,5,6,2,3,7,8,9,10,19,11,21,12,13,22,14,15,16,23,17,18,20,0,1,2,3,4,5,6,7,8,10,11,12,9,19,21,13,22,14,15,16,17,18,20,23,0,1,2,3,4,5,6,7,8,9,12,14,15,21,22,23,17,18,20,10,19,11,13,16,0,1,2,3,4,5,6,7,8,9,10,11,12,14,15,17,21,22,23,18,20,19,13,16,3,6,8,9,21,22,12,14,15,23,17,18,20,0,1,2,4,5,7,10,19,11,13,16,0,1,2,3,4,5,6,7,8,9,10,11,12,19,21,13,22,14,15,16,23,17,18,20,0,1,2,3,4,5,6,7,8,9,10,19,11,21,12,13,14,15,23,17,18,22,20,16,0,1,2,3,6,8,9,10,11,21,12,22,17,14,15,23,18,20,4,5,7,19,13,16,0,1,2,3,4,5,6,7,8,9,10,19,11,21,12,13,14,22,15,16,23,17,18,20,0,1,2,3,10,11,12,4,5,6,7,8,9,19,21,13,22,14,15,16,23,17,18,20,0,1,2,3,4,5,6,7,8,9,10,19,11,21,12,13,14,22,15,16,23,17,18,20,0,1,2,3,4,5,6,7,8,9,10,11,12,13,22,14,15,16,23,17,18,20,19,21,3,4,5,6,8,9,21,13,22,14,17,18,10,11,12,15,23,20,0,1,2,7,19,16,27,30,32,33,45,36,46,38,39,47,41,42,44,24,25,26,28,29,31,34,35,37,40,43,27,30,32,33,45,36,46,38,39,47,41,42,44,24,25,26,28,29,31,34,35,37,40,43,24,25,26,27,30,32,36,33,45,46,38,39,47,41,42,44,28,29,31,34,35,37,40,43,27,30,32,33,45,36,46,38,39,47,41,42,44,24,25,26,28,29,31,34,43,35,37,40,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,44,43,45,46,47,24,25,26,27,30,32,33,36,45,46,38,39,47,41,42,44,28,29,31,34,43,35,37,40,24,25,26,27,28,29,30,32,33,45,36,38,46,39,47,41,42,44,31,34,43,35,37,40,24,25,26,27,36,30,32,33,45,46,38,39,47,41,42,44,28,29,31,34,43,35,37,40,24,25,26,27,28,29,30,31,32,33,34,43,35,45,36,37,46,38,39,40,41,42,44,47,24,25,26,27,28,29,30,31,32,33,34,35,45,36,46,38,39,41,47,42,44,43,37,40,24,28,29,30,36,38,25,26,27,32,33,45,46,39,47,41,42,44,31,34,43,35,37,40,24,25,26,27,28,29,30,31,32,34,35,36,33,43,45,37,46,38,39,40,41,42,44,47,27,30,32,33,45,46,36,38,39,47,41,42,44,24,25,26,28,29,31,34,43,35,37,40,24,25,28,29,30,26,27,31,32,33,34,43,35,45,36,37,46,38,39,40,47,41,42,44,24,25,26,27,28,29,30,31,32,34,35,36,33,43,45,37,46,38,39,40,41,42,44,47,24,25,26,27,28,29,30,31,32,33,36,38,39,45,46,47,41,42,44,34,43,35,37,40,24,25,26,27,28,29,30,31,32,33,34,35,36,38,39,41,45,46,47,42,44,43,37,40,27,30,32,33,45,46,36,38,39,47,41,42,44,24,25,26,28,29,31,34,43,35,37,40,24,25,26,27,28,29,30,31,32,33,34,35,36,43,45,37,46,38,39,40,47,41,42,44,24,25,26,27,28,29,30,31,32,33,34,43,35,45,36,37,38,39,47,41,42,46,44,40,24,25,26,27,30,32,33,34,35,45,36,46,41,38,39,47,42,44,28,29,31,43,37,40,24,25,26,27,28,29,30,31,32,33,34,43,35,45,36,37,38,46,39,40,47,41,42,44,24,25,26,27,34,35,36,28,29,30,31,32,33,43,45,37,46,38,39,40,47,41,42,44,24,25,26,27,28,29,30,31,32,33,34,43,35,45,36,37,38,46,39,40,47,41,42,44,24,25,26,27,28,29,30,31,32,33,34,35,36,37,46,38,39,40,47,41,42,44,43,45,27,28,29,30,32,33,45,37,46,38,41,42,34,35,36,39,47,44,24,25,26,31,43,40,24,25,26,27,28,29,30,31,32,33,34,35,36,37,46,38,39,40,41,43,45,47,42,44,51,54,56,57,69,60,70,62,63,71,65,66,68,48,49,50,52,53,55,58,59,61,64,67,51,54,56,57,69,60,70,62,63,71,65,66,68,48,49,50,52,53,55,58,59,61,64,67,48,49,50,51,54,56,60,57,69,70,62,63,71,65,66,68,52,53,55,58,59,61,64,67,51,54,56,57,69,60,70,62,63,71,65,66,68,48,49,50,52,53,55,58,67,59,61,64,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,68,67,69,70,71,48,49,50,51,54,56,57,60,69,70,62,63,71,65,66,68,52,53,55,58,67,59,61,64,48,49,50,51,52,53,54,56,57,69,60,62,70,63,71,65,66,68,55,58,67,59,61,64,48,49,50,51,60,54,56,57,69,70,62,63,71,65,66,68,52,53,55,58,67,59,61,64,48,49,50,51,52,53,54,55,56,57,58,67,59,69,60,61,70,62,63,64,65,66,68,71,48,49,50,51,52,53,54,55,56,57,58,59,69,60,70,62,63,65,71,66,68,67,61,64,48,52,53,54,60,62,49,50,51,56,57,69,70,63,71,65,66,68,55,58,67,59,61,64,48,49,50,51,52,53,54,55,56,58,59,60,57,67,69,61,70,62,63,64,65,66,68,71,51,54,56,57,69,70,60,62,63,71,65,66,68,48,49,50,52,53,55,58,67,59,61,64,48,49,52,53,54,50,51,55,56,57,58,67,59,69,60,61,70,62,63,64,71,65,66,68,48,49,50,51,52,53,54,55,56,58,59,60,57,67,69,61,70,62,63,64,65,66,68,71,48,49,50,51,52,53,54,55,56,57,60,62,63,69,70,71,65,66,68,58,67,59,61,64,48,49,50,51,52,53,54,55,56,57,58,59,60,62,63,65,69,70,71,66,68,67,61,64,51,54,56,57,69,70,60,62,63,71,65,66,68,48,49,50,52,53,55,58,67,59,61,64,48,49,50,51,52,53,54,55,56,57,58,59,60,67,69,61,70,62,63,64,71,65,66,68,48,49,50,51,52,53,54,55,56,57,58,67,59,69,60,61,62,63,71,65,66,70,68,64,48,49,50,51,54,56,57,58,59,69,60,70,65,62,63,71,66,68,52,53,55,67,61,64,48,49,50,51,52,53,54,55,56,57,58,67,59,69,60,61,62,70,63,64,71,65,66,68,48,49,50,51,58,59,60,52,53,54,55,56,57,67,69,61,70,62,63,64,71,65,66,68,48,49,50,51,52,53,54,55,56,57,58,67,59,69,60,61,62,70,63,64,71,65,66,68,48,49,50,51,52,53,54,55,56,57,58,59,60,61,70,62,63,64,71,65,66,68,67,69,51,52,53,54,56,57,69,61,70,62,65,66,58,59,60,63,71,68,48,49,50,55,67,64,48,49,50,51,52,53,54,55,56,57,58,59,60,61,70,62,63,64,65,67,69,71,66,68,48,49,50,51,52,53,54,55,56,57,58,67,59,60,61,70,62,63,64,65,69,71,66,68,75,78,80,81,93,84,94,86,87,95,89,90,92,72,73,74,76,77,79,82,83,85,88,91,75,78,80,81,93,84,94,86,87,95,89,90,92,72,73,74,76,77,79,82,83,85,88,91,72,73,74,75,78,80,84,81,93,94,86,87,95,89,90,92,76,77,79,82,83,85,88,91,75,78,80,81,93,84,94,86,87,95,89,90,92,72,73,74,76,77,79,82,91,83,85,88,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,92,91,93,94,95,72,73,74,75,78,80,81,84,93,94,86,87,95,89,90,92,76,77,79,82,91,83,85,88,72,73,74,75,76,77,78,80,81,93,84,86,94,87,95,89,90,92,79,82,91,83,85,88,72,73,74,75,84,78,80,81,93,94,86,87,95,89,90,92,76,77,79,82,91,83,85,88,72,73,74,75,76,77,78,79,80,81,82,91,83,93,84,85,94,86,87,88,89,90,92,95,72,73,74,75,76,77,78,79,80,81,82,83,93,84,94,86,87,89,95,90,92,91,85,88,72,76,77,78,84,86,73,74,75,80,81,93,94,87,95,89,90,92,79,82,91,83,85,88,72,73,74,75,76,77,78,79,80,82,83,84,81,91,93,85,94,86,87,88,89,90,92,95,75,78,80,81,93,94,84,86,87,95,89,90,92,72,73,74,76,77,79,82,91,83,85,88,72,73,76,77,78,74,75,79,80,81,82,91,83,93,84,85,94,86,87,88,95,89,90,92,72,73,74,75,76,77,78,79,80,82,83,84,81,91,93,85,94,86,87,88,89,90,92,95,72,73,74,75,76,77,78,79,80,81,84,86,87,93,94,95,89,90,92,82,91,83,85,88,72,73,74,75,76,77,78,79,80,81,82,83,84,86,87,89,93,94,95,90,92,91,85,88,75,78,80,81,93,94,84,86,87,95,89,90,92,72,73,74,76,77,79,82,91,83,85,88,72,73,74,75,76,77,78,79,80,81,82,83,84,91,93,85,94,86,87,88,95,89,90,92,72,73,74,75,76,77,78,79,80,81,82,91,83,93,84,85,86,87,95,89,90,94,92,88,72,73,74,75,78,80,81,82,83,93,84,94,89,86,87,95,90,92,76,77,79,91,85,88,72,73,74,75,76,77,78,79,80,81,82,91,83,93,84,85,86,94,87,88,95,89,90,92,72,73,74,75,82,83,84,76,77,78,79,80,81,91,93,85,94,86,87,88,95,89,90,92,72,73,74,75,76,77,78,79,80,81,82,91,83,93,84,85,86,94,87,88,95,89,90,92,72,73,74,75,76,77,78,79,80,81,82,83,84,85,94,86,87,88,95,89,90,92,91,93,75,76,77,78,80,81,93,85,94,86,89,90,82,83,84,87,95,92,72,73,74,79,91,88,72,73,74,75,76,77,78,79,80,81,82,83,84,85,94,86,87,88,89,91,93,95,90,92,72,73,74,75,76,77,78,79,80,81,82,91,83,84,85,94,86,87,88,89,93,95,90,92]],([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,75,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,94,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,95,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,96,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,97,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,100,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,103,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,104,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,105,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,106,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,107,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108,108],[76,95,97,98,100,101,102,103,104,105,106,107,108,146,147,148,149,150,151,152,153,154,155,160,74,75,88,89,94,95,96,97,98,102,103,104,107,136,139,141,142,144,145,149,150,151,154,159,66,68,69,71,74,75,76,88,92,94,95,97,100,101,103,106,139,141,144,147,148,150,153,158,70,73,86,87,91,92,93,94,96,99,100,102,105,130,133,135,137,140,143,156,157,158,159,160,65,66,68,69,136,139,141,142,144,145,146,147,148,149,150,151,152,153,154,155,156,158,159,160,56,57,59,60,62,63,64,75,86,87,88,89,96,97,98,104,126,128,129,142,143,144,145,151,48,50,53,55,57,59,60,62,63,73,74,75,86,88,94,95,97,103,128,139,140,141,144,150,47,49,51,54,73,80,81,82,84,85,86,87,93,94,96,102,123,125,127,137,138,140,143,159,46,48,50,53,56,57,59,126,128,129,136,137,139,140,141,142,143,144,145,149,150,151,154,159,41,42,44,45,50,53,55,59,60,62,68,69,70,71,73,74,75,76,92,95,101,135,141,148,40,49,51,54,70,73,77,78,79,80,81,83,84,86,91,92,94,100,125,133,134,135,140,158,39,41,42,44,48,50,53,57,59,66,68,69,128,133,135,139,140,141,144,147,148,150,153,158,43,52,58,61,67,72,83,84,85,90,91,93,99,118,119,120,121,122,124,131,132,134,138,157,38,40,47,49,51,77,78,123,125,127,130,131,133,134,135,137,138,140,143,156,157,158,159,160,37,39,41,42,46,48,50,56,57,65,66,68,126,130,133,136,137,139,142,146,147,149,152,156,24,25,26,28,29,30,32,33,35,36,62,63,64,81,82,87,88,89,98,126,127,128,129,145,19,20,21,23,25,26,28,30,32,35,57,59,60,62,63,75,80,81,86,88,97,125,128,144,22,27,31,34,58,61,80,81,82,85,86,87,96,112,113,114,115,116,117,123,124,125,127,143,18,19,20,21,24,25,26,29,30,33,56,57,59,123,125,126,127,128,129,142,143,144,145,151,11,13,15,17,20,21,23,26,28,32,50,51,53,54,55,59,60,62,73,74,75,80,95,141,10,12,14,16,22,27,31,49,51,52,54,58,73,80,81,84,86,94,113,114,116,122,125,140,9,11,13,15,19,20,21,25,26,30,48,49,50,51,53,57,59,125,128,139,140,141,144,150,8,10,12,14,47,49,51,112,113,114,115,116,117,121,122,123,124,125,127,137,138,140,143,159,7,9,11,13,18,19,20,24,25,29,46,47,48,49,50,56,57,123,126,136,137,139,142,149,2,3,4,6,13,15,17,21,23,28,42,44,45,53,54,55,60,69,70,71,74,76,78,79,5,12,14,16,22,27,43,51,52,54,70,73,77,78,79,80,83,92,109,110,111,114,120,135,76,95,97,98,100,101,102,103,104,105,106,107,108,146,147,148,149,150,151,152,153,154,155,160,74,75,88,89,94,95,96,97,98,102,103,104,107,136,139,141,142,144,145,149,150,151,154,159,66,68,69,71,74,75,76,88,92,94,95,97,100,101,103,106,139,141,144,147,148,150,153,158,70,73,86,87,91,92,93,94,96,99,100,102,105,130,133,135,137,140,143,156,157,158,159,160,65,66,68,69,136,139,141,142,144,145,146,147,148,149,150,151,152,153,154,155,156,158,159,160,56,57,59,60,62,63,64,75,86,87,88,89,96,97,98,104,126,128,129,142,143,144,145,151,48,50,53,55,57,59,60,62,63,73,74,75,86,88,94,95,97,103,128,139,140,141,144,150,47,49,51,54,73,80,81,82,84,85,86,87,93,94,96,102,123,125,127,137,138,140,143,159,46,48,50,53,56,57,59,126,128,129,136,137,139,140,141,142,143,144,145,149,150,151,154,159,41,42,44,45,50,53,55,59,60,62,68,69,70,71,73,74,75,76,92,95,101,135,141,148,40,49,51,54,70,73,77,78,79,80,81,83,84,86,91,92,94,100,125,133,134,135,140,158,39,41,42,44,48,50,53,57,59,66,68,69,128,133,135,139,140,141,144,147,148,150,153,158,43,52,58,61,67,72,83,84,85,90,91,93,99,118,119,120,121,122,124,131,132,134,138,157,38,40,47,49,51,77,78,123,125,127,130,131,133,134,135,137,138,140,143,156,157,158,159,160,37,39,41,42,46,48,50,56,57,65,66,68,126,130,133,136,137,139,142,146,147,149,152,156,24,25,26,28,29,30,32,33,35,36,62,63,64,81,82,87,88,89,98,126,127,128,129,145,19,20,21,23,25,26,28,30,32,35,57,59,60,62,63,75,80,81,86,88,97,125,128,144,22,27,31,34,58,61,80,81,82,85,86,87,96,112,113,114,115,116,117,123,124,125,127,143,18,19,20,21,24,25,26,29,30,33,56,57,59,123,125,126,127,128,129,142,143,144,145,151,11,13,15,17,20,21,23,26,28,32,50,51,53,54,55,59,60,62,73,74,75,80,95,141,10,12,14,16,22,27,31,49,51,52,54,58,73,80,81,84,86,94,113,114,116,122,125,140,9,11,13,15,19,20,21,25,26,30,48,49,50,51,53,57,59,125,128,139,140,141,144,150,8,10,12,14,47,49,51,112,113,114,115,116,117,121,122,123,124,125,127,137,138,140,143,159,7,9,11,13,18,19,20,24,25,29,46,47,48,49,50,56,57,123,126,136,137,139,142,149,2,3,4,6,13,15,17,21,23,28,42,44,45,53,54,55,60,69,70,71,74,76,78,79,5,12,14,16,22,27,43,51,52,54,70,73,77,78,79,80,83,92,109,110,111,114,120,135,1,2,3,4,11,13,15,20,21,26,41,42,44,50,51,53,59,68,69,77,78,135,141,148,76,95,97,98,100,101,102,103,104,105,106,107,108,146,147,148,149,150,151,152,153,154,155,160,74,75,88,89,94,95,96,97,98,102,103,104,107,136,139,141,142,144,145,149,150,151,154,159,66,68,69,71,74,75,76,88,92,94,95,97,100,101,103,106,139,141,144,147,148,150,153,158,70,73,86,87,91,92,93,94,96,99,100,102,105,130,133,135,137,140,143,156,157,158,159,160,65,66,68,69,136,139,141,142,144,145,146,147,148,149,150,151,152,153,154,155,156,158,159,160,56,57,59,60,62,63,64,75,86,87,88,89,96,97,98,104,126,128,129,142,143,144,145,151,48,50,53,55,57,59,60,62,63,73,74,75,86,88,94,95,97,103,128,139,140,141,144,150,47,49,51,54,73,80,81,82,84,85,86,87,93,94,96,102,123,125,127,137,138,140,143,159,46,48,50,53,56,57,59,126,128,129,136,137,139,140,141,142,143,144,145,149,150,151,154,159,41,42,44,45,50,53,55,59,60,62,68,69,70,71,73,74,75,76,92,95,101,135,141,148,40,49,51,54,70,73,77,78,79,80,81,83,84,86,91,92,94,100,125,133,134,135,140,158,39,41,42,44,48,50,53,57,59,66,68,69,128,133,135,139,140,141,144,147,148,150,153,158,43,52,58,61,67,72,83,84,85,90,91,93,99,118,119,120,121,122,124,131,132,134,138,157,38,40,47,49,51,77,78,123,125,127,130,131,133,134,135,137,138,140,143,156,157,158,159,160,37,39,41,42,46,48,50,56,57,65,66,68,126,130,133,136,137,139,142,146,147,149,152,156,24,25,26,28,29,30,32,33,35,36,62,63,64,81,82,87,88,89,98,126,127,128,129,145,19,20,21,23,25,26,28,30,32,35,57,59,60,62,63,75,80,81,86,88,97,125,128,144,22,27,31,34,58,61,80,81,82,85,86,87,96,112,113,114,115,116,117,123,124,125,127,143,18,19,20,21,24,25,26,29,30,33,56,57,59,123,125,126,127,128,129,142,143,144,145,151,11,13,15,17,20,21,23,26,28,32,50,51,53,54,55,59,60,62,73,74,75,80,95,141,10,12,14,16,22,27,31,49,51,52,54,58,73,80,81,84,86,94,113,114,116,122,125,140,9,11,13,15,19,20,21,25,26,30,48,49,50,51,53,57,59,125,128,139,140,141,144,150,8,10,12,14,47,49,51,112,113,114,115,116,117,121,122,123,124,125,127,137,138,140,143,159,7,9,11,13,18,19,20,24,25,29,46,47,48,49,50,56,57,123,126,136,137,139,142,149,2,3,4,6,13,15,17,21,23,28,42,44,45,53,54,55,60,69,70,71,74,76,78,79,5,12,14,16,22,27,43,51,52,54,70,73,77,78,79,80,83,92,109,110,111,114,120,135,1,2,3,4,11,13,15,20,21,26,41,42,44,50,51,53,59,68,69,77,78,135,141,148,0,1,2,3,9,11,13,19,20,25,39,40,41,42,48,49,50,57,66,68,77,133,139,147,76,95,97,98,100,101,102,103,104,105,106,107,108,146,147,148,149,150,151,152,153,154,155,160,74,75,88,89,94,95,96,97,98,102,103,104,107,136,139,141,142,144,145,149,150,151,154,159,66,68,69,71,74,75,76,88,92,94,95,97,100,101,103,106,139,141,144,147,148,150,153,158,70,73,86,87,91,92,93,94,96,99,100,102,105,130,133,135,137,140,143,156,157,158,159,160,65,66,68,69,136,139,141,142,144,145,146,147,148,149,150,151,152,153,154,155,156,158,159,160,56,57,59,60,62,63,64,75,86,87,88,89,96,97,98,104,126,128,129,142,143,144,145,151,48,50,53,55,57,59,60,62,63,73,74,75,86,88,94,95,97,103,128,139,140,141,144,150,47,49,51,54,73,80,81,82,84,85,86,87,93,94,96,102,123,125,127,137,138,140,143,159,46,48,50,53,56,57,59,126,128,129,136,137,139,140,141,142,143,144,145,149,150,151,154,159,41,42,44,45,50,53,55,59,60,62,68,69,70,71,73,74,75,76,92,95,101,135,141,148,40,49,51,54,70,73,77,78,79,80,81,83,84,86,91,92,94,100,125,133,134,135,140,158,39,41,42,44,48,50,53,57,59,66,68,69,128,133,135,139,140,141,144,147,148,150,153,158,43,52,58,61,67,72,83,84,85,90,91,93,99,118,119,120,121,122,124,131,132,134,138,157,38,40,47,49,51,77,78,123,125,127,130,131,133,134,135,137,138,140,143,156,157,158,159,160,37,39,41,42,46,48,50,56,57,65,66,68,126,130,133,136,137,139,142,146,147,149,152,156,24,25,26,28,29,30,32,33,35,36,62,63,64,81,82,87,88,89,98,126,127,128,129,145,19,20,21,23,25,26,28,30,32,35,57,59,60,62,63,75,80,81,86,88,97,125,128,144,22,27,31,34,58,61,80,81,82,85,86,87,96,112,113,114,115,116,117,123,124,125,127,143,18,19,20,21,24,25,26,29,30,33,56,57,59,123,125,126,127,128,129,142,143,144,145,151,11,13,15,17,20,21,23,26,28,32,50,51,53,54,55,59,60,62,73,74,75,80,95,141,10,12,14,16,22,27,31,49,51,52,54,58,73,80,81,84,86,94,113,114,116,122,125,140,9,11,13,15,19,20,21,25,26,30,48,49,50,51,53,57,59,125,128,139,140,141,144,150,8,10,12,14,47,49,51,112,113,114,115,116,117,121,122,123,124,125,127,137,138,140,143,159,7,9,11,13,18,19,20,24,25,29,46,47,48,49,50,56,57,123,126,136,137,139,142,149,2,3,4,6,13,15,17,21,23,28,42,44,45,53,54,55,60,69,70,71,74,76,78,79,5,12,14,16,22,27,43,51,52,54,70,73,77,78,79,80,83,92,109,110,111,114,120,135,1,2,3,4,11,13,15,20,21,26,41,42,44,50,51,53,59,68,69,77,78,135,141,148,0,1,2,3,9,11,13,19,20,25,39,40,41,42,48,49,50,57,66,68,77,133,139,147])),shape=(109,161))
    M = M.toarray()

    P,L,_ = lu(M[:,:77])
    M = solve(np.concatenate((P@L,P[:,77:]),axis=1),M[:,77:])
    M = M[-32:,:]

    T0 = np.zeros((52,52))
    T0[[0,1,2,5,7,8,11,13,15,16,18,19,20,23,25,26,29,31,32,34,35,36,48,49,39,50,41,42,51,44,45,46],:] = -M[:,32:]
    T0.flat[[170,224,330,490,545,653,762,920,1139,1192,1297,1444,1506,1601,1758,1967,2020,2125,2282,2495]] = 1
    T1 = np.zeros((52,52))
    T1[np.ix_([0,1,2,5,7,8,11,13,15,16,18,19,20,23,25,26,29,31,32,34,35,36,48,49,39,50,41,42,51,44,45,46],[0,1,2,5,7,8,11,13,15,16,18,19,20,23,25,26,29,31,32,34,35,36,48,49,39,50,41,42,51,44,45,46])] = M[:,:32]
    T1.flat[[159,212,318,477,530,636,742,901,1113,1166,1272,1431,1484,1590,1749,1961,2014,2120,2279,2491]] = 1

    _,V = eig(T0,T1)
    S = np.zeros((4,52),dtype=np.complex_)
    S[[0,2,3],:] = V[[47,49,50],:]/np.tile(V[51,:],(3,1))
    S[1,:] = V[51,:]/V[48,:]
    S = S[:,np.all(np.isfinite(S),axis=0)]

    return S