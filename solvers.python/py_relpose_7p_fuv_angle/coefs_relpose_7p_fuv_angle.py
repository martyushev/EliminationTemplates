import numpy as np

def coefs_relpose_7p_fuv_angle(data):
    f = data[0].T.flat
    tau = data[1].T.flat

    C = np.zeros((4,22))
    C.flat[0] = -1/2*f[0]**3
    C.flat[26] = -1/2*f[4]**3
    C.flat[4] = 1/2*f[0]*f[4]**2-f[1]*f[3]*f[4]
    C.flat[1] = -f[1]*f[0]**2-f[3]*f[0]**2
    C.flat[[3,23]] = -f[1]*f[3]**2-f[3]*f[1]**2
    C.flat[5] = -f[2]*f[0]**2-f[0]**2*f[6]
    C.flat[25] = -f[3]*f[4]**2-f[1]*f[4]**2
    C.flat[18] = -f[6]*f[2]**2-f[6]**2*f[2]
    C.flat[30] = -f[7]*f[4]**2-f[5]*f[4]**2
    C.flat[41] = -f[7]*f[5]**2-f[5]*f[7]**2
    C.flat[65] = -1/2*f[8]**2*f[7]-1/2*f[8]**3
    C.flat[66] = 1/2*tau[0]**2*f[0]**2+1/2*f[0]**2
    C.flat[70] = 1/2*tau[0]**2*f[4]**2+1/2*f[4]**2
    C.flat[87] = 1/2*tau[0]**2*f[8]**2+1/2*f[8]**2
    C.flat[22] = -f[0]*f[3]*f[1]+1/2*f[0]**2*f[4]
    C.flat[21] = -f[6]*f[2]*f[8]+1/2*f[0]*f[8]**2
    C.flat[43] = -f[8]*f[5]*f[7]+1/2*f[4]*f[8]**2
    C.flat[9] = -f[0]**3-1/2*f[0]*f[1]**2-1/2*f[0]*f[3]**2
    C.flat[12] = -1/2*f[0]*f[2]**2-1/2*f[0]*f[6]**2-2*f[6]*f[2]*f[0]
    C.flat[33] = -1/2*f[1]**2*f[4]-1/2*f[3]**2*f[4]-f[4]**3
    C.flat[2] = -2*f[0]*f[3]*f[1]-1/2*f[0]*f[1]**2-1/2*f[0]*f[3]**2
    C.flat[24] = -2*f[1]*f[3]*f[4]-1/2*f[1]**2*f[4]-1/2*f[3]**2*f[4]
    C.flat[36] = -2*f[7]*f[5]*f[4]-1/2*f[5]**2*f[4]-1/2*f[4]*f[7]**2
    C.flat[48] = -f[7]*f[5]*f[4]+1/2*f[8]*f[4]**2-1/2*f[7]*f[4]**2
    C.flat[15] = -f[2]*f[3]**2-f[6]*f[1]**2-f[2]*f[0]**2-f[0]**2*f[6]
    C.flat[7] = -f[2]*f[3]**2-2*f[6]*f[3]*f[1]-2*f[1]*f[3]*f[2]-f[6]*f[1]**2
    C.flat[10] = -f[3]*f[1]**2-f[1]*f[3]**2-f[3]*f[0]**2-f[1]*f[0]**2
    C.flat[32] = -f[3]*f[4]**2-f[1]*f[4]**2-f[3]*f[1]**2-f[1]*f[3]**2
    C.flat[63] = -f[4]*f[8]**2-f[8]*f[7]**2-f[5]*f[8]**2-f[8]**2*f[7]
    C.flat[38] = -f[7]*f[4]**2-f[5]*f[4]**2-f[3]**2*f[7]-f[5]*f[1]**2
    C.flat[52] = -f[8]*f[4]**2-f[5]*f[7]**2-f[7]*f[5]**2-f[4]*f[7]**2
    C.flat[31] = -2*f[0]*f[3]*f[1]-1/2*f[1]**2*f[4]+f[0]**2*f[4]-1/2*f[3]**2*f[4]
    C.flat[6] = -f[0]*f[3]*f[6]-2*f[6]*f[1]*f[0]-2*f[0]*f[3]*f[2]-f[0]*f[2]*f[1]
    C.flat[11] = -2*f[1]*f[3]*f[4]-1/2*f[0]*f[1]**2+f[0]*f[4]**2-1/2*f[0]*f[3]**2
    C.flat[28] = -2*f[1]*f[3]*f[7]-2*f[5]*f[3]*f[1]-f[3]**2*f[7]-f[5]*f[1]**2
    C.flat[29] = -2*f[3]*f[4]*f[7]-f[3]*f[5]*f[4]-f[1]*f[4]*f[7]-2*f[1]*f[5]*f[4]
    C.flat[35] = -2*f[3]*f[5]*f[7]-2*f[5]*f[1]*f[7]-f[3]*f[7]**2-f[1]*f[5]**2
    C.flat[44] = -f[6]*f[2]*f[0]-f[6]*f[1]*f[0]+1/2*f[0]**2*f[7]+1/2*f[8]*f[0]**2
    C.flat[13] = -2*f[6]*f[3]*f[2]-f[2]**2*f[3]-2*f[6]*f[2]*f[1]-f[1]*f[6]**2
    C.flat[62] = -f[6]*f[8]*f[7]-f[1]*f[8]**2-f[2]*f[8]**2-f[6]*f[8]**2
    C.flat[67] = tau[0]**2*f[1]*f[0]+tau[0]**2*f[3]*f[0]+f[1]*f[0]+f[3]*f[0]
    C.flat[71] = tau[0]**2*f[2]*f[0]+f[2]*f[0]+f[6]*f[0]+tau[0]**2*f[6]*f[0]
    C.flat[84] = tau[0]**2*f[2]*f[8]+tau[0]**2*f[6]*f[8]+f[2]*f[8]+f[6]*f[8]
    C.flat[69] = tau[0]**2*f[3]*f[4]+tau[0]**2*f[1]*f[4]+f[3]*f[4]+f[1]*f[4]
    C.flat[74] = tau[0]**2*f[4]*f[7]+tau[0]**2*f[5]*f[4]+f[4]*f[7]+f[5]*f[4]
    C.flat[85] = tau[0]**2*f[5]*f[8]+f[5]*f[8]+f[8]*f[7]+tau[0]**2*f[8]*f[7]
    C.flat[17] = -1/2*f[0]*f[1]**2+1/2*f[0]*f[4]**2-1/2*f[0]*f[3]**2-f[1]*f[3]*f[4]-1/2*f[0]**3
    C.flat[39] = -f[0]*f[3]*f[1]-1/2*f[1]**2*f[4]+1/2*f[0]**2*f[4]-1/2*f[3]**2*f[4]-1/2*f[4]**3
    C.flat[27] = f[0]*f[2]*f[4]+f[0]*f[6]*f[4]-f[6]*f[3]*f[1]-f[0]*f[3]*f[7]-f[1]*f[3]*f[2]-f[5]*f[1]*f[0]
    C.flat[49] = f[0]*f[2]*f[7]-f[6]*f[2]*f[1]-f[8]*f[1]*f[0]-f[1]*f[6]**2-f[6]**2*f[2]-f[6]*f[2]**2
    C.flat[8] = -f[2]*f[3]*f[4]-f[1]*f[6]*f[4]-f[1]*f[3]*f[7]-f[5]*f[3]*f[1]+f[0]*f[4]*f[7]+f[0]*f[5]*f[4]
    C.flat[20] = -f[2]*f[5]*f[3]-1/2*f[0]*f[2]**2+1/2*f[0]*f[5]**2+1/2*f[0]*f[7]**2-1/2*f[0]*f[6]**2-f[7]*f[6]*f[1]
    C.flat[19] = -f[2]*f[6]*f[7]-f[5]*f[6]*f[2]-f[8]*f[3]*f[2]-f[1]*f[6]*f[8]+f[0]*f[5]*f[8]+f[0]*f[8]*f[7]
    C.flat[40] = f[2]*f[8]*f[4]+f[4]*f[6]*f[8]-f[3]*f[8]*f[7]-f[7]*f[6]*f[5]-f[2]*f[5]*f[7]-f[1]*f[5]*f[8]
    C.flat[42] = -f[3]*f[6]*f[7]-f[5]*f[2]*f[1]+1/2*f[2]**2*f[4]-1/2*f[5]**2*f[4]-1/2*f[4]*f[7]**2+1/2*f[4]*f[6]**2
    C.flat[56] = -2*f[6]*f[2]*f[8]-2*f[1]*f[6]*f[8]-f[8]*f[2]*f[1]-1/2*f[7]*f[6]**2-1/2*f[6]**2*f[8]+1/2*f[2]**2*f[7]-1/2*f[8]*f[2]**2
    C.flat[58] = -2*f[8]*f[5]*f[7]-2*f[4]*f[8]*f[7]-f[5]*f[8]*f[4]-1/2*f[5]**2*f[8]-1/2*f[8]*f[7]**2+1/2*f[7]*f[5]**2-1/2*f[7]**3
    C.flat[76] = f[3]*f[0]+f[1]*f[0]+f[3]*f[4]+f[1]*f[4]+tau[0]**2*f[3]*f[0]+tau[0]**2*f[1]*f[0]+tau[0]**2*f[3]*f[4]+tau[0]**2*f[1]*f[4]
    C.flat[60] = -f[5]*f[6]**2-f[5]*f[7]**2-f[2]**2*f[7]-f[7]*f[5]**2-f[4]*f[7]**2-f[4]*f[6]**2-f[8]*f[1]**2-f[8]*f[4]**2
    C.flat[37] = f[0]*f[2]*f[4]-f[3]*f[5]*f[4]-f[1]*f[4]*f[7]+f[0]*f[6]*f[4]-f[1]*f[3]*f[2]-f[6]*f[3]*f[1]-f[0]*f[3]*f[7]-f[5]*f[1]*f[0]
    C.flat[16] = -f[0]*f[3]*f[6]-f[1]*f[6]*f[4]-f[1]*f[3]*f[7]-f[5]*f[3]*f[1]-f[2]*f[3]*f[4]+f[0]*f[4]*f[7]-f[0]*f[2]*f[1]+f[0]*f[5]*f[4]
    C.flat[47] = f[3]*f[8]*f[4]+f[4]*f[8]*f[1]-f[5]*f[6]*f[4]-f[3]*f[5]*f[7]-f[2]*f[4]*f[7]-f[5]*f[1]*f[7]-f[1]*f[4]*f[7]-f[6]*f[4]**2
    C.flat[68] = tau[0]**2*f[3]*f[1]+tau[0]**2*f[0]*f[4]+1/2*tau[0]**2*f[1]**2+1/2*f[1]**2+1/2*f[3]**2+f[3]*f[1]+f[0]*f[4]+1/2*tau[0]**2*f[3]**2
    C.flat[80] = tau[0]**2*f[5]*f[7]+tau[0]**2*f[8]*f[4]+1/2*tau[0]**2*f[5]**2+1/2*tau[0]**2*f[7]**2+f[5]*f[7]+f[8]*f[4]+1/2*f[5]**2+1/2*f[7]**2
    C.flat[78] = tau[0]**2*f[6]*f[2]+tau[0]**2*f[8]*f[0]+1/2*tau[0]**2*f[2]**2+1/2*tau[0]**2*f[6]**2+f[6]*f[2]+f[8]*f[0]+1/2*f[2]**2+1/2*f[6]**2
    C.flat[77] = 1/2*tau[0]**2*f[1]**2+tau[0]**2*f[4]**2+2*tau[0]*f[1]*f[3]-2*tau[0]*f[0]*f[4]-1/2*f[1]**2+f[4]**2-1/2*f[3]**2+1/2*tau[0]**2*f[3]**2+2*f[3]*f[1]
    C.flat[75] = 1/2*tau[0]**2*f[1]**2+2*tau[0]*f[1]*f[3]-2*tau[0]*f[0]*f[4]-1/2*f[1]**2+f[0]**2-1/2*f[3]**2+tau[0]**2*f[0]**2+1/2*tau[0]**2*f[3]**2+2*f[3]*f[1]
    C.flat[14] = -f[2]*f[6]*f[4]-f[2]*f[3]*f[7]-f[2]*f[5]*f[3]+1/2*f[0]*f[5]**2+1/2*f[0]*f[7]**2-f[7]*f[6]*f[1]-f[1]*f[6]*f[5]-f[8]*f[3]*f[1]+f[5]*f[0]*f[7]+f[4]*f[8]*f[0]
    C.flat[34] = f[2]*f[6]*f[4]+f[4]*f[8]*f[0]-f[3]*f[6]*f[7]-f[2]*f[3]*f[7]-f[8]*f[3]*f[1]-f[1]*f[6]*f[5]-f[5]*f[0]*f[7]-f[5]*f[2]*f[1]+1/2*f[2]**2*f[4]+1/2*f[4]*f[6]**2
    C.flat[57] = -f[5]*f[2]*f[8]-f[6]*f[8]*f[7]-2*f[5]*f[6]*f[8]-2*f[2]*f[8]*f[7]+f[2]*f[5]*f[7]-2*f[1]*f[8]*f[7]-2*f[4]*f[6]*f[8]-f[2]*f[8]*f[4]-f[1]*f[5]*f[8]-f[6]*f[7]**2
    C.flat[55] = -f[5]*f[6]*f[3]-f[1]*f[2]*f[7]-2*f[7]*f[5]*f[4]-f[3]*f[6]*f[4]+1/2*f[8]*f[1]**2+f[8]*f[4]**2+1/2*f[8]*f[3]**2-1/2*f[1]**2*f[7]-f[7]*f[4]**2+1/2*f[3]**2*f[7]
    C.flat[51] = -2*f[7]*f[6]*f[5]-2*f[2]*f[5]*f[7]-2*f[7]*f[6]*f[4]+f[3]*f[5]*f[7]-f[5]*f[6]*f[4]-f[3]*f[8]*f[4]-2*f[4]*f[8]*f[1]-f[6]*f[5]**2-f[2]*f[7]**2-f[1]*f[7]**2
    C.flat[45] = f[8]*f[1]*f[0]+f[8]*f[3]*f[0]-f[6]*f[3]*f[2]-f[0]*f[6]*f[5]-f[6]*f[2]*f[1]-f[0]*f[2]*f[7]+f[0]*f[3]*f[7]-f[6]*f[3]*f[1]-f[0]*f[6]*f[4]-f[6]*f[1]**2
    C.flat[64] = -f[8]*f[2]*f[1]-f[5]*f[8]*f[4]-1/2*f[7]*f[6]**2-1/2*f[8]*f[2]**2-1/2*f[5]**2*f[8]-1/2*f[8]*f[7]**2-1/2*f[6]**2*f[8]+1/2*f[2]**2*f[7]+1/2*f[7]*f[5]**2-1/2*f[7]**3
    C.flat[83] = 1/2*tau[0]**2*f[1]**2+1/2*tau[0]**2*f[4]**2+1/2*tau[0]**2*f[0]**2+1/2*tau[0]**2*f[3]**2+2*f[3]*f[1]-1/2*f[1]**2+1/2*f[4]**2+1/2*f[0]**2-1/2*f[3]**2-2*tau[0]*f[0]*f[4]+2*tau[0]*f[1]*f[3]
    C.flat[53] = -2*f[6]*f[2]*f[0]-f[5]*f[6]*f[3]-f[1]*f[2]*f[7]-f[3]*f[6]*f[4]-2*f[6]*f[1]*f[0]+1/2*f[8]*f[1]**2+f[8]*f[0]**2+1/2*f[8]*f[3]**2-1/2*f[1]**2*f[7]+f[0]**2*f[7]+1/2*f[3]**2*f[7]
    C.flat[59] = f[0]*f[2]*f[7]+f[3]*f[5]*f[7]-f[6]*f[2]*f[1]-f[5]*f[6]*f[4]-f[8]*f[1]*f[0]-f[3]*f[8]*f[4]-f[6]**2*f[2]-f[6]*f[2]**2-f[6]*f[5]**2-f[2]*f[7]**2-f[1]*f[7]**2-f[1]*f[6]**2
    C.flat[79] = tau[0]**2*f[2]*f[5]+tau[0]**2*f[6]*f[7]+tau[0]**2*f[6]*f[5]+tau[0]**2*f[3]*f[8]+tau[0]**2*f[2]*f[7]+tau[0]**2*f[8]*f[1]+f[2]*f[5]+f[6]*f[7]+f[6]*f[5]+f[3]*f[8]+f[2]*f[7]+f[8]*f[1]
    C.flat[72] = tau[0]**2*f[6]*f[1]+tau[0]**2*f[0]*f[7]+tau[0]**2*f[3]*f[2]+tau[0]**2*f[5]*f[0]+tau[0]**2*f[2]*f[1]+tau[0]**2*f[3]*f[6]+f[6]*f[1]+f[0]*f[7]+f[3]*f[2]+f[5]*f[0]+f[2]*f[1]+f[3]*f[6]
    C.flat[73] = tau[0]**2*f[6]*f[4]+tau[0]**2*f[3]*f[7]+tau[0]**2*f[3]*f[5]+tau[0]**2*f[1]*f[7]+tau[0]**2*f[2]*f[4]+tau[0]**2*f[5]*f[1]+f[6]*f[4]+f[3]*f[7]+f[3]*f[5]+f[1]*f[7]+f[2]*f[4]+f[5]*f[1]
    C.flat[50] = -2*f[2]*f[6]*f[7]-2*f[5]*f[6]*f[2]-2*f[7]*f[6]*f[1]+f[2]*f[3]*f[7]+f[5]*f[0]*f[7]-f[2]*f[6]*f[4]-f[1]*f[6]*f[5]-f[8]*f[3]*f[1]-f[4]*f[8]*f[0]-f[5]*f[6]**2-f[2]**2*f[7]-f[4]*f[6]**2-f[8]*f[1]**2
    C.flat[86] = 2*f[6]*f[2]+2*f[5]*f[7]+1/2*tau[0]**2*f[2]**2+1/2*tau[0]**2*f[5]**2+1/2*tau[0]**2*f[7]**2+1/2*tau[0]**2*f[6]**2-1/2*f[2]**2-1/2*f[5]**2-1/2*f[7]**2-1/2*f[6]**2-2*tau[0]*f[4]*f[8]-2*tau[0]*f[0]*f[8]+2*tau[0]*f[2]*f[6]+2*tau[0]*f[5]*f[7]
    C.flat[61] = -f[6]*f[2]*f[0]-f[5]*f[6]*f[3]-f[1]*f[2]*f[7]-f[7]*f[5]*f[4]-f[6]*f[1]*f[0]-f[3]*f[6]*f[4]+1/2*f[0]**2*f[7]+1/2*f[3]**2*f[7]+1/2*f[8]*f[1]**2+1/2*f[8]*f[4]**2+1/2*f[8]*f[0]**2+1/2*f[8]*f[3]**2-1/2*f[1]**2*f[7]-1/2*f[7]*f[4]**2
    C.flat[46] = f[8]*f[3]*f[1]+f[4]*f[8]*f[0]-f[5]*f[6]*f[3]-f[2]*f[6]*f[4]-f[1]*f[6]*f[5]-f[2]*f[3]*f[7]-f[5]*f[0]*f[7]-f[1]*f[2]*f[7]-f[3]*f[6]*f[4]-2*f[1]*f[6]*f[4]+1/2*f[8]*f[1]**2+1/2*f[8]*f[3]**2-1/2*f[1]**2*f[7]+1/2*f[3]**2*f[7]
    C.flat[81] = tau[0]**2*f[2]*f[0]+tau[0]**2*f[3]*f[5]+tau[0]**2*f[1]*f[7]+tau[0]**2*f[6]*f[0]+2*tau[0]*f[3]*f[7]+2*tau[0]*f[1]*f[5]-2*tau[0]*f[2]*f[4]-2*tau[0]*f[4]*f[6]+f[2]*f[0]-f[3]*f[5]-f[1]*f[7]+f[6]*f[0]+2*f[3]*f[7]+2*f[5]*f[1]
    C.flat[82] = tau[0]**2*f[4]*f[7]+tau[0]**2*f[2]*f[1]+tau[0]**2*f[5]*f[4]+tau[0]**2*f[3]*f[6]+2*tau[0]*f[1]*f[6]+2*tau[0]*f[2]*f[3]-2*tau[0]*f[0]*f[7]-2*tau[0]*f[0]*f[5]+f[4]*f[7]-f[2]*f[1]+f[5]*f[4]-f[3]*f[6]+2*f[6]*f[1]+2*f[3]*f[2]
    C.flat[54] = -f[6]*f[1]**2-f[6]*f[4]**2-f[0]*f[2]*f[7]-f[3]*f[5]*f[7]-f[2]*f[4]*f[7]-f[5]*f[1]*f[7]+f[0]*f[3]*f[7]-f[1]*f[4]*f[7]-f[6]*f[3]*f[1]-f[0]*f[6]*f[4]+f[8]*f[3]*f[0]+f[8]*f[1]*f[0]+f[3]*f[8]*f[4]+f[4]*f[8]*f[1]-f[6]*f[3]*f[2]-f[0]*f[6]*f[5]-f[6]*f[2]*f[1]-f[5]*f[6]*f[4]

    C = C/np.sqrt(np.sum(C*np.conj(C),axis=1,keepdims=True))

    def U(x,y,z):
        return np.array([x**4,x**3*y,x**2*y**2,x*y**3,y**4,x**3,y*x**2,y**2*x,y**3,z*x**2,z*y*x,z*y**2,x**2,x*y,y**2,x*z,y*z,z**2,x,y,z,1])

    return C,U