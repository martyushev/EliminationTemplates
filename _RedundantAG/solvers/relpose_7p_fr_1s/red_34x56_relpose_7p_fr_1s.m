% Input: coefficient matrix C of size 11x56
% Output: solution matrix S of size 4x22

function S = red_34x56_relpose_7p_fr_1s(C)

    ix = [1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,19,19,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34];
    jx = [29,32,33,34,51,56,18,24,28,31,49,52,19,25,29,32,50,54,26,29,30,33,55,56,13,16,17,19,25,45,21,26,27,30,47,55,22,43,44,48,49,52,12,18,22,23,24,44,14,20,39,46,47,55,3,37,40,41,43,48,6,14,20,35,36,38,15,25,26,29,46,54,9,15,21,26,39,46,4,5,10,12,23,42,7,8,13,15,25,45,14,46,53,54,55,56,1,2,7,8,9,15,7,11,38,45,46,54,1,7,36,38,39,46,4,22,37,41,42,44,6,7,8,11,13,14,15,16,17,19,25,26,29,30,32,33,34,38,45,46,50,51,53,54,55,56,1,2,7,8,9,13,14,15,20,21,25,26,27,29,30,33,35,36,38,39,45,46,47,54,55,56,1,2,3,4,5,7,8,9,10,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,52,54,55,56,1,2,3,4,5,7,8,9,10,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,49,52,54,55,56,6,7,8,11,13,14,15,16,17,19,25,26,29,30,32,33,34,38,40,42,45,46,49,50,51,53,54,55,56,1,2,3,4,7,8,9,13,14,15,20,21,25,26,27,29,30,33,35,36,38,39,45,46,47,52,54,55,56,1,2,3,4,5,7,8,9,10,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,52,54,55,56,1,2,3,4,5,7,8,9,10,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,42,43,44,45,46,47,48,52,54,55,56,6,7,8,10,11,13,14,15,16,17,18,19,25,26,29,30,32,33,34,38,41,45,46,50,51,53,54,55,56,1,2,5,7,8,9,13,14,15,20,21,24,25,26,27,29,30,33,35,36,37,38,39,45,46,47,54,55,56,1,2,3,4,5,7,8,9,10,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,43,44,45,46,47,48,49,52,54,55,56,1,2,3,4,5,7,8,9,10,12,13,14,15,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,41,43,44,45,46,47,48,49,52,54,55,56,6,7,8,11,13,14,15,16,17,19,23,25,26,29,30,31,32,33,34,38,45,46,48,50,51,53,54,55,56,1,2,7,8,9,12,13,14,15,20,21,25,26,27,28,29,30,33,35,36,38,39,43,45,46,47,54,55,56];
    kx = [540,584,595,606,573,529,584,540,595,606,573,529,584,540,595,606,573,529,540,584,595,606,529,573,540,573,584,606,595,529,540,584,595,606,529,573,584,529,540,573,606,595,540,606,573,584,595,529,573,529,540,584,595,606,529,540,573,584,595,606,573,606,595,529,540,584,540,584,595,606,529,573,540,584,595,606,529,573,529,540,584,595,606,573,529,540,584,595,606,573,529,540,573,584,595,606,529,540,573,584,595,606,540,573,529,584,595,606,540,584,529,573,595,606,540,606,529,573,584,595,90,112,123,233,266,277,299,365,376,508,431,453,541,552,585,596,607,101,255,288,497,574,398,420,442,530,112,123,255,266,299,376,398,431,277,453,508,541,552,585,596,607,90,101,233,288,365,420,442,497,530,574,25,36,47,69,80,113,124,157,201,245,267,278,300,377,487,509,135,322,344,355,410,432,454,465,520,542,553,564,586,597,608,3,14,58,102,146,179,190,212,223,256,289,311,333,476,388,421,443,531,26,37,48,70,81,114,125,158,202,246,268,279,301,378,488,510,136,323,345,356,411,433,455,466,521,543,554,565,587,598,609,4,15,59,103,147,180,191,213,224,257,290,312,334,477,389,422,444,532,93,115,126,236,269,280,302,368,379,511,434,456,544,555,588,599,610,104,170,192,258,291,478,500,577,401,423,445,533,115,126,170,192,258,269,302,379,401,434,280,456,511,544,555,588,599,610,93,104,236,291,368,423,445,478,500,533,577,28,39,50,72,83,116,127,160,204,248,270,281,303,380,490,512,138,325,347,358,413,435,457,468,523,545,556,567,589,600,611,6,17,61,105,149,182,193,215,226,259,292,314,336,391,424,446,534,29,40,51,73,84,117,128,161,205,249,271,282,304,381,491,513,139,326,348,359,414,436,458,469,524,546,557,568,590,601,612,7,18,62,106,150,183,194,216,227,260,293,315,337,392,425,447,535,96,118,129,206,239,272,283,305,371,382,492,514,437,459,547,558,591,602,613,107,184,261,294,503,580,404,426,448,536,118,129,206,261,272,305,382,404,437,283,459,492,514,547,558,591,602,613,96,107,184,239,294,371,426,448,503,536,580,31,42,53,75,86,119,130,163,207,251,273,284,306,383,493,515,141,328,350,361,416,438,460,471,526,548,559,570,592,603,614,9,20,64,108,152,185,218,229,262,295,317,339,482,394,427,449,537,32,43,54,76,87,120,131,164,208,252,274,285,307,384,494,516,142,329,351,362,417,439,461,472,527,549,560,571,593,604,615,10,21,65,109,153,186,219,230,263,296,318,340,483,395,428,450,538,99,121,132,242,275,286,308,374,385,517,363,440,462,550,561,572,594,605,616,110,264,297,341,506,583,407,429,451,539,121,132,264,275,308,363,385,407,440,286,462,517,550,561,572,594,605,616,99,110,242,297,341,374,429,451,506,539,583];
    M = sparse(ix,jx,C(kx),34,56);

    [L,~,P] = lu(M(:,1:19));
    P = P';
    M = [P*L P(:,20:end)]\M(:,20:end);
    M = M(end-14:end,:);

    T = zeros(22);
    T([1,5,7,8,10,11,12,13,18,20,21,15,16,22,17],:) = -M(:,1:15)\M(:,16:end);
    T([90,201,246,292,383,322,481]) = 1;

    [V,~] = eig(T);
    S = V(18:21,:)./repmat(V(22,:),4,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end