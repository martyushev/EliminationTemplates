% Input: coefficient matrix C of size 3x20
% Output: solution matrix S of size 3x30

function S = red_74x104_satellite_triang(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74,74];
    jx = [1,2,3,4,7,8,9,12,13,25,26,27,31,32,36,46,47,76,83,90,2,3,4,5,8,9,10,13,26,27,28,32,33,37,47,48,75,77,84,91,3,4,5,6,9,10,11,14,15,27,28,29,33,34,48,49,50,56,57,75,7,8,9,10,12,13,31,32,33,36,37,75,76,77,78,80,83,84,86,93,8,9,10,11,13,14,15,16,32,33,34,37,50,51,57,58,62,75,77,84,12,13,14,15,16,17,36,37,51,57,58,59,60,63,75,76,77,78,80,86,19,20,21,22,26,27,28,32,33,37,41,42,43,47,48,54,84,88,91,97,20,21,22,23,27,28,29,33,34,42,43,44,48,49,50,55,56,57,65,88,24,25,26,27,30,31,32,35,36,45,46,47,79,82,83,85,89,90,92,98,25,26,27,28,31,32,33,36,37,46,47,48,80,83,84,86,90,91,93,99,26,27,28,29,32,33,34,37,47,48,49,50,51,56,57,58,62,66,84,91,30,31,32,33,35,36,37,79,80,81,82,83,84,85,86,87,92,93,94,100,31,32,33,34,36,37,50,51,57,58,59,60,62,63,67,80,83,84,86,93,35,36,37,38,51,57,58,59,60,61,63,64,68,79,80,81,85,86,87,94,39,40,41,42,45,46,47,52,53,54,82,83,85,89,90,92,95,96,98,101,40,41,42,43,46,47,48,53,54,83,84,86,88,90,91,93,96,97,99,102,41,42,43,44,47,48,49,50,51,54,55,56,62,65,66,69,84,88,91,97,45,46,47,48,82,83,84,85,86,87,89,90,91,92,93,94,98,99,100,103,46,47,48,49,50,51,56,60,62,63,66,67,70,83,84,86,90,91,93,99,50,51,60,61,62,63,64,67,68,71,82,83,84,85,86,87,92,93,94,100,52,53,54,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,53,54,55,56,62,63,65,66,67,69,70,72,88,90,91,93,96,97,99,102,56,62,63,64,66,67,68,70,71,73,89,90,91,92,93,94,98,99,100,103,65,66,67,68,69,70,71,72,73,74,95,96,97,98,99,100,101,102,103,104,1,2,3,4,7,8,9,12,13,25,26,27,31,32,36,46,47,76,83,90,2,3,4,5,8,9,10,13,26,27,28,32,33,37,47,48,75,77,84,91,3,4,5,6,9,10,11,14,15,27,28,29,33,34,48,49,50,56,57,75,7,8,9,10,12,13,31,32,33,36,37,75,76,77,78,80,83,84,86,93,8,9,10,11,13,14,15,16,32,33,34,37,50,51,57,58,62,75,77,84,12,13,14,15,16,17,36,37,51,57,58,59,60,63,75,76,77,78,80,86,18,19,20,21,25,26,27,31,32,36,40,41,42,46,47,53,54,83,90,96,19,20,21,22,26,27,28,32,33,37,41,42,43,47,48,54,84,88,91,97,20,21,22,23,27,28,29,33,34,42,43,44,48,49,50,55,56,57,65,88,24,25,26,27,30,31,32,35,36,45,46,47,79,82,83,85,89,90,92,98,25,26,27,28,31,32,33,36,37,46,47,48,80,83,84,86,90,91,93,99,26,27,28,29,32,33,34,37,47,48,49,50,51,56,57,58,62,66,84,91,30,31,32,33,35,36,37,79,80,81,82,83,84,85,86,87,92,93,94,100,31,32,33,34,36,37,50,51,57,58,59,60,62,63,67,80,83,84,86,93,35,36,37,38,51,57,58,59,60,61,63,64,68,79,80,81,85,86,87,94,39,40,41,42,45,46,47,52,53,54,82,83,85,89,90,92,95,96,98,101,40,41,42,43,46,47,48,53,54,83,84,86,88,90,91,93,96,97,99,102,41,42,43,44,47,48,49,50,51,54,55,56,62,65,66,69,84,88,91,97,45,46,47,48,82,83,84,85,86,87,89,90,91,92,93,94,98,99,100,103,46,47,48,49,50,51,56,60,62,63,66,67,70,83,84,86,90,91,93,99,50,51,60,61,62,63,64,67,68,71,82,83,84,85,86,87,92,93,94,100,52,53,54,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,53,54,55,56,62,63,65,66,67,69,70,72,88,90,91,93,96,97,99,102,56,62,63,64,66,67,68,70,71,73,89,90,91,92,93,94,98,99,100,103,65,66,67,68,69,70,71,72,73,74,95,96,97,98,99,100,101,102,103,104,1,2,3,4,7,8,9,12,13,25,26,27,31,32,36,46,47,76,83,90,2,3,4,5,8,9,10,13,26,27,28,32,33,37,47,48,75,77,84,91,3,4,5,6,9,10,11,14,15,27,28,29,33,34,48,49,50,56,57,75,7,8,9,10,12,13,31,32,33,36,37,75,76,77,78,80,83,84,86,93,8,9,10,11,13,14,15,16,32,33,34,37,50,51,57,58,62,75,77,84,12,13,14,15,16,17,36,37,51,57,58,59,60,63,75,76,77,78,80,86,18,19,20,21,25,26,27,31,32,36,40,41,42,46,47,53,54,83,90,96,19,20,21,22,26,27,28,32,33,37,41,42,43,47,48,54,84,88,91,97,20,21,22,23,27,28,29,33,34,42,43,44,48,49,50,55,56,57,65,88,24,25,26,27,30,31,32,35,36,45,46,47,79,82,83,85,89,90,92,98,25,26,27,28,31,32,33,36,37,46,47,48,80,83,84,86,90,91,93,99,26,27,28,29,32,33,34,37,47,48,49,50,51,56,57,58,62,66,84,91,30,31,32,33,35,36,37,79,80,81,82,83,84,85,86,87,92,93,94,100,31,32,33,34,36,37,50,51,57,58,59,60,62,63,67,80,83,84,86,93,35,36,37,38,51,57,58,59,60,61,63,64,68,79,80,81,85,86,87,94,39,40,41,42,45,46,47,52,53,54,82,83,85,89,90,92,95,96,98,101,40,41,42,43,46,47,48,53,54,83,84,86,88,90,91,93,96,97,99,102,41,42,43,44,47,48,49,50,51,54,55,56,62,65,66,69,84,88,91,97,45,46,47,48,82,83,84,85,86,87,89,90,91,92,93,94,98,99,100,103,46,47,48,49,50,51,56,60,62,63,66,67,70,83,84,86,90,91,93,99,50,51,60,61,62,63,64,67,68,71,82,83,84,85,86,87,92,93,94,100,52,53,54,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,53,54,55,56,62,63,65,66,67,69,70,72,88,90,91,93,96,97,99,102,56,62,63,64,66,67,68,70,71,73,89,90,91,92,93,94,98,99,100,103,65,66,67,68,69,70,71,72,73,74,95,96,97,98,99,100,101,102,103,104];
    kx = [1,4,7,10,13,16,19,22,25,31,34,37,40,43,46,49,52,28,55,58,1,4,7,10,13,16,19,22,31,34,37,40,43,46,49,52,25,28,55,58,1,4,7,10,13,16,19,25,28,31,34,37,40,43,49,52,55,58,46,22,1,4,7,10,13,16,31,34,37,40,43,19,22,25,28,46,49,52,55,58,1,4,7,10,13,19,25,28,31,34,37,40,52,55,43,46,58,16,22,49,1,4,10,19,25,28,31,34,52,37,43,46,55,58,7,13,16,22,40,49,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,49,46,52,55,58,1,4,7,10,13,16,19,22,25,31,34,37,40,43,46,52,55,28,58,49,1,4,7,10,13,16,19,22,25,31,34,37,28,40,43,46,49,52,55,58,1,4,7,10,13,16,19,22,25,31,34,37,28,40,43,46,49,52,55,58,1,4,7,10,13,16,19,22,31,34,37,43,46,52,25,28,55,58,40,49,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,1,4,7,10,13,16,37,43,19,25,28,46,52,55,58,22,31,34,40,49,1,4,7,28,37,10,19,25,43,46,52,55,58,13,16,22,31,34,40,49,1,4,7,10,13,16,19,31,34,37,22,25,28,40,43,46,49,52,55,58,1,4,7,10,13,16,19,31,34,22,25,28,37,40,43,46,49,52,55,58,1,4,7,10,13,16,19,25,28,31,37,43,46,52,55,58,22,34,40,49,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,1,4,7,10,19,25,37,28,43,46,52,55,58,13,16,22,31,34,40,49,10,19,25,28,37,43,46,52,55,58,1,4,7,13,16,22,31,34,40,49,1,4,7,10,13,16,19,22,25,28,31,34,37,40,43,46,49,52,55,58,1,4,10,19,25,28,37,43,46,52,55,58,7,13,16,22,31,34,40,49,10,19,25,28,37,43,46,52,55,58,1,4,7,13,16,22,31,34,40,49,10,19,25,28,37,43,46,52,55,58,1,4,7,13,16,22,31,34,40,49,2,5,8,11,14,17,20,23,26,32,35,38,41,44,47,50,53,29,56,59,2,5,8,11,14,17,20,23,32,35,38,41,44,47,50,53,26,29,56,59,2,5,8,11,14,17,20,26,29,32,35,38,41,44,50,53,56,59,47,23,2,5,8,11,14,17,32,35,38,41,44,20,23,26,29,47,50,53,56,59,2,5,8,11,14,20,26,29,32,35,38,41,53,56,44,47,59,17,23,50,2,5,11,20,26,29,32,35,53,38,44,47,56,59,8,14,17,23,41,50,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,50,53,47,56,59,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,50,47,53,56,59,2,5,8,11,14,17,20,23,26,32,35,38,41,44,47,53,56,29,59,50,2,5,8,11,14,17,20,23,26,32,35,38,29,41,44,47,50,53,56,59,2,5,8,11,14,17,20,23,26,32,35,38,29,41,44,47,50,53,56,59,2,5,8,11,14,17,20,23,32,35,38,44,47,53,26,29,56,59,41,50,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,2,5,8,11,14,17,38,44,20,26,29,47,53,56,59,23,32,35,41,50,2,5,8,29,38,11,20,26,44,47,53,56,59,14,17,23,32,35,41,50,2,5,8,11,14,17,20,32,35,38,23,26,29,41,44,47,50,53,56,59,2,5,8,11,14,17,20,32,35,23,26,29,38,41,44,47,50,53,56,59,2,5,8,11,14,17,20,26,29,32,38,44,47,53,56,59,23,35,41,50,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,2,5,8,11,20,26,38,29,44,47,53,56,59,14,17,23,32,35,41,50,11,20,26,29,38,44,47,53,56,59,2,5,8,14,17,23,32,35,41,50,2,5,8,11,14,17,20,23,26,29,32,35,38,41,44,47,50,53,56,59,2,5,11,20,26,29,38,44,47,53,56,59,8,14,17,23,32,35,41,50,11,20,26,29,38,44,47,53,56,59,2,5,8,14,17,23,32,35,41,50,11,20,26,29,38,44,47,53,56,59,2,5,8,14,17,23,32,35,41,50,3,6,9,12,15,18,21,24,27,33,36,39,42,45,48,51,54,30,57,60,3,6,9,12,15,18,21,24,33,36,39,42,45,48,51,54,27,30,57,60,3,6,9,12,15,18,21,27,30,33,36,39,42,45,51,54,57,60,48,24,3,6,9,12,15,18,33,36,39,42,45,21,24,27,30,48,51,54,57,60,3,6,9,12,15,21,27,30,33,36,39,42,54,57,45,48,60,18,24,51,3,6,12,21,27,30,33,36,54,39,45,48,57,60,9,15,18,24,42,51,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,51,54,48,57,60,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,51,48,54,57,60,3,6,9,12,15,18,21,24,27,33,36,39,42,45,48,54,57,30,60,51,3,6,9,12,15,18,21,24,27,33,36,39,30,42,45,48,51,54,57,60,3,6,9,12,15,18,21,24,27,33,36,39,30,42,45,48,51,54,57,60,3,6,9,12,15,18,21,24,33,36,39,45,48,54,27,30,57,60,42,51,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,3,6,9,12,15,18,39,45,21,27,30,48,54,57,60,24,33,36,42,51,3,6,9,30,39,12,21,27,45,48,54,57,60,15,18,24,33,36,42,51,3,6,9,12,15,18,21,33,36,39,24,27,30,42,45,48,51,54,57,60,3,6,9,12,15,18,21,33,36,24,27,30,39,42,45,48,51,54,57,60,3,6,9,12,15,18,21,27,30,33,39,45,48,54,57,60,24,36,42,51,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,3,6,9,12,21,27,39,30,45,48,54,57,60,15,18,24,33,36,42,51,12,21,27,30,39,45,48,54,57,60,3,6,9,15,18,24,33,36,42,51,3,6,9,12,15,18,21,24,27,30,33,36,39,42,45,48,51,54,57,60,3,6,12,21,27,30,39,45,48,54,57,60,9,15,18,24,33,36,42,51,12,21,27,30,39,45,48,54,57,60,3,6,9,15,18,24,33,36,42,51,12,21,27,30,39,45,48,54,57,60,3,6,9,15,18,24,33,36,42,51];
    M = sparse(ix,jx,C(kx),74,104);

    [L,~,P] = lu(M(:,1:56));
    P = P';
    M = [P*L P(:,57:end)]\M(:,57:end);
    M = M(end-17:end,:);

    T = zeros(30);
    T([1,3,4,6,7,10,12,13,14,17,19,20,23,25,26,28,29,30],:) = -M(:,1:18)\M(:,19:end);
    T([152,365,518,549,581,705,736,768,801,832,864,897]) = 1;

    [V,~] = eig(T);
    S = V(27:29,:)./repmat(V(30,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end