% Input: coefficient matrix C of size 10x40
% Output: solution matrix S of size 3x26

function S = red_14x40_relpose_6p_rad_1s(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14];
    jx = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,5,6,7,8,9,10,11,12,13,14,15,16,17,18,22,23,24,25,26,27,28,31,32,33,34,35,37,38,39,40,1,2,3,4,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,5,6,7,8,9,10,11,12,13,14,15,16,17,18,22,23,24,25,26,27,28,31,32,33,34,35,37,38,39,40,1,2,3,4,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,5,6,7,8,9,10,11,12,13,14,15,16,17,18,22,23,24,25,26,27,28,31,32,33,34,35,37,38,39,40,1,2,3,4,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,5,6,7,8,9,10,11,12,13,14,15,16,17,18,22,23,24,25,26,27,28,31,32,33,34,35,37,38,39,40,1,2,3,4,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40];
    kx = [1,11,21,31,201,211,221,231,301,311,321,361,371,391,41,51,61,71,81,91,101,111,121,131,141,151,161,171,181,191,241,251,261,271,281,291,331,341,351,381,2,12,22,32,202,212,222,232,302,312,322,362,372,392,42,52,62,72,82,92,102,112,122,132,142,152,162,172,182,192,242,252,262,272,282,292,332,342,352,382,203,213,223,233,303,313,323,363,373,393,43,53,63,73,113,123,133,143,153,163,173,243,253,263,273,283,333,343,353,383,43,53,63,73,113,123,133,143,153,163,173,203,213,223,233,243,253,263,273,283,303,313,323,333,343,353,363,373,383,393,4,14,24,34,204,214,224,234,304,314,324,364,374,394,44,54,64,74,84,94,104,114,124,134,144,154,164,174,184,194,244,254,264,274,284,294,334,344,354,384,5,15,25,35,205,215,225,235,305,315,325,365,375,395,45,55,65,75,85,95,105,115,125,135,145,155,165,175,185,195,245,255,265,275,285,295,335,345,355,385,206,216,226,236,306,316,326,366,376,396,46,56,66,76,116,126,136,146,156,166,176,246,256,266,276,286,336,346,356,386,46,56,66,76,116,126,136,146,156,166,176,206,216,226,236,246,256,266,276,286,306,316,326,336,346,356,366,376,386,396,7,17,27,37,207,217,227,237,307,317,327,367,377,397,47,57,67,77,87,97,107,117,127,137,147,157,167,177,187,197,247,257,267,277,287,297,337,347,357,387,8,18,28,38,208,218,228,238,308,318,328,368,378,398,48,58,68,78,88,98,108,118,128,138,148,158,168,178,188,198,248,258,268,278,288,298,338,348,358,388,209,219,229,239,309,319,329,369,379,399,49,59,69,79,119,129,139,149,159,169,179,249,259,269,279,289,339,349,359,389,49,59,69,79,119,129,139,149,159,169,179,209,219,229,239,249,259,269,279,289,309,319,329,339,349,359,369,379,389,399,210,220,230,240,310,320,330,370,380,400,50,60,70,80,120,130,140,150,160,170,180,250,260,270,280,290,340,350,360,390,50,60,70,80,120,130,140,150,160,170,180,210,220,230,240,250,260,270,280,290,310,320,330,340,350,360,370,380,390,400];
    M = sparse(ix,jx,C(kx),14,40);

    [L,~,P] = lu(M(:,1:4));
    P = P';
    M = [P*L P(:,5:end)]\M(:,5:end);
    M = M(end-9:end,:);

    T = zeros(26);
    T([8,9,10,11,17,18,19,23,24,26],:) = -M(:,1:10)\M(:,11:end);
    T([183,210,237,264,291,318,345,428,455,482,509,536,592,619,646,675]) = 1;

    [V,~] = eig(T);
    S = V(23:25,:)./repmat(V(26,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end