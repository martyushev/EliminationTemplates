% Input: coefficient matrix C of size 3x39
% Output: solution matrix S of size 3x19

function S = red_21x40_8ptF_radial(C)

    ix = [1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21];
    jx = [1,2,3,8,12,13,16,25,26,31,8,9,10,16,17,19,31,32,35,38,2,4,5,8,9,10,31,32,35,38,3,5,10,13,14,17,22,26,27,32,14,15,18,22,23,24,27,29,30,34,10,17,18,20,28,29,32,34,36,37,4,6,7,9,11,28,33,37,38,40,9,11,28,33,35,36,37,38,39,40,5,7,10,23,28,29,32,34,36,37,19,20,21,33,35,36,37,38,39,40,1,2,3,8,12,13,16,25,26,31,8,9,10,16,17,19,31,32,35,38,2,4,5,8,9,10,31,32,35,38,3,5,10,13,14,17,22,26,27,32,14,15,18,22,23,24,27,29,30,34,10,17,18,20,28,29,32,34,36,37,4,6,7,9,11,28,33,37,38,40,9,11,28,33,35,36,37,38,39,40,5,7,10,23,28,29,32,34,36,37,19,20,21,33,35,36,37,38,39,40,1,2,3,4,5,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40];
    kx = [82,85,79,103,109,106,115,100,97,112,82,85,79,109,106,115,100,97,112,103,82,85,79,100,103,97,109,106,115,112,82,85,103,109,106,115,79,100,97,112,109,106,115,82,85,79,100,103,97,112,82,109,106,115,85,79,100,97,112,103,82,85,79,100,103,97,112,106,109,115,82,85,79,103,109,106,97,100,115,112,82,85,100,79,103,97,109,106,115,112,109,106,115,85,100,97,79,82,112,103,83,86,80,104,110,107,116,101,98,113,83,86,80,110,107,116,101,98,113,104,83,86,80,101,104,98,110,107,116,113,83,86,104,110,107,116,80,101,98,113,110,107,116,83,86,80,101,104,98,113,83,110,107,116,86,80,101,98,113,104,83,86,80,101,104,98,113,107,110,116,83,86,80,104,110,107,98,101,116,113,83,86,101,80,104,98,110,107,116,113,110,107,116,86,101,98,80,83,113,104,12,21,9,27,18,24,48,54,45,57,69,66,63,60,96,93,90,111,108,117,6,15,3,39,36,33,51,42,30,78,75,87,72,102,99,81,84,114,105];
    M = sparse(ix,jx,C(kx),21,40);

    [L,~,P] = lu(M(:,1:11));
    P = P';
    M = [P*L P(:,12:end)]\M(:,12:end);
    M = M(end-9:end,:);

    T = zeros(19);
    T([4,5,6,9,10,11,13,14,15,18],:) = -M(:,1:10)\M(:,11:end);
    T([96,135,155,292,236,354,282,264,342]) = 1;

    [V,~] = eig(T);
    S([1,2],:) = V([16,17],:)./repmat(V(19,:),2,1);
    S(3,:) = V(19,:)./V(18,:);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end