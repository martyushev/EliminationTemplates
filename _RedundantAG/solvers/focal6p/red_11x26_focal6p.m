% Input: coefficient matrix C of size 10x26
% Output: solution matrix S of size 3x15

function S = red_11x26_focal6p(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11];
    jx = [1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,3,4,5,6,7,8,9,10,11,13,15,16,17,18,19,20,21,22,23,24,25,26,1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,2,3,4,5,6,7,8,9,10,11,13,15,16,17,18,19,20,21,22,23,24,25,26,2,3,4,5,7,8,9,10,15,16,18,19,20,21,22,23,24,25,26,3,5,7,8,9,10,13,15,16,17,18,19,20,21,22,23,24,25,26,3,5,6,7,8,9,10,11,18,19,20,21,22,23,24,25,26,3,8,10,11,19,21,22,24,25,26,2,5,7,9,13,15,16,18,20,23];
    kx = [41,61,151,101,131,161,191,211,221,241,251,11,21,31,51,71,81,91,111,121,141,171,181,201,231,62,152,102,132,162,192,212,222,242,252,2,12,22,32,52,72,82,92,112,122,142,172,182,202,232,63,153,103,133,163,193,213,223,243,253,13,33,53,73,83,93,113,123,143,173,183,203,233,44,64,154,104,134,164,194,214,224,244,254,14,24,34,54,74,84,94,114,124,144,174,184,204,234,65,155,105,135,165,195,215,225,245,255,5,15,25,35,55,75,85,95,115,125,145,175,185,205,235,66,156,106,136,166,196,216,226,246,256,16,36,56,76,86,96,116,126,146,176,186,206,236,67,157,107,137,197,217,227,247,37,57,87,97,117,127,147,177,187,207,237,158,138,198,218,228,248,18,38,58,78,88,98,118,128,148,178,188,208,238,159,139,169,199,219,229,249,259,89,99,119,129,149,179,189,209,239,160,220,250,260,100,130,150,190,210,240,160,220,250,260,100,130,150,190,210,240];
    M = sparse(ix,jx,C(kx),11,26);

    [L,~,P] = lu(M(:,1:3));
    P = P';
    M = [P*L P(:,4:end)]\M(:,4:end);
    M = M(end-7:end,:);

    T = zeros(15);
    T([3,5,6,9,11,12,14,15],:) = -M(:,1:8)\M(:,9:end);
    T([76,92,124,172,188,205,223]) = 1;

    [V,~] = eig(T);
    S = V(12:14,:)./repmat(V(15,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end