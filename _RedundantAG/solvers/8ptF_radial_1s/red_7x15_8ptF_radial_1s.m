% Input: coefficient matrix C of size 2x16
% Output: solution matrix S of size 2x8

function S = red_7x15_8ptF_radial_1s(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7];
    jx = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,6,7,11,13,14,15,3,11,13,14,15,4,5,8,9,10,12,5,6,9,11,12,13,1,2,8,9,10,12,2,3,9,11,12,13];
    kx = [1,3,7,19,25,29,31,5,9,11,15,17,23,21,27,30,32,16,24,22,28,16,24,30,28,32,30,32,16,22,24,28,30,32,16,22,24,28,16,22,24,28,30,32,16,22,24,28,30,32];
    M = sparse(ix,jx,C(kx),7,15);

    [L,~,P] = lu(M(:,1:3));
    P = P';
    M = [P*L P(:,4:end)]\M(:,4:end);
    M = M(end-3:end,:);

    T = zeros(8);
    T([3,5,6,8],:) = -M(:,1:4)\M(:,5:end);
    T([17,34,44,63]) = 1;

    [V,~] = eig(T);
    S = V(6:7,:)./repmat(V(8,:),2,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end