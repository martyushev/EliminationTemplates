% Input: coefficient matrix C of size 4x52
% Output: solution matrix S of size 4x24

function S = red_73x97_colpiv_rdist9p(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73,73];
    jx = [23,24,25,26,27,28,31,40,42,45,62,69,12,13,14,15,21,25,32,39,46,61,62,70,4,5,11,16,23,28,60,63,67,72,17,26,35,41,42,48,63,64,73,6,7,11,15,18,19,61,65,68,74,11,23,25,28,62,64,66,69,75,8,13,15,21,61,65,66,70,77,23,31,38,41,43,45,48,51,60,67,69,80,19,23,30,39,44,46,52,61,68,69,70,81,23,31,40,42,45,47,49,53,62,69,71,82,9,21,32,34,39,46,54,61,62,70,71,83,1,2,3,4,6,10,19,68,72,74,79,84,4,11,23,60,63,67,69,72,73,75,80,85,35,36,41,42,48,49,55,63,64,73,76,86,6,11,19,61,65,68,70,74,75,77,81,87,11,23,62,64,66,69,71,75,76,78,82,88,8,9,21,37,61,65,66,70,77,78,83,89,10,33,44,50,52,56,67,68,79,80,81,90,43,45,48,51,53,55,57,67,69,80,82,91,44,46,52,54,58,68,69,70,81,82,83,92,1,10,68,72,74,79,81,84,85,87,90,93,67,69,72,73,75,80,82,85,86,88,91,94,68,70,74,75,77,81,83,87,88,89,92,95,50,52,56,58,59,79,80,81,90,91,92,96,79,81,84,85,87,90,92,93,94,95,96,97,16,17,22,23,27,28,31,38,41,43,60,67,14,15,18,19,20,23,28,30,39,44,61,68,23,24,25,26,27,28,31,40,42,45,62,69,12,13,14,15,21,25,32,39,46,61,62,70,4,5,11,16,23,28,60,63,67,72,17,26,35,41,42,48,63,64,73,6,7,11,15,18,19,61,65,68,74,11,23,25,28,62,64,66,69,75,8,13,15,21,61,65,66,70,77,3,10,19,29,30,33,44,50,60,67,68,79,23,31,38,41,43,45,48,51,60,67,69,80,19,23,30,39,44,46,52,61,68,69,70,81,23,31,40,42,45,47,49,53,62,69,71,82,9,21,32,34,39,46,54,61,62,70,71,83,1,2,3,4,6,10,19,68,72,74,79,84,4,11,23,60,63,67,69,72,73,75,80,85,35,36,41,42,48,49,55,63,64,73,76,86,6,11,19,61,65,68,70,74,75,77,81,87,11,23,62,64,66,69,71,75,76,78,82,88,8,9,21,37,61,65,66,70,77,78,83,89,10,33,44,50,52,56,67,68,79,80,81,90,43,45,48,51,53,55,57,67,69,80,82,91,44,46,52,54,58,68,69,70,81,82,83,92,1,10,68,72,74,79,81,84,85,87,90,93,67,69,72,73,75,80,82,85,86,88,91,94,68,70,74,75,77,81,83,87,88,89,92,95,50,52,56,58,59,79,80,81,90,91,92,96,79,81,84,85,87,90,92,93,94,95,96,97,4,11,23,41,60,63,67,72,6,11,19,23,61,65,68,74,11,23,42,62,64,66,69,75,8,21,61,62,65,66,70,77,9,34,46,47,54,70,71,83,1,10,67,68,72,74,79,84,48,67,69,72,73,75,80,85,68,69,70,74,75,77,81,87,49,69,71,75,76,78,82,88,9,37,70,71,77,78,83,89,50,51,52,56,79,80,81,90,52,53,54,58,81,82,83,92,79,80,81,84,85,87,90,93,55,80,82,85,86,88,91,94,81,82,83,87,88,89,92,95,56,57,58,59,90,91,92,96,90,91,92,93,94,95,96,97,1,2,3,4,5,6,7,10,11,12,13,14,15,16,17,18,19,20,22,23,24,25,26,27,28,29,30,31,33,38,39,41,43,44,50,60,61,63,65,67,68,72,74,79,84,1,4,6,8,10,11,19,21,23,30,31,32,33,35,38,39,40,41,42,43,44,45,46,48,50,51,52,56,60,61,62,63,64,65,66,67,68,69,70,72,73,74,75,77,79,80,81,84,85,87,90,93,9,34,36,37,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97];
    kx = [189,125,161,153,113,149,173,181,193,201,197,205,125,161,113,149,197,153,181,173,201,189,193,205,189,149,197,113,181,125,173,193,201,205,113,125,193,173,181,201,189,197,205,189,149,193,125,113,173,181,197,201,205,189,173,125,113,181,193,197,201,205,197,125,113,181,173,189,193,201,205,161,125,113,153,173,181,193,201,149,189,197,205,149,153,113,125,173,181,201,161,189,193,197,205,149,113,125,153,173,181,193,201,161,189,197,205,197,161,125,181,113,173,201,149,153,189,193,205,189,149,113,153,161,173,125,181,193,197,201,205,149,161,125,113,153,173,181,189,193,197,201,205,153,193,113,125,173,181,201,149,161,189,197,205,149,153,113,125,161,173,181,189,193,197,201,205,149,113,125,153,161,173,181,189,193,197,201,205,161,181,125,197,113,149,153,173,189,193,201,205,149,113,125,173,181,201,153,161,189,193,197,205,113,125,153,173,181,193,201,149,161,189,197,205,113,125,173,181,201,149,153,161,189,193,197,205,149,113,125,153,161,173,181,189,193,197,201,205,113,125,149,153,161,173,181,189,193,197,201,205,113,125,149,153,161,173,181,189,193,197,201,205,113,125,173,181,201,149,153,161,189,193,197,205,113,125,149,153,161,173,181,189,193,197,201,205,150,154,114,198,126,162,182,174,194,202,190,206,126,162,150,190,114,194,154,174,182,202,198,206,190,126,162,154,114,150,174,182,194,202,198,206,126,162,114,150,198,154,182,174,202,190,194,206,190,150,198,114,182,126,174,194,202,206,114,126,194,174,182,202,190,198,206,190,150,194,126,114,174,182,198,202,206,190,174,126,114,182,194,198,202,206,198,126,114,182,174,190,194,202,206,150,190,162,114,126,174,182,202,154,194,198,206,162,126,114,154,174,182,194,202,150,190,198,206,150,154,114,126,174,182,202,162,190,194,198,206,150,114,126,154,174,182,194,202,162,190,198,206,198,162,126,182,114,174,202,150,154,190,194,206,190,150,114,154,162,174,126,182,194,198,202,206,150,162,126,114,154,174,182,190,194,198,202,206,154,194,114,126,174,182,202,150,162,190,198,206,150,154,114,126,162,174,182,190,194,198,202,206,150,114,126,154,162,174,182,190,194,198,202,206,162,182,126,198,114,150,154,174,190,194,202,206,150,114,126,174,182,202,154,162,190,194,198,206,114,126,154,174,182,194,202,150,162,190,198,206,114,126,174,182,202,150,154,162,190,194,198,206,150,114,126,154,162,174,182,190,194,198,202,206,114,126,150,154,162,174,182,190,194,198,202,206,114,126,150,154,162,174,182,190,194,198,202,206,114,126,174,182,202,150,154,162,190,194,198,206,114,126,150,154,162,174,182,190,194,198,202,206,191,199,183,179,175,195,203,207,191,195,175,179,183,199,203,207,191,175,179,183,195,199,203,207,199,183,175,179,191,195,203,207,199,183,175,179,203,191,195,207,191,175,179,183,195,199,203,207,179,175,183,191,195,199,203,207,175,179,183,191,195,199,203,207,179,175,183,191,195,199,203,207,183,199,175,179,191,195,203,207,175,179,183,203,191,195,199,207,175,179,183,203,191,195,199,207,175,179,183,191,195,199,203,207,179,175,183,191,195,199,203,207,175,179,183,191,195,199,203,207,175,179,183,203,191,195,199,207,175,179,183,191,195,199,203,207,192,152,116,156,80,164,92,176,168,24,56,16,48,28,32,36,128,8,4,132,20,52,44,12,40,60,68,72,140,64,76,124,144,148,188,120,136,160,172,180,184,196,200,204,208,152,80,92,112,116,96,36,56,40,8,12,24,60,88,4,16,20,32,44,64,68,72,76,124,140,144,148,188,28,48,52,84,100,104,108,120,128,132,136,156,160,164,168,172,176,180,184,192,196,200,204,208,56,24,88,112,4,8,12,16,20,32,44,60,64,68,72,76,124,140,144,148,188,28,36,40,48,52,80,84,92,96,100,104,108,116,120,128,132,136,152,156,160,164,168,172,176,180,184,192,196,200,204,208];
    M = sparse(ix,jx,C(kx),73,97);

    [L,~,P] = lu(M(:,1:37));
    P = P';
    M = [P*L P(:,38:end)]\M(:,38:end);
    M = full(M(38:end,:));

    [L,U,P] = lu(M(:,1:22));
    P = P';
    M = [P*L P(:,23:end)]\M(:,23:end);
    M1 = M(1:22,:);
    M2 = M(23:end,:);

    [Q,R,P] = qr(M2(:,1:end-5));
    A = U\[M1(:,1:end-5)*P M1(:,end-4:end)];
    B = R(:,1:14)\[R(:,15:end) Q'*M2(:,end-4:end)];
    M = [-A(:,end-23:end)+A(:,1:end-24)*B; -B];

    P1 = [39:60 (1:33)*P 34:38];
    P2 = [39,40,41,42,43,2,3,44,45,46,47,48,8,49,9,10,50,11,12,51,52,53,54,55,20,21,56,22,23,24,57,58,59,31,32,33,60,37];
    T = getT(M,P1(1:end-24),P1(end-23:end),P2);

    [V,~] = eig(T);
    S = V(20:23,:)./repmat(V(24,:),4,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end