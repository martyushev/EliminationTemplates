% Input: coefficient matrix C of size 7x22
% Output: solution matrix S of size 3x12

function S = red_14x26_relpose_7p_fuv_angle(C)

    ix = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14];
    jx = [3,6,7,8,9,10,11,12,13,14,15,18,20,21,22,23,24,25,26,3,6,7,8,9,10,11,12,13,14,17,18,20,21,22,23,24,25,26,6,7,8,10,11,12,13,14,18,19,20,21,23,24,25,26,5,9,10,11,12,13,14,15,16,17,19,20,22,24,3,4,17,18,19,20,21,22,23,24,25,26,5,9,10,11,12,13,14,15,19,20,22,24,1,9,10,11,12,16,17,20,7,8,10,12,13,14,19,23,24,26,9,10,11,12,13,14,16,19,20,24,5,6,7,11,13,21,22,25,1,2,15,16,17,19,20,22,24,6,7,8,10,11,12,13,14,20,21,23,24,25,26,4,16,17,18,19,20,21,22,23,24,25,26,2,9,10,11,12,16,17,20];
    kx = [1,120,141,148,29,57,78,99,113,134,8,36,50,64,71,85,92,106,127,3,122,143,150,31,59,80,101,115,136,24,38,52,66,73,87,94,108,129,123,144,151,60,81,102,116,137,39,46,53,67,88,95,109,130,67,60,102,116,137,144,151,39,46,53,88,95,109,130,40,68,61,89,96,103,110,117,131,138,145,152,68,61,103,117,138,145,152,40,89,96,110,131,40,103,138,145,152,89,96,131,146,153,62,104,118,139,48,90,97,132,62,104,118,139,146,153,48,90,97,132,48,146,153,104,139,90,97,132,48,62,90,97,104,132,139,146,153,126,147,154,63,84,105,119,140,56,70,91,98,112,133,70,56,63,91,98,105,112,119,133,140,147,154,56,105,140,147,154,91,98,133];
    M = sparse(ix,jx,C(kx),14,26);

    [L,~,P] = lu(M(:,1:8));
    P = P';
    M = [P*L P(:,9:end)]\M(:,9:end);
    M = M(end-5:end,:);

    T = zeros(12);
    T([3,6,8,10,11,12],:) = -M(:,1:6)\M(:,7:end);
    T([13,26,52,65,91,117]) = 1;

    [V,~] = eig(T);
    S = V(9:11,:)./repmat(V(12,:),3,1);

    I = ~isnan(S(1,:)) & ~isinf(S(1,:));
    %I = I & ~imag(S(1,:)); % uncomment this line for real roots only
    S = S(:,I);

end