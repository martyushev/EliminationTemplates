function C = coefs_relpose_4pt(data)

    x1 = data{1};
    x2 = data{2};
    th = data{3};
    sth = sin(th);
    cth = cos(th);

    C = zeros(5,28);

    C(140) = -1;
    C([65,85,110]) = 1;
    C(121) = x1(1)*sth;
    C(126) = x1(2)*sth;
    C(122) = x1(3)*sth;
    C(127) = x1(4)*sth;
    C(123) = x1(5)*sth;
    C(128) = x1(6)*sth;
    C(124) = x1(7)*sth;
    C(129) = x1(8)*sth;
    C(86) = x2(1)*sth;
    C(91) = x2(2)*sth;
    C(87) = x2(3)*sth;
    C(92) = x2(4)*sth;
    C(88) = x2(5)*sth;
    C(93) = x2(6)*sth;
    C(89) = x2(7)*sth;
    C(94) = x2(8)*sth;
    C(66) = x2(1)*x1(2)*sth;
    C(56) = x2(2)*x1(1)*sth;
    C(67) = x2(3)*x1(4)*sth;
    C(57) = x2(4)*x1(3)*sth;
    C(68) = x2(5)*x1(6)*sth;
    C(58) = x2(6)*x1(5)*sth;
    C(69) = x2(7)*x1(8)*sth;
    C(59) = x2(8)*x1(7)*sth;
    C(116) = x1(1)*cth-x2(1)*cth;
    C(6) = -x2(1)*cth+x2(1);
    C(21) = -x2(1)*x1(2)+x2(1)*x1(2)*cth;
    C(61) = x2(1)*x1(2)-x2(1)*x1(2)*cth;
    C(111) = x2(2)*cth-x1(2)*cth;
    C(11) = x2(2)*cth-x2(2);
    C(81) = -x2(2)*x1(1)+x2(2)*x1(1)*cth;
    C(36) = x2(2)*x1(1)-x2(2)*x1(1)*cth;
    C(117) = -x2(3)*cth+x1(3)*cth;
    C(7) = -x2(3)*cth+x2(3);
    C(22) = -x2(3)*x1(4)+x2(3)*x1(4)*cth;
    C(62) = x2(3)*x1(4)-x2(3)*x1(4)*cth;
    C(112) = x2(4)*cth-x1(4)*cth;
    C(12) = x2(4)*cth-x2(4);
    C(82) = -x2(4)*x1(3)+x2(4)*x1(3)*cth;
    C(37) = x2(4)*x1(3)-x2(4)*x1(3)*cth;
    C(118) = -x2(5)*cth+x1(5)*cth;
    C(8) = -x2(5)*cth+x2(5);
    C(23) = -x2(5)*x1(6)+x2(5)*x1(6)*cth;
    C(63) = x2(5)*x1(6)-x2(5)*x1(6)*cth;
    C(113) = x2(6)*cth-x1(6)*cth;
    C(13) = x2(6)*cth-x2(6);
    C(83) = -x2(6)*x1(5)+x2(6)*x1(5)*cth;
    C(38) = x2(6)*x1(5)-x2(6)*x1(5)*cth;
    C(119) = -x2(7)*cth+x1(7)*cth;
    C(9) = -x2(7)*cth+x2(7);
    C(24) = -x2(7)*x1(8)+x2(7)*x1(8)*cth;
    C(64) = x2(7)*x1(8)-x2(7)*x1(8)*cth;
    C(114) = x2(8)*cth-x1(8)*cth;
    C(14) = x2(8)*cth-x2(8);
    C(84) = -x2(8)*x1(7)+x2(8)*x1(7)*cth;
    C(39) = x2(8)*x1(7)-x2(8)*x1(7)*cth;
    C(131) = -x2(1)*x1(1)*sth-x2(2)*x1(2)*sth;
    C(71) = -x2(1)*x1(1)*sth-sth;
    C(136) = -x2(2)*x1(1)*cth+x2(1)*x1(2)*cth;
    C(51) = -x2(2)*x1(2)*sth-sth;
    C(132) = -x2(3)*x1(3)*sth-x2(4)*x1(4)*sth;
    C(72) = -x2(3)*x1(3)*sth-sth;
    C(137) = x2(3)*x1(4)*cth-x2(4)*x1(3)*cth;
    C(52) = -x2(4)*x1(4)*sth-sth;
    C(133) = -x2(5)*x1(5)*sth-x2(6)*x1(6)*sth;
    C(73) = -x2(5)*x1(5)*sth-sth;
    C(138) = x2(5)*x1(6)*cth-x2(6)*x1(5)*cth;
    C(53) = -x2(6)*x1(6)*sth-sth;
    C(134) = -x2(7)*x1(7)*sth-x2(8)*x1(8)*sth;
    C(74) = -x2(7)*x1(7)*sth-sth;
    C(139) = x2(7)*x1(8)*cth-x2(8)*x1(7)*cth;
    C(54) = -x2(8)*x1(8)*sth-sth;
    C(101) = -x1(1)+x1(1)*cth;
    C(46) = x1(1)-x1(1)*cth;
    C(41) = -x1(2)+x1(2)*cth;
    C(96) = x1(2)-x1(2)*cth;
    C(102) = -x1(3)+x1(3)*cth;
    C(47) = x1(3)-x1(3)*cth;
    C(42) = -x1(4)+x1(4)*cth;
    C(97) = x1(4)-x1(4)*cth;
    C(103) = -x1(5)+x1(5)*cth;
    C(48) = x1(5)-x1(5)*cth;
    C(43) = -x1(6)+x1(6)*cth;
    C(98) = x1(6)-x1(6)*cth;
    C(104) = -x1(7)+x1(7)*cth;
    C(49) = x1(7)-x1(7)*cth;
    C(44) = -x1(8)+x1(8)*cth;
    C(99) = x1(8)-x1(8)*cth;
    C(1) = -x2(1)+x2(1)*cth;
    C(16) = x2(2)-x2(2)*cth;
    C(2) = -x2(3)+x2(3)*cth;
    C(17) = x2(4)-x2(4)*cth;
    C(3) = -x2(5)+x2(5)*cth;
    C(18) = x2(6)-x2(6)*cth;
    C(4) = -x2(7)+x2(7)*cth;
    C(19) = x2(8)-x2(8)*cth;
    C(26) = x2(1)*x1(1)-1+cth-x2(1)*x1(1)*cth;
    C(31) = -x2(2)*x1(2)+1-cth+x2(2)*x1(2)*cth;
    C(27) = x2(3)*x1(3)-1+cth-x2(3)*x1(3)*cth;
    C(32) = -x2(4)*x1(4)+1-cth+x2(4)*x1(4)*cth;
    C(28) = x2(5)*x1(5)-1+cth-x2(5)*x1(5)*cth;
    C(33) = -x2(6)*x1(6)+1-cth+x2(6)*x1(6)*cth;
    C(29) = x2(7)*x1(7)-1+cth-x2(7)*x1(7)*cth;
    C(34) = -x2(8)*x1(8)+1-cth+x2(8)*x1(8)*cth;
    C(76) = -x2(2)*x1(2)*cth+x2(1)*x1(1)*cth-x2(1)*x1(1)+x2(2)*x1(2);
    C(77) = x2(3)*x1(3)*cth-x2(4)*x1(4)*cth-x2(3)*x1(3)+x2(4)*x1(4);
    C(78) = x2(5)*x1(5)*cth-x2(6)*x1(6)*cth-x2(5)*x1(5)+x2(6)*x1(6);
    C(79) = -x2(8)*x1(8)*cth+x2(7)*x1(7)*cth-x2(7)*x1(7)+x2(8)*x1(8);

    C = C./repmat(sqrt(sum(C.^2,2)),1,size(C,2));

end