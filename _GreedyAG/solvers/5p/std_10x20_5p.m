% Input: coefficient matrix C of size 10x20

function [x,y,z] = std_10x20_5p(C)

    i_dx = [1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10];
    j_dx = [1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20];
    C_dx = [31,61,81,91,1,11,21,41,51,71,101,111,121,131,141,151,161,171,181,191,32,62,82,92,2,12,22,42,52,72,102,112,122,132,142,152,162,172,182,192,33,63,83,93,3,13,23,43,53,73,103,113,123,133,143,153,163,173,183,193,34,64,84,94,4,14,24,44,54,74,104,114,124,134,144,154,164,174,184,194,35,65,85,95,5,15,25,45,55,75,105,115,125,135,145,155,165,175,185,195,36,66,86,96,6,16,26,46,56,76,106,116,126,136,146,156,166,176,186,196,37,67,87,97,7,17,27,47,57,77,107,117,127,137,147,157,167,177,187,197,38,68,88,98,8,18,28,48,58,78,108,118,128,138,148,158,168,178,188,198,39,69,89,99,9,19,29,49,59,79,109,119,129,139,149,159,169,179,189,199,40,70,90,100,10,20,30,50,60,80,110,120,130,140,150,160,170,180,190,200];
    M = sparse(i_dx,j_dx,C(C_dx),10,20);

    [L,~,Pi] = lu(M(:,1:4));
    Pi = Pi';
    M = [Pi*L Pi(:,5:end)]\M(:,5:end);
    M = M(end-5:end,:);

    T = zeros(10);
    T(1:6,:) = -M(:,1:6)\M(:,7:end);
    T([7,18,39,70]) = 1;

    [V,D] = eig(T);
    sol = [V(8:9,:)./repmat(V(10,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    y = sol(1,I);
    z = sol(2,I);
    x = sol(3,I);

end