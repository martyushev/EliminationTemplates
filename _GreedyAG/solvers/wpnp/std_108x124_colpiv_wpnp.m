% Input: coefficient matrix C of size 4x24

function [w1,y1,z1] = std_108x124_colpiv_wpnp(C)

    i_dx = [1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,22,22,22,22,22,22,22,23,23,23,23,24,24,24,24,24,24,24,25,25,25,25,25,25,25,26,26,26,26,26,26,27,27,27,27,27,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,39,39,39,39,39,39,40,40,40,40,40,40,40,41,41,41,41,41,41,41,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,51,51,51,51,51,51,52,52,52,52,53,53,53,53,53,53,53,54,54,54,54,54,54,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,76,76,76,76,76,76,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,79,79,79,79,79,79,79,80,80,80,80,80,81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,95,95,95,95,95,95,96,96,96,96,96,96,96,97,97,97,97,97,97,97,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,100,100,100,100,100,100,100,100,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,103,104,104,104,104,104,104,104,105,105,105,105,105,105,105,106,106,106,106,106,106,106,107,107,107,107,107,108,108,108,108,108];
    j_dx = [1,3,12,32,50,71,73,80,99,19,21,31,51,62,95,96,99,106,6,8,15,36,54,78,80,84,92,24,26,35,55,70,90,92,99,109,43,45,54,72,88,105,106,109,115,2,4,13,33,51,73,75,82,100,20,22,32,52,64,96,97,100,107,7,9,16,37,55,80,82,85,102,25,27,36,56,72,99,100,102,110,44,46,55,74,89,106,107,110,116,11,13,40,58,84,85,93,30,32,39,59,79,92,93,102,112,49,51,58,81,91,109,110,112,118,3,5,14,34,52,75,77,83,101,21,23,33,53,66,97,98,101,108,8,10,17,38,56,82,83,103,26,28,37,57,74,100,101,103,111,45,47,56,76,107,108,111,117,12,14,18,41,59,85,104,31,33,40,60,81,102,103,104,113,50,52,59,110,111,113,119,62,66,81,116,117,119,122,15,17,42,94,35,37,61,93,94,104,114,54,56,86,112,113,114,120,70,74,118,119,120,123,88,121,122,123,124,25,43,45,54,87,88,90,95,105,3,20,22,32,63,64,65,73,96,8,25,27,36,71,72,73,80,99,26,44,46,55,89,95,96,99,106,12,30,32,39,78,79,80,84,92,31,49,51,58,90,91,92,99,109,4,21,23,33,65,66,67,75,97,9,26,28,37,73,74,75,82,100,27,45,47,56,96,97,100,107,32,50,52,59,99,100,102,110,51,62,66,81,106,107,110,116,16,35,37,84,85,93,36,54,56,92,93,102,112,55,70,74,109,110,112,118,72,88,115,116,118,121,10,27,29,38,75,76,77,83,101,28,46,48,57,97,98,101,108,14,32,34,41,82,83,103,33,51,53,60,100,101,103,111,52,64,68,107,108,111,117,17,36,38,42,85,86,104,37,55,57,61,102,103,104,113,56,72,76,86,110,111,113,119,74,89,116,117,119,122,18,39,41,94,40,58,60,93,94,104,114,59,79,112,113,114,120,81,91,118,119,120,123,1,3,12,30,50,69,71,78,90,19,21,31,49,62,87,90,95,105,2,4,13,31,51,71,73,80,99,20,22,32,50,64,95,96,99,106,7,9,16,35,55,78,80,84,92,25,27,36,54,72,90,92,99,109,44,46,55,70,89,105,106,109,115,3,5,14,32,52,73,75,82,100,21,23,33,51,66,96,97,100,107,8,10,17,36,56,80,82,85,102,26,28,37,55,74,99,100,102,110,45,47,56,72,106,107,110,116,12,14,18,39,59,84,85,93,31,33,40,58,81,92,93,102,112,50,52,59,79,109,110,112,118,62,66,81,91,115,116,118,121,27,29,38,56,76,100,101,103,111,46,48,57,74,107,108,111,117,32,34,41,59,102,103,104,113,51,53,60,81,110,111,113,119,64,68,116,117,119,122,36,38,42,86,93,94,104,114,55,57,61,112,113,114,120,72,76,86,118,119,120,123,89,121,122,123,124,6,8,15,25,54,69,71,78,90,24,26,35,44,70,87,90,95,105,2,4,13,21,51,63,65,73,96,7,9,16,26,55,71,73,80,99,25,27,36,45,72,95,96,99,106,11,13,31,58,78,80,84,92,30,32,39,50,79,90,92,99,109,49,51,58,62,91,105,106,109,115,3,5,14,22,52,65,67,75,97,8,10,17,27,56,73,75,82,100,26,28,37,46,74,96,97,100,107,12,14,18,32,59,80,82,85,102,31,33,40,51,81,99,100,102,110,50,52,59,64,106,107,110,116,15,17,36,84,85,93,35,37,55,92,93,102,112,54,56,72,109,110,112,118,70,74,89,115,116,118,121,27,29,38,47,76,97,98,101,108,32,34,41,52,100,101,103,111,51,53,60,66,107,108,111,117,36,38,42,56,86,102,103,104,113,55,57,61,74,110,111,113,119,72,76,86,116,117,119,122,39,41,59,93,94,104,114,58,60,81,112,113,114,120,79,118,119,120,123,91,121,122,123,124];
    C_dx = [1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,89,85,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,57,65,77,85,93,1,9,29,57,65,77,89,85,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,93,1,9,29,57,65,77,85,89,93,1,9,29,57,77,85,89,93,1,9,29,57,65,77,93,1,9,29,57,65,77,85,89,93,1,9,29,77,85,89,93,1,9,29,77,85,89,93,1,9,57,93,1,9,57,77,89,85,93,1,9,57,77,85,89,93,1,9,77,85,89,93,1,77,85,89,93,22,42,50,62,78,82,90,86,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,82,78,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,90,86,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,78,86,94,22,42,50,78,90,86,94,22,42,50,78,86,90,94,22,42,78,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,94,22,42,50,62,78,86,90,94,22,42,50,78,86,90,94,22,42,50,62,78,82,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,78,86,90,94,22,42,50,94,22,42,50,78,90,86,94,22,42,78,86,90,94,22,42,78,86,90,94,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,91,87,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,91,87,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,71,79,87,95,7,15,35,55,71,79,91,87,95,7,15,35,55,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,79,87,91,95,7,15,79,87,91,95,7,15,35,71,79,91,87,95,7,15,35,79,87,91,95,7,15,35,79,87,91,95,7,79,87,91,95,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,92,88,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,48,76,80,88,92,96,20,28,40,48,76,80,92,88,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,80,88,92,96,20,28,48,80,88,96,20,28,48,80,92,88,96,20,28,48,80,88,92,96,20,28,48,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,80,88,92,96,20,28,40,48,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,80,88,92,96,20,28,40,80,88,92,96,20,28,48,80,92,88,96,20,28,48,80,88,92,96,20,80,88,92,96,20,80,88,92,96];
    M = sparse(i_dx,j_dx,C(C_dx),108,124);

    [L,~,Pi] = lu(M(:,1:94));
    Pi = Pi';
    M = [Pi*L Pi(:,95:end)]\M(:,95:end);
    M = full(M(95:end,:));

    [L,UR,Pi] = lu(M(:,1:10));
    Pi = Pi';
    M = [Pi*L Pi(:,11:end)]\M(:,11:end);
    MP = M(1:10,:);
    NP = M(11:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-4));
    A = UR\[MP(:,1:end-4)*Pi MP(:,end-3:end)];
    B = U(:,1:4)\[U(:,5:end) Q'*NP(:,end-3:end)];
    M = [-A(:,end-15:end)+A(:,1:end-16)*B; -B];

    xP = [21,22,23,24,25,26,27,28,29,30,2,3,4,6,7,9,12,13,15,18];
    P1 = [(1:16)*Pi 17:20];
    T = getT(M,[21:30 P1(1:end-16)],P1(end-15:end),xP);

    [V,D] = eig(T);
    sol = [V([13,15],:)./repmat(V(16,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    w1 = sol(1,I);
    z1 = sol(2,I);
    y1 = sol(3,I);

end