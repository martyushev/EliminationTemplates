% Input: coefficient matrix C of size 4x18

function [w,x,y,z] = std_65x85_colpiv_pose_quiver(C)

    i_dx = [1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,65];
    j_dx = [9,16,52,54,55,57,60,62,65,73,11,18,53,55,56,58,62,64,67,75,3,5,8,20,21,27,37,39,57,58,59,69,12,15,19,55,57,58,59,65,67,69,77,22,27,62,65,67,69,73,75,77,81,10,17,25,28,32,40,43,60,61,63,66,74,31,33,37,41,43,44,45,48,62,63,68,76,13,20,28,29,35,43,45,65,66,68,70,78,51,53,57,63,66,68,70,73,74,76,78,82,34,36,39,44,45,46,47,49,67,68,71,79,42,48,49,50,52,58,68,71,75,76,79,83,17,21,29,30,38,45,47,69,70,71,72,80,54,56,59,68,70,71,72,77,78,79,80,84,60,64,69,76,78,79,80,81,82,83,84,85,1,32,34,35,37,52,53,55,62,3,14,17,20,34,37,54,55,57,65,2,33,35,36,38,42,53,56,64,4,15,35,37,38,39,55,56,58,67,14,53,55,56,58,62,64,67,75,6,18,20,21,37,39,57,58,59,69,16,26,55,57,58,59,65,67,69,77,24,62,65,67,69,73,75,77,81,13,25,28,40,43,52,61,63,66,74,34,41,43,44,45,48,53,63,68,76,17,28,29,43,45,55,66,68,70,78,54,62,63,66,68,70,74,76,78,82,37,44,45,46,47,49,56,68,71,79,48,49,50,55,64,68,71,76,79,83,20,29,30,45,47,58,70,71,72,80,57,67,68,70,71,72,78,79,80,84,65,75,76,78,79,80,82,83,84,85,1,9,13,17,31,34,51,52,54,60,2,11,32,34,35,37,52,53,55,62,4,12,17,20,34,37,54,55,57,65,14,22,52,54,55,57,60,62,65,73,5,14,35,37,38,39,55,56,58,67,15,23,53,55,56,58,62,64,67,75,7,16,20,21,37,39,57,58,59,69,18,24,55,57,58,59,65,67,69,77,26,62,65,67,69,73,75,77,81,25,28,34,40,43,51,61,63,66,74,35,41,43,44,45,48,52,63,68,76,28,29,37,43,45,54,66,68,70,78,55,60,63,66,68,70,74,76,78,82,38,44,45,46,47,49,55,68,71,79,48,49,50,56,62,68,71,76,79,83,29,30,39,45,47,57,70,71,72,80,58,65,68,70,71,72,78,79,80,84,67,73,76,78,79,80,82,83,84,85,3,4,5,6,7,8,16,18,19,27,22,23,24,26,27,10,13,17,31,32,34,51,52,54,60,31,32,33,34,35,37,52,53,55,62,13,17,20,34,35,37,54,55,57,65,51,52,53,54,55,57,60,62,65,73,34,35,36,37,38,39,55,56,58,67,42,52,53,55,56,58,62,64,67,75,17,20,21,37,38,39,57,58,59,69,54,55,56,57,58,59,65,67,69,77,60,62,64,65,67,69,73,75,77,81,25,28,29,43,44,45,66,68,70,78,48,61,63,66,68,70,74,76,78,82,28,29,30,45,46,47,70,71,72,80,49,66,68,70,71,72,78,79,80,84,50,74,76,78,79,80,82,83,84,85];
    C_dx = [1,17,33,41,45,49,57,61,65,69,1,17,33,41,45,49,57,61,65,69,1,5,17,41,49,53,33,45,57,61,65,69,1,5,17,33,41,45,49,57,61,65,69,1,17,33,41,45,49,57,61,65,69,1,17,41,49,5,33,45,53,57,61,65,69,1,5,17,33,41,45,49,61,53,57,65,69,1,17,41,49,5,33,45,53,57,61,65,69,1,5,17,33,41,45,49,53,57,61,65,69,1,5,17,33,41,45,49,61,53,57,65,69,5,33,45,61,1,17,41,49,53,57,65,69,1,17,41,49,5,33,45,53,57,61,65,69,1,5,17,33,41,45,49,53,57,61,65,69,1,5,17,33,41,45,49,53,57,61,65,69,10,34,42,46,50,58,62,66,70,10,30,42,50,34,46,58,62,66,70,10,34,42,46,50,62,58,66,70,10,30,34,42,46,50,58,62,66,70,10,34,42,46,50,58,62,66,70,10,30,42,50,34,46,58,62,66,70,10,30,34,42,46,50,58,62,66,70,10,34,42,46,50,58,62,66,70,10,42,50,34,46,30,58,62,66,70,10,34,42,46,50,62,30,58,66,70,10,42,50,34,46,30,58,62,66,70,10,30,34,42,46,50,58,62,66,70,10,34,42,46,50,62,30,58,66,70,34,46,62,10,30,42,50,58,66,70,10,42,50,34,46,30,58,62,66,70,10,30,34,42,46,50,58,62,66,70,10,30,34,42,46,50,58,62,66,70,15,23,43,51,35,47,59,63,67,71,15,23,35,43,47,51,59,63,67,71,15,23,43,51,35,47,59,63,67,71,15,23,35,43,47,51,59,63,67,71,15,23,35,43,47,51,59,63,67,71,15,23,35,43,47,51,59,63,67,71,15,23,43,51,35,47,59,63,67,71,15,23,35,43,47,51,59,63,67,71,15,35,43,47,51,59,63,67,71,43,51,15,35,47,23,59,63,67,71,15,35,43,47,51,63,23,59,67,71,43,51,15,35,47,23,59,63,67,71,15,23,35,43,47,51,59,63,67,71,15,35,43,47,51,63,23,59,67,71,35,47,63,15,23,43,51,59,67,71,43,51,15,35,47,23,59,63,67,71,15,23,35,43,47,51,59,63,67,71,15,23,35,43,47,51,59,63,67,71,28,36,40,44,48,52,60,64,68,72,28,36,44,48,52,28,44,52,36,40,48,60,64,68,72,28,36,40,44,48,52,60,64,68,72,28,44,52,36,40,48,60,64,68,72,28,36,40,44,48,52,60,64,68,72,28,36,40,44,48,52,60,64,68,72,40,28,36,44,48,52,60,64,68,72,28,44,52,36,40,48,60,64,68,72,28,36,40,44,48,52,60,64,68,72,28,36,40,44,48,52,60,64,68,72,28,44,52,36,40,48,60,64,68,72,40,28,36,44,48,52,60,64,68,72,28,44,52,36,40,48,60,64,68,72,40,28,36,44,48,52,60,64,68,72,40,28,36,44,48,52,60,64,68,72];
    M = sparse(i_dx,j_dx,C(C_dx),65,85);

    [L,~,Pi] = lu(M(:,1:30));
    Pi = Pi';
    M = [Pi*L Pi(:,31:end)]\M(:,31:end);
    M = full(M(31:end,:));

    [L,UR,Pi] = lu(M(:,1:20));
    Pi = Pi';
    M = [Pi*L Pi(:,21:end)]\M(:,21:end);
    MP = M(1:20,:);
    NP = M(21:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-5));
    A = UR\[MP(:,1:end-5)*Pi MP(:,end-4:end)];
    B = U(:,1:15)\[U(:,16:end) Q'*NP(:,end-4:end)];
    M = [-A(:,end-19:end)+A(:,1:end-20)*B; -B];

    xP = [36,37,38,39,40,41,42,43,44,2,45,3,46,47,5,48,6,49,8,50,51,52,12,13,14,53,17,18,54,21,25,26,55,29,33];
    P1 = [(1:30)*Pi 31:35];
    T = getT(M,[36:55 P1(1:end-20)],P1(end-19:end),xP);

    [V,D] = eig(T);
    sol = [V([16,17,19],:)./repmat(V(20,:),3,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    w = sol(1,I);
    x = sol(2,I);
    z = sol(3,I);
    y = sol(4,I);

end