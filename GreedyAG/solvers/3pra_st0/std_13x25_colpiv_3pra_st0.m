% Input: coefficient matrix C of size 7x35

function [u,v,w] = std_13x25_colpiv_3pra_st0(C)

    i_dx = [1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23];
    j_dx = [1,3,6,10,2,13,17,27,4,11,15,29,7,20,24,32,3,14,18,28,5,16,19,30,8,21,25,33,6,12,18,31,9,23,26,34,10,28,31,35,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,1,2,3,4,5,6,7,8,9,10,11,13,15,17,20,22,24,27,29,2,3,5,8,13,14,15,16,17,18,19,20,21,22,23,25,27,28,30,4,5,6,9,11,12,15,16,17,18,19,22,23,24,25,26,29,30,31,7,8,9,10,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,1,2,3,4,5,6,7,8,9,10,11,13,15,17,20,22,24,27,29,2,3,5,8,13,14,15,16,17,18,19,20,21,22,23,25,27,28,30,4,5,6,9,11,12,15,16,17,18,19,22,23,24,25,26,29,30,31,7,8,9,10,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,1,2,3,4,5,6,7,8,9,10,11,13,15,17,20,22,24,27,29,2,3,5,8,13,14,15,16,17,18,19,20,21,22,23,25,27,28,30,4,5,6,9,11,12,15,16,17,18,19,22,23,24,25,26,29,30,31,7,8,9,10,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34];
    C_dx = [182,196,217,245,182,196,217,245,182,217,196,245,182,196,217,245,182,196,217,245,182,196,217,245,182,196,217,245,182,217,196,245,182,196,217,245,182,196,217,245,1,8,15,36,43,64,106,113,134,176,85,99,22,29,50,57,71,78,92,120,127,141,148,155,162,169,183,190,197,204,211,218,225,232,239,109,116,123,137,144,158,179,186,200,221,172,130,151,165,193,207,214,228,235,109,116,137,179,123,130,144,151,158,165,172,186,193,200,207,214,221,228,235,109,116,137,179,158,172,123,130,144,151,165,186,193,200,207,214,221,228,235,109,116,137,179,123,130,144,151,158,165,172,186,193,200,207,214,221,228,235,110,117,124,138,145,159,180,187,201,222,173,131,152,166,194,208,215,229,236,110,117,138,180,124,131,145,152,159,166,173,187,194,201,208,215,222,229,236,110,117,138,180,159,173,124,131,145,152,166,187,194,201,208,215,222,229,236,110,117,138,180,124,131,145,152,159,166,173,187,194,201,208,215,222,229,236,111,118,125,139,146,160,181,188,202,223,174,132,153,167,195,209,216,230,237,111,118,139,181,125,132,146,153,160,167,174,188,195,202,209,216,223,230,237,111,118,139,181,160,174,125,132,146,153,167,188,195,202,209,216,223,230,237,111,118,139,181,125,132,146,153,160,167,174,188,195,202,209,216,223,230,237];
    M = sparse(i_dx,j_dx,C(C_dx),23,35);

    M = M(11:end,11:end)-(M(11:end,1:10)/M(1:10,1:10))*M(1:10,11:end); % Schur complement reduction

    [L,~,Pi] = lu(M(:,1:2));
    Pi = Pi';
    M = [Pi*L Pi(:,3:end)]\M(:,3:end);
    M = full(M(3:end,:));

    [L,UR,Pi] = lu(M(:,1:7));
    Pi = Pi';
    M = [Pi*L Pi(:,8:end)]\M(:,8:end);
    MP = M(1:7,:);
    NP = M(8:end,:);

    [Q,U,Pi] = qr(NP(:,1:end-4));
    A = UR\[MP(:,1:end-4)*Pi MP(:,end-3:end)];
    B = U(:,1:4)\[U(:,5:end) Q'*NP(:,end-3:end)];
    M = [-A(:,end-11:end)+A(:,1:end-12)*B; -B];

    xP = [17,18,19,20,21,22,23,1,2,3,4,6,8,9,11,14];
    P1 = [(1:12)*Pi 13:16];
    T = getT(M,[17:23 P1(1:end-12)],P1(end-11:end),xP);

    [V,D] = eig(T);
    sol = [V([9,11],:)./repmat(V(12,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    u = sol(1,I);
    w = sol(2,I);
    v = sol(3,I);

end