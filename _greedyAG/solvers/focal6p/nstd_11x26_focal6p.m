% Input: coefficient matrix C of size 10x26

% Monomial vector: [g^2*u^2, g*u^3, g^2*u*v, g*u^2*v, g^2*v^2, v^2*u*g, v^3*g, u*g^2, u^2*g, u^3, v*g^2, g*u*v, v*u^2, g*v^2, v^2*u, v^3, g^2, g*u, u^2, g*v, v*u, v^2, g, u, v, 1]

function [g, u, v] = nstd_11x26_focal6p(C)

    i_dx = [1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 6, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 8, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 11, 11, 11, 11, 11, 11, 11, 11, 11, 11];
    j_dx = [1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 2, 3, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 1, 2, 3, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 2, 3, 5, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 2, 3, 7, 8, 9, 10, 11, 13, 14, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 3, 5, 7, 8, 9, 10, 11, 12, 13, 15, 16, 17, 18, 19, 21, 22, 23, 24, 25, 3, 9, 10, 11, 13, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 2, 5, 7, 8, 13, 15, 16, 21, 22, 23, 3, 9, 10, 11, 17, 18, 19, 24, 25, 26];
    C_dx = [41, 61, 151, 11, 21, 31, 51, 91, 121, 141, 71, 81, 101, 111, 131, 181, 201, 211, 161, 171, 191, 221, 231, 241, 251, 62, 152, 2, 12, 22, 32, 52, 92, 122, 142, 72, 82, 102, 112, 132, 182, 202, 212, 162, 172, 192, 222, 232, 242, 252, 63, 153, 13, 33, 53, 93, 123, 143, 73, 83, 103, 113, 133, 183, 203, 213, 163, 173, 193, 223, 233, 243, 253, 44, 64, 154, 14, 24, 34, 54, 94, 124, 144, 74, 84, 104, 114, 134, 184, 204, 214, 164, 174, 194, 224, 234, 244, 254, 65, 155, 5, 15, 25, 35, 55, 95, 125, 145, 75, 85, 105, 115, 135, 185, 205, 215, 165, 175, 195, 225, 235, 245, 255, 66, 156, 16, 36, 56, 96, 126, 146, 76, 86, 106, 116, 136, 186, 206, 216, 166, 176, 196, 226, 236, 246, 256, 67, 157, 37, 57, 97, 127, 147, 87, 107, 117, 137, 187, 207, 217, 177, 197, 227, 237, 247, 158, 18, 38, 58, 98, 128, 148, 78, 88, 118, 138, 188, 208, 218, 178, 198, 228, 238, 248, 159, 99, 129, 149, 89, 119, 139, 189, 209, 219, 169, 179, 199, 229, 239, 249, 259, 160, 100, 130, 150, 190, 210, 220, 240, 250, 260, 160, 100, 130, 150, 190, 210, 220, 240, 250, 260];
    M = full(sparse(i_dx,j_dx,C(C_dx),11,26));

    [L,~,Pi] = lu(M(:,1:3));
    Pi = Pi';
    M = [Pi*L Pi(:,4:end)]\M(:,4:end);
    M = M(end-7:end,:);

    T = zeros(15);
    T(1:8,:) = -M(:,1:8)\M(:,9:end);
    T([9, 25, 56, 147, 88, 104, 195]) = 1;

    [V,D] = eig(T);
    sol = [V([12, 14],:)./repmat(V(15,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))) & not(imag(sol(1,:))) & sol(1,:) > 0);
    g = sol(1,I);
    v = sol(2,I);
    u = sol(3,I);

end