% Input: coefficient matrix C of size 3x10

function [x,y,z] = std_14x22_toy(C)

    i_dx = [1,1,1,1,2,2,2,2,3,3,3,4,4,4,4,5,5,5,5,6,6,6,6,7,7,7,8,8,8,9,9,9,10,10,10,10,11,11,11,11,12,12,12,13,13,14,14,14];
    j_dx = [2,5,10,17,10,11,15,20,3,7,18,7,12,14,21,8,9,10,19,14,17,19,22,1,2,16,4,5,15,6,12,20,8,11,13,21,9,16,18,22,1,3,20,4,19,6,13,22];
    C_dx = [13,19,25,28,19,13,25,28,13,25,28,19,13,25,28,19,25,13,28,19,13,25,28,11,17,29,11,17,29,11,17,29,23,11,17,29,23,11,17,29,3,6,30,3,30,3,6,30];
    M = sparse(i_dx,j_dx,C(C_dx),14,22);

    [L,~,Pi] = lu(M(:,1:9));
    Pi = Pi';
    M = [Pi*L Pi(:,10:end)]\M(:,10:end);
    M = M(end-4:end,:);

    T = zeros(8);
    T(1:5,:) = -M(:,1:5)\M(:,6:end);
    T([22,31,56]) = 1;

    [V,D] = eig(T);
    sol = [V([6,5],:)./repmat(V(8,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    x = sol(1,I);
    z = sol(2,I);
    y = sol(3,I);

end