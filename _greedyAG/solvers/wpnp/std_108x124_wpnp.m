% Input: coefficient matrix C of size 4x24

function [w1,y1,z1] = std_108x124_wpnp(C)

    i_dx = [1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,22,22,22,22,22,22,22,23,23,23,23,24,24,24,24,24,24,24,25,25,25,25,25,25,25,26,26,26,26,26,26,27,27,27,27,27,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,39,39,39,39,39,39,40,40,40,40,40,40,40,41,41,41,41,41,41,41,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,51,51,51,51,51,51,52,52,52,52,53,53,53,53,53,53,53,54,54,54,54,54,54,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,62,62,62,62,62,62,62,62,62,63,63,63,63,63,63,63,63,63,64,64,64,64,64,64,64,64,64,65,65,65,65,65,65,65,65,65,66,66,66,66,66,66,66,66,66,67,67,67,67,67,67,67,67,68,68,68,68,68,68,68,68,69,69,69,69,69,69,69,69,69,70,70,70,70,70,70,70,70,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,74,74,74,74,74,74,74,74,75,75,75,75,75,75,75,75,76,76,76,76,76,76,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,79,79,79,79,79,79,79,80,80,80,80,80,81,81,81,81,81,81,81,81,81,82,82,82,82,82,82,82,82,82,83,83,83,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,87,87,87,87,87,87,87,87,87,88,88,88,88,88,88,88,88,88,89,89,89,89,89,89,89,89,89,90,90,90,90,90,90,90,90,90,91,91,91,91,91,91,91,91,91,92,92,92,92,92,92,92,92,92,93,93,93,93,93,93,93,93,93,94,94,94,94,94,94,94,94,95,95,95,95,95,95,96,96,96,96,96,96,96,97,97,97,97,97,97,97,98,98,98,98,98,98,98,99,99,99,99,99,99,99,99,99,100,100,100,100,100,100,100,100,101,101,101,101,101,101,101,101,102,102,102,102,102,102,102,102,102,103,103,103,103,103,103,103,103,104,104,104,104,104,104,104,105,105,105,105,105,105,105,106,106,106,106,106,106,106,107,107,107,107,107,108,108,108,108,108];
    j_dx = [1,3,12,32,50,71,73,80,94,19,21,31,51,62,89,91,94,99,6,8,15,36,54,78,80,84,95,24,26,35,55,70,92,94,95,100,43,45,54,72,88,98,99,100,101,2,4,13,33,51,73,75,82,103,20,22,32,52,64,91,102,103,109,7,9,16,37,55,80,82,85,104,25,27,36,56,72,94,103,104,110,44,46,55,74,90,99,109,110,116,11,13,40,58,84,85,96,30,32,39,59,79,95,96,104,111,49,51,58,81,93,100,110,111,117,3,5,14,34,52,75,77,83,106,21,23,33,53,66,102,105,106,112,8,10,17,38,56,82,83,107,26,28,37,57,74,103,106,107,113,45,47,56,76,109,112,113,118,12,14,18,41,59,85,108,31,33,40,60,81,104,107,108,114,50,52,59,110,113,114,119,62,66,81,116,118,119,122,15,17,42,97,35,37,61,96,97,108,115,54,56,86,111,114,115,120,70,74,117,119,120,123,88,121,122,123,124,25,43,45,54,87,88,89,92,98,3,20,22,32,63,64,65,73,91,8,25,27,36,71,72,73,80,94,26,44,46,55,89,90,91,94,99,12,30,32,39,78,79,80,84,95,31,49,51,58,92,93,94,95,100,4,21,23,33,65,66,67,75,102,9,26,28,37,73,74,75,82,103,27,45,47,56,91,102,103,109,32,50,52,59,94,103,104,110,51,62,66,81,99,109,110,116,16,35,37,84,85,96,36,54,56,95,96,104,111,55,70,74,100,110,111,117,72,88,101,116,117,121,10,27,29,38,75,76,77,83,106,28,46,48,57,102,105,106,112,14,32,34,41,82,83,107,33,51,53,60,103,106,107,113,52,64,68,109,112,113,118,17,36,38,42,85,86,108,37,55,57,61,104,107,108,114,56,72,76,86,110,113,114,119,74,90,116,118,119,122,18,39,41,97,40,58,60,96,97,108,115,59,79,111,114,115,120,81,93,117,119,120,123,1,3,12,30,50,69,71,78,92,19,21,31,49,62,87,89,92,98,2,4,13,31,51,71,73,80,94,20,22,32,50,64,89,91,94,99,7,9,16,35,55,78,80,84,95,25,27,36,54,72,92,94,95,100,44,46,55,70,90,98,99,100,101,3,5,14,32,52,73,75,82,103,21,23,33,51,66,91,102,103,109,8,10,17,36,56,80,82,85,104,26,28,37,55,74,94,103,104,110,45,47,56,72,99,109,110,116,12,14,18,39,59,84,85,96,31,33,40,58,81,95,96,104,111,50,52,59,79,100,110,111,117,62,66,81,93,101,116,117,121,27,29,38,56,76,103,106,107,113,46,48,57,74,109,112,113,118,32,34,41,59,104,107,108,114,51,53,60,81,110,113,114,119,64,68,116,118,119,122,36,38,42,86,96,97,108,115,55,57,61,111,114,115,120,72,76,86,117,119,120,123,90,121,122,123,124,6,8,15,25,54,69,71,78,92,24,26,35,44,70,87,89,92,98,2,4,13,21,51,63,65,73,91,7,9,16,26,55,71,73,80,94,25,27,36,45,72,89,91,94,99,11,13,31,58,78,80,84,95,30,32,39,50,79,92,94,95,100,49,51,58,62,93,98,99,100,101,3,5,14,22,52,65,67,75,102,8,10,17,27,56,73,75,82,103,26,28,37,46,74,91,102,103,109,12,14,18,32,59,80,82,85,104,31,33,40,51,81,94,103,104,110,50,52,59,64,99,109,110,116,15,17,36,84,85,96,35,37,55,95,96,104,111,54,56,72,100,110,111,117,70,74,90,101,116,117,121,27,29,38,47,76,102,105,106,112,32,34,41,52,103,106,107,113,51,53,60,66,109,112,113,118,36,38,42,56,86,104,107,108,114,55,57,61,74,110,113,114,119,72,76,86,116,118,119,122,39,41,59,96,97,108,115,58,60,81,111,114,115,120,79,117,119,120,123,93,121,122,123,124];
    C_dx = [1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,57,65,77,85,93,1,9,29,57,65,77,89,85,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,89,93,1,9,29,57,65,77,85,93,1,9,29,57,65,77,85,89,93,1,9,29,57,77,85,89,93,1,9,29,57,65,77,93,1,9,29,57,65,77,85,89,93,1,9,29,77,85,89,93,1,9,29,77,85,89,93,1,9,57,93,1,9,57,77,89,85,93,1,9,57,77,85,89,93,1,9,77,85,89,93,1,77,85,89,93,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,50,78,86,94,22,42,50,78,90,86,94,22,42,50,78,86,90,94,22,42,78,86,90,94,22,42,50,62,78,82,86,90,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,94,22,42,50,62,78,86,90,94,22,42,50,78,86,90,94,22,42,50,62,78,82,94,22,42,50,62,78,86,90,94,22,42,50,62,78,86,90,94,22,42,78,86,90,94,22,42,50,94,22,42,50,78,90,86,94,22,42,78,86,90,94,22,42,78,86,90,94,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,71,79,87,95,7,15,35,55,71,79,91,87,95,7,15,35,55,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,71,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,79,87,91,95,7,15,35,55,79,87,91,95,7,15,79,87,91,95,7,15,35,71,79,91,87,95,7,15,35,79,87,91,95,7,15,35,79,87,91,95,7,79,87,91,95,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,80,88,92,96,20,28,48,80,88,96,20,28,48,80,92,88,96,20,28,48,80,88,92,96,20,28,48,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,80,88,92,96,20,28,40,48,80,88,92,96,20,28,40,48,76,80,88,92,96,20,28,40,48,80,88,92,96,20,28,40,80,88,92,96,20,28,48,80,92,88,96,20,28,48,80,88,92,96,20,80,88,92,96,20,80,88,92,96];
    M = sparse(i_dx,j_dx,C(C_dx),108,124);

    [L,~,Pi] = lu(M(:,1:101));
    Pi = Pi';
    M = [Pi*L Pi(:,102:end)]\M(:,102:end);
    M = M(end-6:end,:);

    T = zeros(16);
    T(1:7,:) = -M(:,1:7)\M(:,8:end);
    T([8,25,58,75,92,125,158,175,224]) = 1;

    [V,D] = eig(T);
    sol = [V([13,15],:)./repmat(V(16,:),2,1); diag(D).'];

    I = find(not(isnan(sol(1,:))) & not(isinf(sol(1,:))));
    %I = I(not(imag(sol(1,:)))); % uncomment this line for real roots only
    w1 = sol(1,I);
    z1 = sol(2,I);
    y1 = sol(3,I);

end