function [C,U,dU] = coefs_hyb51f(data)

    qs = data{1};
    ps = data{2};
    tg = data{3};

    C = zeros(5,39);
    C(166) = -2*ps(1)*qs(2);
    C(161) = 2*ps(2)*qs(2);
    C(167) = -2*ps(3)*qs(4);
    C(162) = 2*ps(4)*qs(4);
    C(168) = -2*ps(5)*qs(6);
    C(163) = 2*ps(6)*qs(6);
    C(169) = -2*ps(7)*qs(8);
    C(164) = 2*ps(8)*qs(8);
    C(170) = -2*ps(9)*qs(10);
    C(165) = 2*ps(10)*qs(10);
    C([116,121]) = -2*qs(2);
    C(191) = -qs(2);
    C([117,122]) = -2*qs(4);
    C(192) = -qs(4);
    C([118,123]) = -2*qs(6);
    C(193) = -qs(6);
    C([119,124]) = -2*qs(8);
    C(194) = -qs(8);
    C([120,125]) = -2*qs(10);
    C(195) = -qs(10);
    C(126) = -2+2*qs(1);
    C(127) = -2+2*qs(3);
    C(128) = -2+2*qs(5);
    C(129) = -2+2*qs(7);
    C(130) = -2+2*qs(9);
    C(111) = 2-2*qs(1);
    C(112) = 2-2*qs(3);
    C(113) = 2-2*qs(5);
    C(114) = 2-2*qs(7);
    C(115) = 2-2*qs(9);
    C([141,156]) = -ps(1)*tg(2)+ps(2)*tg(1);
    C([1,6,11,16]) = ps(1)*tg(2)-ps(2)*tg(1);
    C([142,157]) = -ps(3)*tg(5)+ps(4)*tg(4);
    C([2,7,12,17]) = ps(3)*tg(5)-ps(4)*tg(4);
    C([3,8,13,18]) = ps(5)*tg(8)-ps(6)*tg(7);
    C([143,158]) = ps(6)*tg(7)-ps(5)*tg(8);
    C([144,159]) = -ps(7)*tg(11)+ps(8)*tg(10);
    C([4,9,14,19]) = ps(7)*tg(11)-ps(8)*tg(10);
    C([5,10,15,20]) = ps(9)*tg(14)-ps(10)*tg(13);
    C([145,160]) = ps(10)*tg(13)-ps(9)*tg(14);
    C(151) = -2*ps(2)*qs(2)*tg(1)+2*ps(1)*qs(2)*tg(2);
    C(131) = 2*ps(2)*qs(2)*tg(1)-2*ps(1)*qs(2)*tg(2);
    C([136,146]) = -2*ps(2)*tg(1)*qs(1)+2*ps(1)*tg(2)*qs(1);
    C(152) = 2*ps(3)*qs(4)*tg(5)-2*ps(4)*qs(4)*tg(4);
    C([137,147]) = 2*ps(3)*tg(5)*qs(3)-2*ps(4)*tg(4)*qs(3);
    C(132) = 2*ps(4)*qs(4)*tg(4)-2*ps(3)*qs(4)*tg(5);
    C(133) = -2*ps(5)*qs(6)*tg(8)+2*ps(6)*qs(6)*tg(7);
    C(153) = 2*ps(5)*qs(6)*tg(8)-2*ps(6)*qs(6)*tg(7);
    C([138,148]) = 2*ps(5)*tg(8)*qs(5)-2*ps(6)*tg(7)*qs(5);
    C(134) = -2*ps(7)*qs(8)*tg(11)+2*ps(8)*qs(8)*tg(10);
    C(154) = 2*ps(7)*qs(8)*tg(11)-2*ps(8)*qs(8)*tg(10);
    C([139,149]) = 2*ps(7)*tg(11)*qs(7)-2*ps(8)*tg(10)*qs(7);
    C(135) = -2*ps(9)*qs(10)*tg(14)+2*ps(10)*qs(10)*tg(13);
    C(155) = 2*ps(9)*qs(10)*tg(14)-2*ps(10)*qs(10)*tg(13);
    C([140,150]) = 2*ps(9)*tg(14)*qs(9)-2*ps(10)*tg(13)*qs(9);
    C([66,91]) = 2*tg(1)-2*ps(1)*tg(3);
    C([71,96]) = 2*tg(2)-2*ps(2)*tg(3);
    C([67,92]) = 2*tg(4)-2*ps(3)*tg(6);
    C([72,97]) = 2*tg(5)-2*ps(4)*tg(6);
    C([68,93]) = 2*tg(7)-2*ps(5)*tg(9);
    C([73,98]) = 2*tg(8)-2*ps(6)*tg(9);
    C([69,94]) = 2*tg(10)-2*ps(7)*tg(12);
    C([74,99]) = 2*tg(11)-2*ps(8)*tg(12);
    C([70,95]) = 2*tg(13)-2*ps(9)*tg(15);
    C([75,100]) = 2*tg(14)-2*ps(10)*tg(15);
    C(38) = -ps(5)*qs(5)+ps(6)*qs(6)+ps(5);
    C(48) = ps(5)*qs(5)-ps(6)*qs(6)-ps(5);
    C(33) = -ps(5)*qs(6)-ps(6)*qs(5)+ps(6);
    C(23) = ps(5)*qs(6)+ps(6)*qs(5)-ps(6);
    C(39) = -ps(7)*qs(7)+ps(8)*qs(8)+ps(7);
    C(49) = ps(7)*qs(7)-ps(8)*qs(8)-ps(7);
    C(34) = -ps(8)*qs(7)-ps(7)*qs(8)+ps(8);
    C(24) = ps(8)*qs(7)+ps(7)*qs(8)-ps(8);
    C(40) = -ps(9)*qs(9)+ps(10)*qs(10)+ps(9);
    C(50) = ps(9)*qs(9)-ps(10)*qs(10)-ps(9);
    C(35) = -ps(10)*qs(9)-ps(9)*qs(10)+ps(10);
    C(25) = ps(10)*qs(9)+ps(9)*qs(10)-ps(10);
    C(46) = -ps(1)+ps(1)*qs(1)-ps(2)*qs(2);
    C(176) = ps(1)-ps(1)*qs(1)-ps(2)*qs(2);
    C(36) = ps(1)-ps(1)*qs(1)+ps(2)*qs(2);
    C(26) = 2*ps(1)-2*ps(1)*qs(1)+2*ps(2)*qs(2);
    C(21) = -ps(2)+ps(1)*qs(2)+ps(2)*qs(1);
    C(31) = ps(2)-ps(1)*qs(2)-ps(2)*qs(1);
    C(171) = ps(2)+ps(1)*qs(2)-ps(2)*qs(1);
    C(41) = 2*ps(2)-2*ps(1)*qs(2)-2*ps(2)*qs(1);
    C(47) = -ps(3)+ps(3)*qs(3)-ps(4)*qs(4);
    C(177) = ps(3)-ps(3)*qs(3)-ps(4)*qs(4);
    C(37) = ps(3)-ps(3)*qs(3)+ps(4)*qs(4);
    C(27) = 2*ps(3)-2*ps(3)*qs(3)+2*ps(4)*qs(4);
    C(22) = -ps(4)+ps(3)*qs(4)+ps(4)*qs(3);
    C(32) = ps(4)-ps(3)*qs(4)-ps(4)*qs(3);
    C(172) = ps(4)+ps(3)*qs(4)-ps(4)*qs(3);
    C(42) = 2*ps(4)-2*ps(4)*qs(3)-2*ps(3)*qs(4);
    C(178) = ps(5)-ps(5)*qs(5)-ps(6)*qs(6);
    C(28) = 2*ps(5)-2*ps(5)*qs(5)+2*ps(6)*qs(6);
    C(173) = ps(6)+ps(5)*qs(6)-ps(6)*qs(5);
    C(43) = 2*ps(6)-2*ps(5)*qs(6)-2*ps(6)*qs(5);
    C(179) = ps(7)-ps(7)*qs(7)-ps(8)*qs(8);
    C(29) = 2*ps(7)-2*ps(7)*qs(7)+2*ps(8)*qs(8);
    C(174) = ps(8)+ps(7)*qs(8)-ps(8)*qs(7);
    C(44) = 2*ps(8)-2*ps(7)*qs(8)-2*ps(8)*qs(7);
    C(180) = ps(9)-ps(9)*qs(9)-ps(10)*qs(10);
    C(30) = 2*ps(9)+2*ps(10)*qs(10)-2*ps(9)*qs(9);
    C(175) = ps(10)+ps(9)*qs(10)-ps(10)*qs(9);
    C(45) = 2*ps(10)-2*ps(10)*qs(9)-2*ps(9)*qs(10);
    C(81) = -2*qs(2)*tg(1)-2*tg(2)*qs(1)+2*ps(1)*qs(2)*tg(3)+2*ps(2)*tg(3)*qs(1);
    C(61) = -qs(2)*tg(1)-tg(2)*qs(1)+ps(1)*qs(2)*tg(3)+ps(2)*tg(3)*qs(1);
    C(181) = -qs(2)*tg(1)+tg(2)*qs(1)+ps(1)*qs(2)*tg(3)-ps(2)*tg(3)*qs(1);
    C(51) = qs(2)*tg(1)+tg(2)*qs(1)-ps(1)*qs(2)*tg(3)-ps(2)*tg(3)*qs(1);
    C(86) = -qs(2)*tg(2)+tg(1)*qs(1)-ps(1)*tg(3)*qs(1)+ps(2)*qs(2)*tg(3);
    C(76) = qs(2)*tg(2)-tg(1)*qs(1)+ps(1)*tg(3)*qs(1)-ps(2)*qs(2)*tg(3);
    C(186) = qs(2)*tg(2)+tg(1)*qs(1)-ps(1)*tg(3)*qs(1)-ps(2)*qs(2)*tg(3);
    C(56) = 2*qs(2)*tg(2)-2*tg(1)*qs(1)+2*ps(1)*tg(3)*qs(1)-2*ps(2)*qs(2)*tg(3);
    C(82) = -2*qs(4)*tg(4)-2*tg(5)*qs(3)+2*ps(4)*tg(6)*qs(3)+2*ps(3)*qs(4)*tg(6);
    C(62) = -qs(4)*tg(4)-tg(5)*qs(3)+ps(3)*qs(4)*tg(6)+ps(4)*tg(6)*qs(3);
    C(182) = -qs(4)*tg(4)+tg(5)*qs(3)+ps(3)*qs(4)*tg(6)-ps(4)*tg(6)*qs(3);
    C(52) = qs(4)*tg(4)+tg(5)*qs(3)-ps(3)*qs(4)*tg(6)-ps(4)*tg(6)*qs(3);
    C(87) = -qs(4)*tg(5)+tg(4)*qs(3)-ps(3)*tg(6)*qs(3)+ps(4)*qs(4)*tg(6);
    C(77) = qs(4)*tg(5)-tg(4)*qs(3)+ps(3)*tg(6)*qs(3)-ps(4)*qs(4)*tg(6);
    C(187) = qs(4)*tg(5)+tg(4)*qs(3)-ps(3)*tg(6)*qs(3)-ps(4)*qs(4)*tg(6);
    C(57) = 2*qs(4)*tg(5)-2*tg(4)*qs(3)+2*ps(3)*tg(6)*qs(3)-2*ps(4)*qs(4)*tg(6);
    C(83) = -2*qs(6)*tg(7)-2*tg(8)*qs(5)+2*ps(5)*qs(6)*tg(9)+2*ps(6)*tg(9)*qs(5);
    C(183) = -qs(6)*tg(7)+tg(8)*qs(5)+ps(5)*qs(6)*tg(9)-ps(6)*tg(9)*qs(5);
    C(188) = qs(6)*tg(8)+tg(7)*qs(5)-ps(5)*tg(9)*qs(5)-ps(6)*qs(6)*tg(9);
    C(58) = 2*qs(6)*tg(8)-2*tg(7)*qs(5)+2*ps(5)*tg(9)*qs(5)-2*ps(6)*qs(6)*tg(9);
    C(84) = -2*qs(8)*tg(10)-2*tg(11)*qs(7)+2*ps(7)*qs(8)*tg(12)+2*ps(8)*tg(12)*qs(7);
    C(184) = -qs(8)*tg(10)+tg(11)*qs(7)+ps(7)*qs(8)*tg(12)-ps(8)*tg(12)*qs(7);
    C(189) = qs(8)*tg(11)+tg(10)*qs(7)-ps(7)*tg(12)*qs(7)-ps(8)*qs(8)*tg(12);
    C(59) = 2*qs(8)*tg(11)-2*tg(10)*qs(7)+2*ps(7)*tg(12)*qs(7)-2*ps(8)*qs(8)*tg(12);
    C(85) = -2*qs(10)*tg(13)-2*tg(14)*qs(9)+2*ps(10)*tg(15)*qs(9)+2*ps(9)*qs(10)*tg(15);
    C(185) = -qs(10)*tg(13)+tg(14)*qs(9)+ps(9)*qs(10)*tg(15)-ps(10)*tg(15)*qs(9);
    C(190) = qs(10)*tg(14)+tg(13)*qs(9)-ps(9)*tg(15)*qs(9)-ps(10)*qs(10)*tg(15);
    C(60) = 2*qs(10)*tg(14)-2*tg(13)*qs(9)-2*ps(10)*qs(10)*tg(15)+2*ps(9)*tg(15)*qs(9);
    C(63) = ps(5)*qs(6)*tg(9)+ps(6)*tg(9)*qs(5)-qs(6)*tg(7)-tg(8)*qs(5);
    C(88) = -ps(5)*tg(9)*qs(5)+ps(6)*qs(6)*tg(9)-qs(6)*tg(8)+tg(7)*qs(5);
    C(78) = ps(5)*tg(9)*qs(5)-ps(6)*qs(6)*tg(9)+qs(6)*tg(8)-tg(7)*qs(5);
    C(53) = -ps(6)*tg(9)*qs(5)-ps(5)*qs(6)*tg(9)+qs(6)*tg(7)+tg(8)*qs(5);
    C(54) = -ps(7)*qs(8)*tg(12)-ps(8)*tg(12)*qs(7)+qs(8)*tg(10)+tg(11)*qs(7);
    C(64) = ps(7)*qs(8)*tg(12)+ps(8)*tg(12)*qs(7)-qs(8)*tg(10)-tg(11)*qs(7);
    C(89) = -ps(7)*tg(12)*qs(7)+ps(8)*qs(8)*tg(12)-qs(8)*tg(11)+tg(10)*qs(7);
    C(79) = ps(7)*tg(12)*qs(7)-ps(8)*qs(8)*tg(12)+qs(8)*tg(11)-tg(10)*qs(7);
    C(80) = -ps(10)*qs(10)*tg(15)+ps(9)*tg(15)*qs(9)+qs(10)*tg(14)-tg(13)*qs(9);
    C(90) = ps(10)*qs(10)*tg(15)-ps(9)*tg(15)*qs(9)-qs(10)*tg(14)+tg(13)*qs(9);
    C(55) = -ps(10)*tg(15)*qs(9)-ps(9)*qs(10)*tg(15)+qs(10)*tg(13)+tg(14)*qs(9);
    C(65) = ps(10)*tg(15)*qs(9)+ps(9)*qs(10)*tg(15)-qs(10)*tg(13)-tg(14)*qs(9);
    C([101,106]) = qs(2);
    C([102,107]) = qs(4);
    C([103,108]) = qs(6);
    C([104,109]) = qs(8);
    C([105,110]) = qs(10);

    C = C./repmat(sqrt(sum(C.*conj(C),2)),1,size(C,2));

    U = @(a1,a2,a3,a4,a5)[a1^2*a3^2,a2^2*a3^2,a1^2*a4^2,a2^2*a4^2,a1^2*a3*a5,a1*a2*a3*a5,a2^2*a3*a5,a1^2*a4*a5,a1*a2*a4*a5,a2^2*a4*a5,a1^2*a3,a1*a2*a3,a2^2*a3,a1*a3^2,a2*a3^2,a1^2*a4,a1*a2*a4,a2^2*a4,a1*a4^2,a2*a4^2,a1^2*a5,a2^2*a5,a1*a3*a5,a2*a3*a5,a1*a4*a5,a2*a4*a5,a1*a3,a2*a3,a3^2,a1*a4,a2*a4,a4^2,a1*a5,a2*a5,a3*a5,a4*a5,a3,a4,a5];
    dU = @(a1,a2,a3,a4,a5)[[2*a1*a3^2,0,2*a1*a4^2,0,2*a1*a3*a5,a2*a3*a5,0,2*a1*a4*a5,a2*a4*a5,0,2*a1*a3,a2*a3,0,a3^2,0,2*a1*a4,a2*a4,0,a4^2,0,2*a1*a5,0,a3*a5,0,a4*a5,0,a3,0,0,a4,0,0,a5,0,0,0,0,0,0];[0,2*a2*a3^2,0,2*a2*a4^2,0,a1*a3*a5,2*a2*a3*a5,0,a1*a4*a5,2*a2*a4*a5,0,a1*a3,2*a2*a3,0,a3^2,0,a1*a4,2*a2*a4,0,a4^2,0,2*a2*a5,0,a3*a5,0,a4*a5,0,a3,0,0,a4,0,0,a5,0,0,0,0,0];[2*a1^2*a3,2*a2^2*a3,0,0,a1^2*a5,a1*a2*a5,a2^2*a5,0,0,0,a1^2,a1*a2,a2^2,2*a1*a3,2*a2*a3,0,0,0,0,0,0,0,a1*a5,a2*a5,0,0,a1,a2,2*a3,0,0,0,0,0,a5,0,1,0,0];[0,0,2*a1^2*a4,2*a2^2*a4,0,0,0,a1^2*a5,a1*a2*a5,a2^2*a5,0,0,0,0,0,a1^2,a1*a2,a2^2,2*a1*a4,2*a2*a4,0,0,0,0,a1*a5,a2*a5,0,0,0,a1,a2,2*a4,0,0,0,a5,0,1,0];[0,0,0,0,a1^2*a3,a1*a2*a3,a2^2*a3,a1^2*a4,a1*a2*a4,a2^2*a4,0,0,0,0,0,0,0,0,0,0,a1^2,a2^2,a1*a3,a2*a3,a1*a4,a2*a4,0,0,0,0,0,0,a1,a2,a3,a4,0,0,1]];

end