function [C,U,dU] = coefs_rdist9p(data)

    x1 = data{1};
    x2 = data{2};

    r1 = x1(1,:).^2+x1(2,:).^2;
    r2 = x2(1,:).^2+x2(2,:).^2;

    M = [x1(1,:).*x2(1,:); x1(1,:).*x2(2,:); x1(2,:).*x2(1,:); x1(2,:).*x2(2,:);...
        x1(1,:).*r2; x1(1,:); x1(2,:).*r2; x1(2,:); x2(1,:).*r1; x2(2,:).*r1;...
        r1.*r2; x2(1,:); x2(2,:); r1; r2; ones(1,9)]';

    M = M(:,1:9)\M(:,10:end);

    C = zeros(4,52);

    C(179) = 1;
    C(125) = -M(6);
    C(126) = -M(8);
    C(113) = -M(15);
    C(114) = -M(17);
    C(153) = -M(24);
    C(154) = -M(26);
    C(161) = -M(33);
    C(162) = -M(35);
    C(149) = -M(51);
    C(150) = -M(53);
    C(24) = -M(1)*M(8)+M(6)*M(3);
    C(20) = -M(6)*M(4)+M(2)*M(8);
    C(8) = -M(10)*M(17)+M(15)*M(12);
    C(4) = M(11)*M(17)-M(15)*M(13);
    C(60) = M(13)*M(10)-M(11)*M(12);
    C(88) = M(20)*M(26)-M(24)*M(22);
    C(112) = -M(28)*M(35)+M(33)*M(30);
    C(188) = -M(38)*M(39)+M(37)*M(40);
    C(144) = M(38)*M(44)-M(42)*M(40);
    C(92) = -M(46)*M(53)+M(51)*M(48);
    C(152) = -M(47)*M(48)+M(46)*M(49);
    C(80) = M(47)*M(53)-M(51)*M(49);
    C(208) = M(55)*M(58)-M(56)*M(57);
    C(173) = -M(42)+M(14);
    C(174) = -M(44)+M(16);
    C(189) = -M(60)+M(50);
    C(190) = -M(62)+M(52);
    C(16) = -M(1)*M(17)-M(10)*M(8)+M(6)*M(12)+M(15)*M(3);
    C(56) = -M(1)*M(35)-M(28)*M(8)+M(6)*M(30)+M(33)*M(3);
    C(12) = M(2)*M(17)+M(11)*M(8)-M(15)*M(4)-M(6)*M(13);
    C(72) = M(2)*M(44)-M(6)*M(40)-M(42)*M(4)+M(38)*M(8);
    C(44) = -M(6)*M(22)-M(24)*M(4)+M(2)*M(26)+M(20)*M(8);
    C(36) = -M(10)*M(53)-M(46)*M(17)+M(15)*M(48)+M(51)*M(12);
    C(64) = M(11)*M(44)-M(15)*M(40)-M(42)*M(13)+M(38)*M(17);
    C(28) = M(11)*M(53)-M(15)*M(49)-M(51)*M(13)+M(47)*M(17);
    C(32) = -M(15)*M(22)-M(24)*M(13)+M(11)*M(26)+M(20)*M(17);
    C(104) = -M(28)*M(53)-M(46)*M(35)+M(33)*M(48)+M(51)*M(30);
    C(140) = -M(38)*M(12)+M(10)*M(40)+M(37)*M(13)-M(11)*M(39);
    C(124) = -M(42)*M(22)-M(24)*M(40)+M(20)*M(44)+M(38)*M(26);
    C(116) = -M(47)*M(12)+M(10)*M(49)+M(46)*M(13)-M(11)*M(48);
    C(84) = -M(51)*M(22)-M(24)*M(49)+M(20)*M(53)+M(47)*M(26);
    C(204) = M(55)*M(40)-M(38)*M(57)-M(56)*M(39)+M(37)*M(58);
    C(192) = M(55)*M(49)-M(47)*M(57)-M(56)*M(48)+M(46)*M(58);
    C(76) = M(1)*M(4)-M(2)*M(3)-M(1)*M(44)-M(37)*M(8)+M(6)*M(39)+M(42)*M(3);
    C(100) = -M(19)*M(26)+M(24)*M(21)-M(24)*M(31)-M(33)*M(22)+M(20)*M(35)+M(29)*M(26);
    C(108) = -M(19)*M(35)-M(28)*M(26)-M(33)*M(31)+M(24)*M(30)+M(33)*M(21)+M(29)*M(35);
    C(160) = -M(20)*M(21)+M(20)*M(62)+M(56)*M(26)-M(24)*M(58)-M(60)*M(22)+M(19)*M(22);
    C(196) = -M(20)*M(57)-M(56)*M(21)+M(56)*M(62)-M(60)*M(58)+M(19)*M(58)+M(55)*M(22);
    C(172) = -M(29)*M(30)-M(28)*M(62)-M(55)*M(35)+M(33)*M(57)+M(60)*M(30)+M(28)*M(31);
    C(148) = -M(37)*M(44)-M(38)*M(3)+M(42)*M(39)+M(1)*M(40)+M(37)*M(4)-M(2)*M(39);
    C(200) = M(55)*M(31)-M(29)*M(57)-M(56)*M(30)-M(55)*M(62)+M(60)*M(57)+M(28)*M(58);
    C(48) = -M(10)*M(35)-M(28)*M(17)-M(46)*M(8)-M(1)*M(53)+M(6)*M(48)+M(15)*M(30)+M(33)*M(12)+M(51)*M(3);
    C(68) = -M(10)*M(44)-M(37)*M(17)-M(11)*M(3)+M(1)*M(13)+M(10)*M(4)-M(2)*M(12)+M(15)*M(39)+M(42)*M(12);
    C(52) = -M(19)*M(8)-M(1)*M(26)+M(2)*M(35)+M(29)*M(8)-M(6)*M(31)-M(33)*M(4)+M(6)*M(21)+M(24)*M(3);
    C(96) = -M(19)*M(53)-M(46)*M(26)-M(33)*M(49)-M(51)*M(31)+M(29)*M(53)+M(47)*M(35)+M(24)*M(48)+M(51)*M(21);
    C(180) = -M(38)*M(21)+M(38)*M(62)+M(56)*M(44)-M(42)*M(58)-M(60)*M(40)+M(19)*M(40)+M(37)*M(22)-M(20)*M(39);
    C(176) = -M(38)*M(48)-M(47)*M(39)-M(56)*M(12)+M(10)*M(58)+M(37)*M(49)+M(46)*M(40)+M(55)*M(13)-M(11)*M(57);
    C(164) = -M(46)*M(62)-M(55)*M(53)-M(47)*M(30)+M(51)*M(57)+M(60)*M(48)+M(28)*M(49)+M(46)*M(31)-M(29)*M(48);
    C(156) = -M(47)*M(21)+M(47)*M(62)+M(56)*M(53)-M(51)*M(58)-M(60)*M(49)+M(19)*M(49)+M(46)*M(22)-M(20)*M(48);
    C(136) = -M(1)*M(62)-M(28)*M(44)-M(37)*M(35)-M(55)*M(8)+M(6)*M(57)+M(33)*M(39)+M(42)*M(30)+M(60)*M(3)+M(1)*M(31)+M(28)*M(4)-M(2)*M(30)-M(29)*M(3);
    C(120) = M(11)*M(62)-M(11)*M(21)-M(20)*M(12)-M(15)*M(58)-M(42)*M(49)-M(51)*M(40)-M(60)*M(13)+M(10)*M(22)+M(19)*M(13)+M(38)*M(53)+M(47)*M(44)+M(56)*M(17);
    C(40) = -M(19)*M(17)-M(10)*M(26)+M(2)*M(53)+M(11)*M(35)+M(29)*M(17)+M(47)*M(8)+M(15)*M(21)+M(24)*M(12)-M(6)*M(49)-M(15)*M(31)-M(33)*M(13)-M(51)*M(4);
    C(184) = -M(37)*M(62)-M(55)*M(44)-M(38)*M(30)-M(56)*M(3)+M(42)*M(57)+M(60)*M(39)+M(1)*M(58)+M(28)*M(40)+M(37)*M(31)+M(55)*M(4)-M(2)*M(57)-M(29)*M(39);
    C(168) = -M(55)*M(26)-M(19)*M(62)+M(24)*M(57)+M(60)*M(21)+M(29)*M(62)+M(56)*M(35)-M(33)*M(58)-M(60)*M(31)+M(19)*M(31)+M(28)*M(22)-M(20)*M(30)-M(29)*M(21);
    C(128) = -M(10)*M(62)-M(37)*M(53)-M(46)*M(44)-M(55)*M(17)-M(11)*M(30)-M(29)*M(12)-M(47)*M(3)+M(1)*M(49)+M(10)*M(31)+M(28)*M(13)+M(46)*M(4)-M(2)*M(48)+M(15)*M(57)+M(42)*M(48)+M(51)*M(39)+M(60)*M(12);
    C(132) = -M(19)*M(44)-M(37)*M(26)+M(2)*M(62)+M(29)*M(44)-M(6)*M(58)-M(33)*M(40)-M(42)*M(31)-M(60)*M(4)+M(19)*M(4)-M(2)*M(21)+M(38)*M(35)+M(56)*M(8)+M(24)*M(39)+M(42)*M(21)-M(20)*M(3)+M(1)*M(22);
    C(181) = M(5);
    C(182) = M(7);
    C(183) = M(9);
    C(175) = M(18);
    C(193) = M(23);
    C(194) = M(25);
    C(195) = M(27);
    C(197) = M(32);
    C(198) = M(34);
    C(199) = M(36);
    C(201) = M(41);
    C(202) = M(43);
    C(203) = M(45);
    C(191) = M(54);
    C(205) = M(59);
    C(206) = M(61);
    C(207) = M(63);

    C = C./repmat(sqrt(sum(C.*conj(C),2)),1,size(C,2));

    U = @(w,x,y,z)[x*z^2*w^2,y*z^2*w^2,x*z^2*y*w,z^2*y^2*w,x*z^2*y^2,z^2*y^3,x*z*w^2,z*w*x^2,y*z*w^2,y*z*w*x,z*y*x^2,w*z*y^2,z*y^2*x,z*y^3,z^2*w^2,x*z^2*w,z^2*y*w,x*z^2*y,z^2*y^2,x*w^2,w*x^2,x^3,y*w^2,y*w*x,y*x^2,w*y^2,x*y^2,y^3,z*w^2,z*w*x,z*x^2,w*z*y,z*y*x,z*y^2,z^2*w,x*z^2,z^2*y,w^2,w*x,x^2,w*y,x*y,y^2,z*w,z*x,z*y,z^2,w,x,y,z,1];
    dU = @(w,x,y,z)[[2*w*x*z^2,2*z^2*y*w,z^2*x*y,y^2*z^2,0,0,2*w*x*z,x^2*z,2*w*y*z,x*y*z,0,y^2*z,0,0,2*w*z^2,x*z^2,y*z^2,0,0,2*x*w,x^2,0,2*y*w,x*y,0,y^2,0,0,2*w*z,z*x,0,y*z,0,0,z^2,0,0,2*w,x,0,y,0,0,z,0,0,0,1,0,0,0,0];[z^2*w^2,0,z^2*y*w,0,y^2*z^2,0,z*w^2,2*w*x*z,0,w*y*z,2*x*y*z,0,y^2*z,0,0,w*z^2,0,y*z^2,0,w^2,2*x*w,3*x^2,0,y*w,2*x*y,0,y^2,0,0,w*z,2*z*x,0,y*z,0,0,z^2,0,0,w,2*x,0,y,0,0,z,0,0,0,1,0,0,0];[0,z^2*w^2,w*x*z^2,2*z^2*y*w,2*z^2*x*y,3*y^2*z^2,0,0,z*w^2,w*x*z,x^2*z,2*w*y*z,2*x*y*z,3*y^2*z,0,0,w*z^2,x*z^2,2*y*z^2,0,0,0,w^2,x*w,x^2,2*y*w,2*x*y,3*y^2,0,0,0,w*z,z*x,2*y*z,0,0,z^2,0,0,0,w,x,2*y,0,0,z,0,0,0,1,0,0];[2*x*z*w^2,2*y*z*w^2,2*w*x*y*z,2*w*y^2*z,2*y^2*x*z,2*y^3*z,x*w^2,w*x^2,y*w^2,w*x*y,x^2*y,w*y^2,x*y^2,y^3,2*z*w^2,2*w*x*z,2*w*y*z,2*x*y*z,2*y^2*z,0,0,0,0,0,0,0,0,0,w^2,x*w,x^2,y*w,x*y,y^2,2*w*z,2*z*x,2*y*z,0,0,0,0,0,0,w,x,y,2*z,0,0,0,1,0]];

end