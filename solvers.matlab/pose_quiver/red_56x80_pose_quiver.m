% Input: coefficient matrix C of size 4x18
% Output: solution matrix S of size 4x24

function S = red_56x80_pose_quiver(C)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,33,33,33,33,34,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,43,43,43,43,43,43,43,43,43,43,44,44,44,44,44,45,45,45,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,49,49,50,50,50,50,50,50,50,50,50,50,51,51,51,51,51,51,51,51,51,51,52,52,52,52,52,52,52,52,52,52,53,53,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,56,56,56],[2,7,9,21,24,34,60,63,68,69,73,78,3,8,10,22,35,60,61,64,69,71,74,77,23,25,26,38,65,68,70,71,72,75,76,79,25,27,30,39,42,44,45,50,53,65,70,78,26,40,43,45,46,47,52,54,65,67,72,77,45,48,50,51,52,55,56,70,72,75,76,80,14,19,44,49,51,54,69,71,74,77,13,18,43,48,49,53,68,69,73,78,1,4,6,20,21,22,33,38,60,77,78,80,12,15,17,38,69,73,74,77,78,79,80,11,29,32,40,41,47,51,57,58,59,61,67,33,36,49,53,54,56,73,74,79,80,5,15,21,24,60,63,68,69,73,78,23,25,26,65,70,72,73,75,76,77,25,27,30,39,45,48,50,65,69,70,10,31,44,46,51,61,64,66,71,17,37,44,49,51,54,69,71,74,77,8,18,24,28,42,43,48,62,63,68,16,36,43,48,49,53,68,69,73,78,3,13,20,21,22,38,60,77,78,80,14,34,38,69,73,74,77,78,79,80,45,50,52,53,55,70,72,74,75,76,11,40,41,44,47,57,58,59,66,67,6,16,22,60,61,64,69,71,74,77,9,19,29,43,44,49,60,63,64,69,26,40,45,47,49,52,65,67,71,72,35,49,53,54,56,73,74,79,80,23,25,26,65,70,72,74,75,76,78,7,19,24,28,42,43,48,62,63,68,15,37,43,48,49,53,68,69,73,78,2,14,20,21,22,38,60,77,78,80,13,35,38,69,73,74,77,78,79,80,45,50,52,54,55,70,72,73,75,76,9,31,44,46,51,61,64,66,71,16,44,49,51,54,69,71,74,77,11,40,41,46,47,57,58,59,64,67,4,16,21,24,60,63,68,69,73,78,5,17,22,60,61,64,69,71,74,77,8,29,43,44,49,60,63,64,69,25,27,30,39,45,49,50,65,68,70,26,40,45,47,51,52,65,67,69,72,34,49,53,54,56,73,74,79,80,20,21,22,24,38,60,61,77,78,80,33,34,35,36,37,38,68,69,71,73,74,77,78,79,80,1,2,3,4,5,6,12,13,14,33,21,24,60,62,63,64,68,69,73,78,22,60,61,63,64,66,69,71,74,77,23,25,26,27,65,67,70,72,75,76,28,29,31,43,44,49,60,63,64,69,26,30,40,41,45,47,52,65,67,72,39,45,47,50,52,55,70,72,75,76,29,31,32,44,46,51,61,64,66,71,43,44,46,49,51,54,69,71,74,77,42,43,44,48,49,53,68,69,73,78,48,49,51,53,54,56,73,74,79,80],C([17,5,1,49,45,53,41,33,61,57,69,65,17,5,1,49,53,45,41,33,61,57,69,65,49,45,41,17,33,5,61,1,57,69,65,53,49,45,33,61,5,1,57,69,53,41,65,17,49,33,5,61,1,57,69,53,45,41,65,17,33,5,61,1,57,69,53,45,41,65,49,17,17,5,33,61,57,69,45,41,65,49,17,5,33,61,57,69,45,41,65,49,17,5,1,49,45,41,53,65,33,57,61,69,17,5,1,49,33,61,57,41,45,69,65,33,5,1,61,57,69,53,49,45,41,17,65,17,5,33,61,57,69,45,41,65,49,10,30,50,46,42,34,62,58,70,66,50,46,42,34,62,58,30,70,66,10,50,46,34,62,58,30,70,42,10,66,10,34,62,58,70,50,46,42,66,10,30,34,62,58,70,46,42,66,50,10,30,50,34,62,58,70,46,42,66,10,30,34,62,58,70,46,42,66,50,10,30,50,46,42,66,34,58,62,70,10,30,50,34,62,58,42,46,70,66,34,62,58,30,70,46,42,10,66,50,34,62,58,30,70,50,46,42,10,66,10,30,50,46,42,34,62,58,70,66,10,30,34,62,58,70,50,46,42,66,50,34,62,58,30,70,46,42,10,66,10,34,62,58,70,46,42,66,50,51,47,43,35,63,59,23,71,67,15,15,23,51,35,63,59,71,47,43,67,15,23,35,63,59,71,47,43,67,51,15,23,51,47,43,67,35,59,63,71,15,23,51,35,63,59,43,47,71,67,35,63,59,23,71,47,43,15,67,51,15,35,63,59,71,51,47,43,67,15,35,63,59,71,47,43,67,51,35,63,59,23,71,51,47,43,15,67,15,23,51,47,43,35,63,59,71,67,15,23,51,47,43,35,63,59,71,67,15,35,63,59,71,51,47,43,67,51,47,35,63,59,23,71,43,15,67,51,35,63,59,23,71,47,43,15,67,15,35,63,59,71,47,43,67,51,52,48,44,40,68,36,28,60,64,72,52,48,44,40,36,52,40,36,28,64,60,44,48,72,68,52,48,44,40,36,28,68,64,60,72,52,48,44,40,36,28,64,60,72,68,52,48,44,40,36,28,64,60,72,68,52,48,44,40,36,28,64,60,72,68,40,36,28,64,60,72,52,48,44,68,52,40,36,28,64,60,72,48,44,68,40,36,28,64,60,72,48,44,68,52,40,36,28,64,60,72,52,48,44,68,40,36,28,64,60,72,48,44,68,52,40,36,28,64,60,72,48,44,68,52,40,36,28,64,60,72,48,44,68,52]),56,80);

    [L,~,P] = lu(M(:,1:39));
    P = P';
    M = [P*L P(:,40:end)]\M(:,40:end);
    M = M(end-16:end,:);

    T0 = zeros(24);
    T0([2,3,6,7,8,9,10,11,12,13,14,15,16,17,18,19,23],:) = -M(:,18:end);
    T0([241,292,341,452,429,406,552]) = 1;
    T1 = zeros(24);
    T1([2,3,6,7,8,9,10,11,12,13,14,15,16,17,18,19,23],[2,3,6,7,8,9,10,11,12,13,14,15,16,17,18,19,23]) = M(:,1:17);
    T1([1,76,101,476,501,526,576]) = 1;

    [V,~] = eig(T0,T1);
    S([2,3],:) = V([21,22],:)./repmat(V(24,:),2,1);
    S([1,4],:) = repmat(V(24,:),2,1)./V([20,23],:);
    S = S(:,all(isfinite(S)));

end