% Input: coefficient matrix C of size 7x35
% Output: solution matrix S of size 3x13

function S = red_12x25_3pra_st0(C,ss)

    M = sparse([1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12,12],[7,8,9,10,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,1,2,3,4,5,6,7,8,9,10,11,13,14,17,20,22,24,27,29,2,3,5,8,11,12,13,16,17,18,19,20,21,22,23,25,27,28,30,4,5,6,9,13,14,15,16,17,18,19,22,23,24,25,26,29,30,31,7,8,9,10,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,1,2,3,4,5,6,7,8,9,10,11,13,14,17,20,22,24,27,29,2,3,5,8,11,12,13,16,17,18,19,20,21,22,23,25,27,28,30,4,5,6,9,13,14,15,16,17,18,19,22,23,24,25,26,29,30,31,7,8,9,10,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,1,2,3,4,5,6,7,8,9,10,11,13,14,17,20,22,24,27,29,2,3,5,8,11,12,13,16,17,18,19,20,21,22,23,25,27,28,30,4,5,6,9,13,14,15,16,17,18,19,22,23,24,25,26,29,30,31],C([107,114,135,177,121,128,142,149,156,163,170,184,191,198,205,212,219,226,233,107,114,121,135,142,156,177,184,198,219,128,149,170,163,191,205,212,226,233,107,114,135,177,121,128,142,149,156,163,170,184,191,198,205,212,219,226,233,107,114,135,177,121,156,170,128,142,149,163,184,191,198,205,212,219,226,233,109,116,137,179,123,130,144,151,158,165,172,186,193,200,207,214,221,228,235,109,116,123,137,144,158,179,186,200,221,130,151,172,165,193,207,214,228,235,109,116,137,179,123,130,144,151,158,165,172,186,193,200,207,214,221,228,235,109,116,137,179,123,158,172,130,144,151,165,186,193,200,207,214,221,228,235,111,118,139,181,125,132,146,153,160,167,174,188,195,202,209,216,223,230,237,111,118,125,139,146,160,181,188,202,223,132,153,174,167,195,209,216,230,237,111,118,139,181,125,132,146,153,160,167,174,188,195,202,209,216,223,230,237,111,118,139,181,125,160,174,132,146,153,167,188,195,202,209,216,223,230,237]),12,35);

    M0 = sparse([1,1,1,1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,10,10,10],[2,5,8,18,21,25,1,7,17,2,8,18,3,4,19,6,9,20,5,8,21,10,14,22,11,15,23,13,16,24,18,21,25],[-1,-1,-2,-2*ss,-2*ss,-ss^2,1,1,ss,1,1,ss,1,1,ss,1,1,ss,1,1,ss,1,1,ss,1,1,ss,1,1,ss,1,1,ss],10,25);
    M = M(:,11:end)-M(:,1:10)*M0; % Schur complement reduction

    [L,~,P] = lu(M(:,1:5));
    P = P';
    M = [P*L P(:,6:end)]\M(:,6:end);
    M = M(end-6:end,:);

    T0 = zeros(13);
    T0([1,2,3,4,5,6,7],:) = -M(:,8:end);
    T0([8,35,62,76,103,143]) = 1;
    T1 = zeros(13);
    T1([1,2,3,4,5,6,7],[1,2,3,4,5,6,7]) = M(:,1:7);
    T1([99,113,127,141,155,169]) = 1;

    [V,~] = eig(T0,T1);
    S = V(10:12,:)./repmat(V(13,:),3,1);
    S = S(:,all(isfinite(S)));

end