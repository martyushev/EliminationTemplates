% Input: coefficient matrix C of size 5x41
% Output: solution matrix S of size 3x19

function S = red_22x41_relpose_7p_fr_1s_elr(C)

    M = sparse([1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,9,10,10,10,10,10,10,11,11,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,14,14,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22],[20,21,22,38,39,41,17,18,20,34,35,38,18,19,21,35,36,39,8,37,38,39,40,41,13,14,17,29,30,34,15,16,19,31,32,36,11,12,16,26,27,32,14,15,18,30,31,35,10,11,15,25,26,31,9,10,14,24,25,30,7,33,35,36,37,39,4,28,31,32,33,36,6,7,8,34,35,38,2,23,26,27,28,32,1,2,4,25,26,31,3,4,7,30,31,35,4,7,8,13,14,15,16,17,18,19,20,21,22,28,30,31,32,33,34,35,36,37,38,39,40,41,1,2,3,4,5,6,7,8,9,10,11,13,14,15,17,18,20,24,25,26,29,30,31,34,35,38,2,4,7,9,10,11,12,14,15,16,18,19,21,23,25,26,27,28,30,31,32,33,35,36,37,39,2,4,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,25,26,27,28,30,31,32,33,34,35,36,37,38,39,40,41,1,2,3,4,5,6,7,8,9,10,11,13,14,15,16,17,18,19,20,21,22,24,25,26,28,29,30,31,32,33,34,35,36,37,38,39,40,41,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39],C([186,191,201,171,176,196,186,191,201,171,176,196,186,191,201,171,176,196,171,176,186,191,196,201,186,191,201,171,176,196,186,191,201,171,176,196,186,191,201,171,176,196,186,191,201,171,176,196,186,191,201,171,176,196,186,191,201,171,176,196,171,176,186,191,196,201,171,176,186,191,196,201,171,176,196,186,191,201,171,176,186,191,196,201,171,176,196,186,191,201,171,176,196,186,191,201,42,102,147,112,117,122,127,157,162,167,187,192,202,47,82,87,92,107,132,137,142,152,172,177,182,197,42,47,102,107,112,147,152,182,117,122,127,157,162,167,187,192,202,82,87,92,132,137,142,172,177,197,42,102,147,112,117,122,127,157,162,167,187,192,202,47,82,87,92,107,132,137,142,152,172,177,182,197,8,43,103,148,58,63,68,73,113,118,123,128,158,163,168,188,193,203,13,23,28,33,48,83,88,93,108,133,138,143,153,173,178,183,198,4,9,39,44,54,99,104,149,59,64,69,114,119,124,129,159,164,169,189,194,204,19,24,29,49,79,84,89,94,109,134,139,144,154,174,179,184,199,5,10,40,45,55,100,105,150,60,65,70,75,115,120,125,130,160,165,170,190,195,15,20,25,30,35,50,80,85,90,95,110,135,140,145,155,175,180]),22,41);

    [L,~,P] = lu(M(:,1:8));
    P = P';
    M = [P*L P(:,9:end)]\M(:,9:end);
    M = M(end-13:end,:);

    T0 = zeros(19);
    T0([2,3,4,5,7,8,9,10,12,13,14,16,17,19],:) = -M(:,15:end);
    T0([77,177,258,319,360]) = 1;
    T1 = zeros(19);
    T1([2,3,4,5,7,8,9,10,12,13,14,16,17,19],[2,3,4,5,7,8,9,10,12,13,14,16,17,19]) = M(:,1:14);
    T1([1,101,201,281,341]) = 1;

    [V,~] = eig(T0,T1);
    S = V(16:18,:)./repmat(V(19,:),3,1);
    S = S(:,all(isfinite(S)));

end